function draw_circles(a){var b=a.nodeEnter,c=(a.circle_size,a.genePresence||!1);b.append("path").attr("d",get_right_symbol).style("fill",function(a){return a.children?c&&!c.hasOwnProperty(a.name)?"grey":"Y"==a.duplication?"red":"green":void 0})}function get_right_symbol(a){return a._children?d3.svg.symbol().type(d3.svg.symbolTypes[1]).size([100])():a.children?"Y"==a.duplication?d3.svg.symbol().type(d3.svg.symbolTypes[4]).size([50])():d3.svg.symbol().type(d3.svg.symbolTypes[0]).size(50)():d3.svg.symbol().type(d3.svg.symbolTypes[3]).size([25])()}function draw_nodes(a){var b=a.nodeEnter,c=a.node,d=(a.source,a.circle_size),e=a.duration,f=a.availablewidth,g=a.tree_representation_type,h=a.nodeindex,i=a.right2left,j=a.two_window;if("radial"==g)b.transition().duration(e).attr("transform",function(a){return j?"rotate(90)translate(70)":"rotate("+(a.x-90)+")translate("+a.y+")"}).style("opacity",1).select("circle"),c.transition().duration(e).attr("transform",function(a){return j?"rotate("+(h[a.name]-90)+")translate("+a.y+")":"rotate("+(a.x-90)+")translate("+a.y+")"}).style("opacity",1),c.exit().transition().duration(e).attr("transform",function(a){return j?"rotate("+(h[a.name]-90)+")translate("+a.y+")":"rotate("+(a.x-90)+")translate("+a.y+")"}).style("opacity",1e-6).remove();else{var k=c.transition().duration(e);k.select("circle").attr("r",function(a){return a._children?10:a.children?d:0}),k.select("path").attr("d",get_right_symbol),k.select(".innerNode_label").attr("visibility","").attr("x",function(a){return a._children?15:a.children?-5:35}).attr("y",function(a){return a._children?3:a.children?-3:4}).attr("text-anchor",function(a){return a._children?"start":void 0}).text(function(a){return a._children?a.name+": "+a._collapsed_children+" homologs":a.children?void 0:get_right_leaf_name(a)}),b.transition().duration(e).attr("transform",function(a){if(j){var b=h[a.name];return"translate(0,"+(b+20)+")"}if(i){var c=f-a.y,d=a.x;return"translate("+c+","+d+")"}return"translate("+a.y+","+a.x+")"}).style("opacity",1).select("circle"),c.transition().duration(e).attr("transform",function(a){if(j)return"translate(0,"+(h[a.name]+20)+")";if(i){var b=f-a.y,c=a.x;return"translate("+b+","+c+")"}return"translate("+a.y+","+a.x+")"}).style("opacity",1),c.exit().transition().duration(e).attr("transform",function(a){if(j)return"translate("+a.y+","+h[a.name]+"20)";if(i){var b=f-a.y,c=a.x;return"translate("+b+","+c+")"}return"translate("+a.y+","+a.x+")"}).style("opacity",1e-6).remove()}}function draw_taxon_names(a){var b=a.nodeEnter,c=(a.show_taxa,a.highlight_gene),d=(a.model_organisms,a.right2left),e=a.genePresence||!1,f=(new Object,b.append("a").attr("xlink:href",function(a){if(!a.children){var b=species2sourceDB_mapping({species:a.taxon,identifier:a.name});return b}}).attr("target","_blank").append("svg:text").attr("x",function(a){return d?-17:a._children?15:a.children?-5:35}).attr("y",function(a){return a._children?3:a.children?-3:4}).attr("text-anchor",function(a){return d?"end":a.children?"end":"start"}).attr("visibility",function(a){return a.children?"hidden":""}).attr("class",function(a){return e&&!e.hasOwnProperty(a.name)?"missing_species":a.children?"innerNode_label":a.name==c||a.uniprot_name==c?"leaf_label species_name highlight_gene":"leaf_label"}).attr("fill",function(a){return a.name==c?"red":""}).text(function(a){return get_right_leaf_name(a,d)}));return f}function draw_bootstraps(a){var b=a.nodeEnter,c=(a.show_taxa,a.visibility),d=b.append("svg:text").attr("x",function(a){return a.children?-5:void 0}).attr("y",function(a){return a.children?13:void 0}).attr("text-anchor",function(a){return a.children?"end":"start"}).attr("class",function(a){return a.children?"bootstrap":void 0}).attr("visibility",c).text(function(a){return a.children?a.bootstrap:void 0});return d}function set_links(a){var b=a.link,c=a.link_type,d=a.node_thickness,e=a.duration,f=a.right2left,g=a.availablewidth,h=a.species_silhouette,i=a.genePresence||!1,j=a.opacity||1;c="elbow";var k=a.class_type||"link",l=(d3.svg.diagonal.radial().projection(function(a){return[a.y,a.x/180*Math.PI]}),d3.svg.diagonal().projection(function(a){return[a.y,a.x]}));b.enter().insert("svg:path","g").attr("class",function(a){var b=a.target;return i?i.hasOwnProperty(b.name)?k:"absent_species_link":k}).attr("stroke-width",function(){return d}).attr("stroke-opacity",j).attr("stroke",function(){return"black"}).attr("d",function(a){return h?l(a):elbow({d:a,right2left:f,availablewidth:g})}).transition().duration(e).attr("d",function(a){return h?l(a):elbow({d:a,right2left:f,availablewidth:g})}),b.transition().duration(e).attr("d",function(a){return h?l(a):elbow({d:a,right2left:f,availablewidth:g})}),b.exit().transition().duration(e).attr("d",function(a){return h?l(a):elbow({d:a,right2left:f,availablewidth:g})}).remove()}function collect_data_from_plotted_tree(a){var b=a.target;return d3.select("#"+b).selectAll("g.node").each(function(a){var b=a.name;b=b.replace(/_\d+/g,"");a.y,a.x,a.height}),rect_data}function print_species_tree_silhouette(a){var b=a.link,c=a.link_type,d=(a.node_thickness,a.duration),e=a.right2left,f=a.availablewidth,g=a.species_silhouette;c="elbow";var h=(d3.svg.diagonal.radial().projection(function(a){return[a.y,a.x/180*Math.PI]}),d3.svg.diagonal().projection(function(a){return[a.y,a.x]}));b.enter().insert("svg:path","g").attr("class","silhouette").attr("stroke-opacity",.3).attr("stroke-width",30).attr("stroke","grey").attr("d",function(a){return g?h(a):elbow({d:a,right2left:e,availablewidth:f})}).transition().duration(d).attr("stroke-opacity",.3).attr("stroke-width",30).attr("stroke","red").attr("d",function(a){return g?h(a):elbow({d:a,right2left:e,availablewidth:f})}),b.transition().duration(d).attr("d",function(a){return g?h(a):elbow({d:a,right2left:e,availablewidth:f})}),b.exit().transition().duration(d).attr("stroke-opacity",.3).attr("stroke-width",30).attr("stroke","red").attr("d",function(a){return g?h(a):elbow({d:a,right2left:e,availablewidth:f})}).remove()}function elbow(a){var b=a.d,c=a.right2left,d=a.availablewidth;return c?"M"+(d-b.source.y)+","+b.source.x+"V"+b.target.x+"H"+(d-b.target.y):"M"+b.source.y+","+b.source.x+"V"+b.target.x+"H"+b.target.y}function redraw(){vis.attr("transform","translate("+d3.event.translate+") scale("+d3.event.scale+")")}function click(a){var b=4,c=15;a.children?(a._children=a.children,a.children=null):(a.children=a._children,a._children=null),d3.select(this).append("svg:path").attr("d",function(){var a=200,b=100;return"M "+a+" "+b+" l 4 4 l -8 0 z"}).attr("r",function(a){return"Y"==a.duplication?c:b}).attr("class","collapsed").attr("fill",function(a){return a.children?"":"white"}).attr("stroke",function(a){return a.children?"":"black"}).attr("stroke-width",function(a){return a.children?"":"2.5px"}),update(a)}function focus(a){var b=15,c=4;a.children?(a._children=a.children,a.children=null):(a.children=a._children,a._children=null),d3.select(this).text("hahaha"),d3.select(this).select("text").text(function(){return"hahhaaa"}),d3.select(this).append("svg:path").attr("d",function(){var a=200,b=100;return"M "+a+" "+b+" l 4 4 l -8 0 z"}).attr("r",function(a){return"Y"==a.duplication?b:c}).attr("class","collapsed").attr("fill",function(a){return a.children?"":"white"}).attr("stroke",function(a){return a.children?"":"black"}).attr("stroke-width",function(a){return a.children?"":"2.5px"}),update(a)}function collapse(a){a.children&&(a._children=a.children,a._children.forEach(collapse),a.children=null)}function draw_alignment_sequences(a){var b=(a.leaf_group_x,a.sequence_start_y,a.alignment_patterns),c=(a.domainScale,a.two_window,a.visibility,a.alignment_font_size),d=new Array,e=b.enter();e.append("svg:rect").attr("x",-6).attr("y",function(a,b,e){var f=a.seq.length;"undefined"==typeof d[e]&&(d[e]=0);var g=d[e]*(c-1);return d[e]+=f,g}).attr("class","align_rect").attr("width",15).attr("height",function(a){return d+=a.seq.length,a.seq.length*(c-1)}).attr("class",function(a){return a.category}).attr("transform","rotate(-90)");var f=new Array;e.append("svg:text").attr("x",function(a,b,d){var e=a.seq.length*(c-1);"undefined"==typeof f[d]&&(f[d]=0);var g=f[d];return f[d]+=e,g}).attr("y","4").attr("class","alignment_text").text(function(a){return a.seq})}function draw_alignments(a){var b=a.leaf_group_x,c=a.sequence_start_y,d=a.nodeEnter,e=a.domainScale,f=a.visibility,g=4e3,h=d.filter(function(a){return"undefined"==typeof a.children});return h.append("rect").attr("x",b+8).attr("y",c).attr("class","seq_string").attr("visibility",f).attr("width",function(a){return a.children?"":"10"}).attr("height",function(a){return!a.children,a.children?"":e(g)}).attr("transform",function(a){return a.children?"":"rotate(-90 100 100)"}).attr("fill","white").attr("stroke","black").attr("stroke-width","5px"),h}function draw_alignment_patterns(a){var b,c=a.alignment_patterns,d=a.sequence_start_y,e=(a.domainScale,a.leaf_group_x,a.domain_colors,a.sequence_rect_width),f=a.max_seq_representation,g=(a.visibility,5);b=0==c.length?2:c[0].length;var h=d3.scale.linear().domain([1,b]).range([1,f]),i=c.enter().append("rect").attr("x",function(){return 195}).attr("y",function(a,b){var c=Number(d)+Number(h(b));return c}).attr("class","alignment_pattern").attr("width",function(){return e}).attr("height",function(){return g}).attr("transform","rotate(-90 100 100)").attr("fill",function(a){return"1"==a?"white":"green"});return i}function draw_sequences(a){var b=a.leaf_group_x,c=a.sequence_start_y,d=a.nodeEnter,e=a.domainScale,f=a.two_window,g=a.visibility,h=d.filter(function(a){return"undefined"==typeof a.children});return h.append("rect").attr("x",b+9).attr("y",function(){return f?0:c}).attr("class","seq_string").attr("visibility",g).attr("width",function(a){return a.children?"":"5"}).attr("height",function(a){return a.children?"":e(a.seq_length)}).attr("transform",function(a){return a.children?"":"rotate(-90 100 100)"}).attr("fill","url(#line_gradient)"),h}function draw_cigar_borders(a){var b=a.leaf_group_x,c=a.sequence_start_y,d=a.nodeEnter,e=a.domainScale,f=a.two_window,g=a.alignment_length,h=a.visibility,i=d.filter(function(a){return"undefined"==typeof a.children});return i.append("rect").attr("x",b+4).attr("y",function(){return f?0:c}).attr("class","seq_string").attr("visibility",h).attr("width",function(a){return a.children?"":"10"}).attr("height",function(){return e(g)}).attr("transform",function(a){return a.children?"":"rotate(-90 100 100)"}).attr("fill","white").attr("stroke","green"),i}function draw_cigar_sequences(a){var b=a.domains,c=a.sequence_start_y,d=a.domainScale,e=a.leaf_group_x,f=(a.domain_colors,a.two_window),g=a.sequence_rect_width,h=a.visibility,i=b.enter().append("rect").attr("x",function(){return e+3}).attr("y",function(a){if(f){var b=d(a.offset);return b}return 3==a.domain_start,c+d(a.domain_start)}).attr("class","cigar_rect").attr("visibility",h).attr("transform","matrix(1,0,0,1,100,0)").attr("width",function(){return g}).attr("height",function(a){var b=a.length;return d(b)}).attr("transform","rotate(-90 100 100)").attr("fill",function(a){return"M"==a.type?"green":"white"}).on("mouseover",show_domain_information);return i}function draw_domains(a){var b=a.domains,c=a.sequence_start_y,d=a.domainScale,e=a.leaf_group_x,f=a.domain_colors,g=a.two_window,h=a.sequence_rect_width,i=a.visibility,j=0,k={},l=b.enter().append("a").attr("xlink:href",function(a){return"http://pfam.sanger.ac.uk/family/"+a.name}).attr("target","_blank").append("rect").attr("x",function(){return e+3}).attr("y",function(a){return g?d(a.domain_start):(3==a.domain_start,c+d(a.domain_start))}).attr("class","domain").attr("visibility",i).attr("rx",5).attr("ry",5).attr("transform","matrix(1,0,0,1,100,0)").attr("stroke","none").attr("width",function(){return h+4}).attr("height",function(a){var b=d(a.domain_stop-a.domain_start);return b}).attr("transform","rotate(-90 100 100)").attr("fill-opacity",.8).attr("fill",function(a){return void 0===k[a.name]?(k[a.name]=f[j%6],j++,"url(#"+k[a.name]+")"):"url(#"+k[a.name]+")"}).on("mouseover",show_domain_information);return l}function get_right_leaf_name(a,b){var c;return b?a.name:a.children?a.name:a.sequences?a.taxon+", "+a.sequences.length+" genes":(c=a.swissprot_protein_name&&"N/A"==!a.swissprot_protein_name?a.swissprot_protein_name:a.display_label&&""==!a.display_label?a.display_label.length>20?a.display_label.substring(0,15):a.display_label:"N/A",c="NaN"==a.common_name||"N/A"==a.common_name?c+", "+a.name:c+", "+a.common_name)}function draw_aligned_sequences(a){var b=a.leaf_group_x,c=a.sequence_start_y,d=a.nodeEnter,e=a.domainScale,f=a.visibility,g=d.filter(function(a){return"leaf"==a.type});return g.append("rect").attr("x",b+8).attr("y",c).attr("class","aligned_seq_string").attr("visibility",f).attr("width",function(a){return a.children?"":"10"}).attr("height",function(a){return!a.children,a.children?"":e(4e3)}).attr("transform",function(a){return a.children?"":"rotate(-90 100 100)"}).attr("fill","green"),g}function draw_gaps(a){var b=a.gaps,c=a.sequence_start_y,d=a.domainScale,e=a.leaf_group_x,f=a.sequence_rect_width,g=a.visibility,h=b.enter().append("rect").attr("x",e+9).attr("y",function(a){return c+d(a.domain_start)}).attr("class","gap").attr("visibility",g).attr("width",function(){return f-4}).attr("height",function(a){var b=d(a.domain_stop-a.domain_start);return b}).attr("transform","rotate(-90 100 100)").attr("fill","white");return h}function draw_synteny_seqs(a){var b=a.leaf_group_x,c=a.sequence_start_y,d=a.nodeEnter,e=a.domainScale,f=a.visibility,g=d.filter(function(a){return"leaf"==a.type});return g.append("rect").attr("x",b+11).attr("y",c).attr("class","synteny_seq_string").attr("visibility",f).attr("width",function(a){return a.children?"":"2"}).attr("height",function(a){return!a.children,a.children?"":e(4e3)}).attr("transform",function(a){return a.children?"":"rotate(-90 100 100)"}).attr("fill","grey"),g}function draw_synteny(a){var b=a.syntenties,c=a.sequence_start_y,d=a.domainScale,e=a.leaf_group_x,f=a.sequence_rect_width,g=a.visibility,h=b.enter().append("rect").attr("x",e+6).attr("y",function(a){return c+d(a.length)}).attr("class","synteny").attr("visibility",g).attr("width",function(){return f}).attr("height",function(a){var b=d(a.length);return b}).attr("transform","rotate(-90 100 100)").attr("fill","green");return h}function draw_images(a){{var b=a.nodeEnter,c=a.image_path,d=a.right2left;b.append("svg:image").attr("y",-10).attr("x",function(){return d?-15:12.5}).attr("text-anchor",function(){return"end"}).attr("width",20).attr("height",20).attr("xlink:href",function(a){var b;return b="NaN"==a.taxon?c+"/thumb_"+a.name+".png":c+"/thumb_"+a.taxon+".png",a.children&&"undefined"!=typeof a.children&&"NaN"!=!a.taxon?"":b})}}function draw_bootstrap_ticks(a){{var b=a.nodeEnter;b.append("rect").attr("x",-10).attr("y",-5).attr("class","seq_string").attr("width",function(a){return a.children?"2":""}).attr("height",10).attr("fill",function(a){return a.bootstrap?a.bootstrap<50?"red":a.bootstrap>50&&a.bootstrap<85?"orange":"green":""}).attr("stroke-width","5px")}}function get_subtree_color_data(a){var b=(a.nodeEnter,a.target),c=new Object,d="";return c.Primates="1",c.Euarchontoglires="1",c.Vertebrata="1",c.Lophotrochozoa="1",c.Ecdysozoa="1",c.Laurasiatheria="1",c.Clupeocephala="1",c.Laurasiatheria="1",rect_data=[],d3.select("#"+b).selectAll("g.node").each(function(a){if(a.children){var b=a.name;if(b=b.replace(/_\d+/g,""),c.hasOwnProperty(b)){if(d==b)return"";var e,f,g=get_all_childs(a),h=9e3,i=0;e=a.y,jQuery.each(g,function(b,c){c.name===a.name||(c.x<h&&(h=c.x),c.x>i&&(i=c.x),f=c.y)});var j=0,k=i-h+16,l=f-e+550,m=i-a.x+8;m=-m,rect_data[a.name]={rect_x:m,rect_y:j,rect_height:l,rect_width:k},d=b}}}),rect_data}function draw_vertical_taxon_labels(a){{var b=a.nodeEnter,c=(a.leaf_group_x,a.sequence_start_y);b.append("rect").attr("x",c-5).attr("y",-9).attr("class","bootstrap_ticks").attr("width",function(a){return a.children?"":"5"}).attr("height",17).attr("fill",function(a){return a.bootstrap?a.bootstrap<50?"red":a.bootstrap>50&&a.bootstrap<85?"orange":"green":""}).attr("stroke-width","5px")}}function add_tipsy(a){var b=a.where;".leaf_label"==b?jQuery(b).tipsy({gravity:"se",html:!0,title:function(){var a=this.__data__;return"Taxon: "+a.taxon+"<br>ID: "+a.name+"<br>Common name: "+a.common_name+"<br>Gene name: "+a.display_label+"<br>"}}):".domain"==b?jQuery(b).tipsy({gravity:"se",html:!0,title:function(){var a=this.__data__,b=a.domain_stop-a.domain_start;return"Domain: "+a.name+"<br>Length: "+b+" AA<br> E-value: "+a.evalue+"<br>Start: "+a.domain_start+" End: "+a.domain_stop}}):".clade_tax_rect"==b&&jQuery(b).tipsy({gravity:"se",html:!0,title:function(){var a=this.__data__,b=a.name;return b=b.replace(/_\d+/g,""),"Clade: "+b+"<br>"}})}function toggleAll(a){a.children&&(a.children.forEach(toggle),click(a))}function toggle(a){a.children?(a._children=a.children,a.children=null):(a.children=a._children,a._children=null)}function draw_blank_rects(){d3.select("#tree svg").selectAll("g.node").append("rect").attr("x",function(a){return a.children?void 0:-8}).attr("y",function(a){return a.children?void 0:12}).attr("class",function(a){return a.children?void 0:"blank_rect"}).attr("width",function(a){return a.children?void 0:"15"}).attr("height",function(a){return a.children?void 0:263}).attr("transform","rotate(-90)").attr("fill","white").attr("fill-opacity",1)}function draw_leaf_colors(a){var b=a.how_to_color_hash,c=a.target,d=new Object,e=(new Object,d3.scale.category20b()),f=(e.range(),0),g="",h=d3.select("#"+c).selectAll("g.node").filter(function(a){return!a.children});h.append("rect").attr("x",function(){return-6}).attr("y",function(){return 33}).attr("class",function(){return"tax_color_rect"}).attr("width",function(){return"12"}).attr("height",function(a){return a.children?"0":240}).attr("transform",function(a){return a.children?"1":"rotate(-90)"}).attr("fill",function(a){return b.hasOwnProperty(a.display_label)?"N/A"==b[a.display_label]||""==b[a.display_label]?"white":"other"==b[a.display_label]?"grey":void 0===d[a.display_label]?(d[a.display_label]=e(f%e.range().length),g=g+"<span style='opacity:0.6; background-color:"+d[a.display_label]+"'>",g=g+"<a href='http://www.uniprot.org/uniprot/?query="+a.display_label+"+AND+reviewed%3Ayes&sort=score'>",g=g+a.swissprot_gene_name+"</a></span>: "+a.display_label+"</div><br>",f++,d[a.display_label]):d[a.display_label]:""}).attr("fill-opacity",function(){return.2})}function color_subtrees(a){var b=a.subtree_colors,c=a.target,d=(new Object,new Object),e=d3.scale.category20b(),f=(e.range(),d3.scale.category10()),g=(f.range(),0),h=d3.select("#"+c).selectAll("g.node").filter(function(a){return b.hasOwnProperty(a.name)});return h.append("rect").attr("x",function(a){return b[a.name].rect_x}).attr("y",0).attr("class","clade_tax_rect").attr("width",function(a){return b[a.name].rect_width}).attr("height",function(a){return b[a.name].rect_height}).attr("transform",function(){return"rotate(-90)"}).attr("fill",function(a){var b=a.name;return b=b.replace(/_\d+/g,""),void 0===d[a.name]&&(d[a.name]=f(g%f.range().length),g++),d[a.name]}).attr("fill-opacity",function(){return.3}),d}function show_general_information(a){var b=a.swissprot_annotation||"NaN";jQuery("#swissprot_annotation_container").html(b)}function show_gene_information(a){var b=a.name||"NaN",c=a.taxon||"NaN",d=a.swissprot_gene_name||"NaN",e=a.swissprot_protein_name||"NaN",f=species2sourceDB_mapping({species:c,identifier:b});jQuery("#container_seq_id").html("<a href='"+f+"' target='_blank')>"+b+"</a> "),jQuery("#container_taxon_id").html("<font font-style='italic'>"+c+"</font>"),jQuery("#container_gene_name").html(d),jQuery("#container_swissprot_annotation").html(e)}function show_domain_information(a){var b=a.name||"NaN",c=a.domain_start||"NaN",d=a.domain_stop||"NaN",e=(a.swissprot_protein_name||"NaN",a.evalue||"NaN"),f=a.domain_stop-a.domain_start||"NaN";jQuery("#container_domain_name").html("<a href='http://pfam.sanger.ac.uk/family/"+b+"'>"+b+"</a>"),jQuery("#container_domain_coord").html(c+"-"+d),jQuery("#container_evalue_stop").html(e),jQuery("#container_domain_length").html(f)}function draw_gene_copies(a){var b=a.gene_copies,c=a.sequence_start_y,d=(a.domainScale,a.leaf_group_x),e=a.domain_colors,f=a.sequence_rect_width,g=a.visibility,h={},i=b.enter().append("rect").attr("x",d+4).attr("y",function(a,b){return c+40+50*b}).attr("class","domain").attr("visibility",g).attr("rx",5).attr("ry",5).attr("transform","matrix(1,0,0,1,100,0)").attr("stroke","none").attr("width",function(){return f}).attr("height",function(){var a=40;return a}).attr("transform","rotate(-90 100 100)").attr("fill",function(a,b){return void 0===h[a.name]?(h[a.name]=e[b%5],"url(#"+e[b%5]+")"):"url(#"+h[a.name]+")"}).on("mouseover",show_gene_information);return i}function hide_internal_text(){d3.select("#tree svg").selectAll(".innerNode_label").text(function(a){return a.children?"":a.taxon})}function show_internal_text(){d3.select("#tree svg").selectAll(".innerNode_label").text(function(a){return"Y"==a.duplication?"":a.children?a.name:a.taxon})}function show_internal_text_important(){d3.select("#tree svg").selectAll(".innerNode_label").text(function(a){return a.children?show_taxa.hasOwnProperty(a.name)?"Y"==a.duplication?"":a.name:void 0:a.taxon})}function show_leaf_ids(){d3.select("#tree svg").selectAll(".tax_color_rect").attr("visibility","hidden"),d3.select("#tree svg").selectAll(".leaf_label").text(function(a){return a.name}).classed("species_name",!1)}function show_leaf_taxa(){d3.select("#tree svg").selectAll(".tax_color_rect").attr("visibility","hidden"),d3.select("#tree svg").selectAll(".leaf_label").text(function(a){return a.children?a.name:a.taxon}).classed("species_name",!0)}function show_leaf_common_name(a){var b=a.target;d3.select("#"+b+" svg").selectAll(".tax_color_rect").attr("visibility","hidden"),d3.select("#"+b+" svg").selectAll(".leaf_label").text(function(a){return get_right_leaf_name(a)})}function show_leaf_uniprot(a){var b=a.target;d3.select("#"+b+" svg").selectAll(".tax_color_rect").attr("visibility","hidden");new Object;d3.select("#"+b+" svg").selectAll(".leaf_label").classed("species_name",!1).text(function(a){var b;return b="NaN"==a.uniprot_name||"N/A"==a.uniprot_name?"not mapped":a.uniprot_name,a.children?"":b=b+", "+a.common_name}).style("fill",function(){})}function show_leaf_swissprot(){var a=(new Object,new Object);d3.select("#tree svg").selectAll(".leaf_label").text(function(a){return"NaN"==a.swissprot_gene_name&&(a.swissprot_gene_name="not mapped"),a.children?a.name:""+a.swissprot_gene_name+" ("+a.taxon+")"}),draw_taxon_colors({ID2Color:a})}function get_gene_color_stats(a){var b=(a.nodeEnter,a.target),c=(new Object,{}),d={},e=0,f="N/A";return d3.select("#"+b).selectAll("g.node").each(function(a){a.children||(void 0===c[a.display_label]?c[a.display_label]=1:c[a.display_label]++,e++)}),jQuery.each(c,function(a,b){d[a]=a===f||""===a?"N/A":b>=2?"top":"other"}),d}function hide_domains(){d3.select("#tree svg").selectAll(".domain").attr("visibility","hidden"),d3.select("#tree svg").selectAll(".seq_string").attr("visibility","hidden"),d3.select("#tree svg").selectAll(".domainlabel").attr("visibility","hidden")}function show_domains(){hide_conservation(),hide_synteny(),d3.select("#tree svg").selectAll(".domain").attr("visibility",""),d3.select("#tree svg").selectAll(".seq_string").attr("visibility",""),d3.select("#tree svg").selectAll(".domainlabel").attr("visibility","")}function hide_conservation(){d3.select("#tree svg").selectAll(".gap").attr("visibility","hidden"),d3.select("#tree svg").selectAll(".aligned_seq_string").attr("visibility","hidden")}function show_conservation(){hide_domains(),hide_synteny(),d3.select("#tree svg").selectAll(".gap").attr("visibility",""),d3.select("#tree svg").selectAll(".aligned_seq_string").attr("visibility","")}function hide_synteny(){d3.select("#tree svg").selectAll(".synteny").attr("visibility","hidden"),d3.select("#tree svg").selectAll(".synteny_seq_string").attr("visibility","hidden")}function show_synteny(){hide_domains(),hide_conservation(),d3.select("#tree svg").selectAll(".synteny").attr("visibility",""),d3.select("#tree svg").selectAll(".synteny_seq_string").attr("visibility","")}function show_bootstrap(){d3.select("#tree svg").selectAll(".bootstrap").attr("visibility","")}function hide_bootstrap(){d3.select("#tree svg").selectAll(".bootstrap").attr("visibility","hidden")}function hide_images(){d3.select("#tree svg").selectAll("image").attr("visibility","hidden")}function show_images(){d3.select("#tree svg").selectAll("image").attr("visibility","")}function hide_evol_nodes(){d3.select("#tree svg").selectAll("circle").attr("fill","black")}function show_evol_nodes(){d3.select("#tree svg").selectAll("image").attr("visibility",""),d3.select("#tree svg").selectAll("circle").attr("fill",function(a){return"Y"==a.duplication?"red":"green"}).on("click",click)}function show_taxon_colors(){d3.select("#tree svg").selectAll(".tax_color").attr("visibility","")}function hide_taxon_colors(){d3.select("#tree svg").selectAll(".tax_color").attr("visibility","hidden")}function decrease_font_size(){d3.select("svg").selectAll(".text").attr("font-size","4")}function zoom_slider(a){{var b=a.scale;d3.select(".drawarea").transition().duration(1e3).attr("transform"," scale("+b+")")}}function zoom(){{var a=[40,240,40,240],b=1e3-a[0]-a[0],c=(1760-a[0]-a[2],d3.event.scale);d3.event.translate,(-b+a[1])*c,(b-a[3])*c,d3.select(".annot_area").attr("transform"," scale("+c+")"),d3.select(".drawarea").attr("transform"," scale("+c+")")}}function show_orthologs(a){for(var b=[],c=a;!_.isUndefined(c)&&"Y"!=c.duplication;)b.push(c),c=c.parent;var d=[];d3.selectAll("path.link").filter(function(a){return _.any(b,function(b){return b===a.target})}).each(function(a){d.push(a)}),animateParentChain(d,b)}function animateParentChain(a,b,c){d3.selectAll("circle").data(b).enter().append("svg:circle").attr("r",function(a){return a.children?circle_size:0}).attr("fill",c);d3.svg.diagonal().projection(function(a){return[a.y,a.x]});ui.animGroup.selectAll("path.selected").data([]).exit().remove(),ui.animGroup.selectAll("path.selected").data(a).enter().append("svg:path").attr("class","selected link").attr("d",elbow);var d=ui.svgRoot.node().getBBox();ui.svgRoot.select("#clip-rect").attr("x",d.x+d.width).attr("y",d.y).attr("width",0).attr("height",d.height).transition().duration(500).attr("x",d.x).attr("width",d.width)}function show_tax_group(){for(var a in show_taxa){var b=d3.select("#tree svg").selectAll("[name=Eutheria]");return void b.each(function(a){get_all_children(a)})}}function color_subtree(a,b){var c=get_all_children(a),d=[];d3.selectAll("path.link").filter(function(a){return _.any(c,function(b){return b===a.target})}).each(function(a){d.push(a)}),b="darkgreen",animateParentChain(d,c,b)}function get_all_children(a){var b=new Array;return b=get_all_childs(a),null!=b&&b.forEach(function(){}),b}function get_all_childs(a){var b=new Array;if(!a.children)return b.push(a),b;for(var c=a.children,d=0;d<c.length;d++){var e=new Array;null!=e&&(e=get_all_childs(c[d]),e.forEach(function(a){b.push(a)}))}return b.push(a),b}function submit_download_form(a){var b=document.getElementById("tree"),c=b.getElementsByTagName("svg")[0],d=(new XMLSerializer).serializeToString(c),e=document.getElementById("svgform");e.output_format.value=a,e.data.value=d,e.submit()}function show_svg_code(){var a=document.getElementById("tree"),b=a.getElementsByTagName("svg")[0],c=(new XMLSerializer).serializeToString(b);c=vkbeautify.xml(c),jQuery("#svg_code").text(c),prettyPrint()}function search_gene(a,b){d3.select("#tree svg").selectAll(".leaf_label").text(function(a){return a.name==b?"":a.children?a.name:a.taxon})}function species2sourceDB_mapping(a){var b=a.species,c=a.identifier,d=(new Object,new Object,new Object),e="";return d.acyrthosiphon_pisum="http://metazoa.ensembl.org/id/",d.aedes_aegypti="http://metazoa.ensembl.org/id/",d.ailuropoda_melanoleuca="http://www.ensembl.org/id/",d.amphimedon_queenslandica="http://metazoa.ensembl.org/id/",d.anolis_carolinensis="http://www.ensembl.org/id/",d.anopheles_darlingi="http://metazoa.ensembl.org/id/",d.anopheles_gambiae="http://metazoa.ensembl.org/id/",d.apis_mellifera="http://metazoa.ensembl.org/id/",d.arabidopsis_thaliana="http://plants.ensembl.org/id/",d.atta_cephalotes="http://metazoa.ensembl.org/id/",d.bombyx_mori="http://metazoa.ensembl.org/id/",d.bos_taurus="http://www.ensembl.org/id/",d.bursaphelenchus_xylophilus="http://www.wormbase.org/search/gene/",d.caenorhabditis_brenneri="http://metazoa.ensembl.org/id/",d.caenorhabditis_briggsae="http://metazoa.ensembl.org/id/",d.caenorhabditis_elegans="http://metazoa.ensembl.org/id/",d.caenorhabditis_japonica="http://metazoa.ensembl.org/id/",d.caenorhabditis_remanei="http://metazoa.ensembl.org/id/",d.callithrix_jacchus="http://www.ensembl.org/id/",d.canis_familiaris="http://www.ensembl.org/id/",d.capitella_teleta="http://genome.jgi-psf.org/cgi-bin/dispGeneModel?db=Capca1&id=",d.cavia_porcellus="http://www.ensembl.org/id/",d.choloepus_hoffmanni="http://www.ensembl.org/id/",d.ciona_intestinalis="http://www.ensembl.org/id/",d.ciona_savignyi="http://www.ensembl.org/id/",d.culex_quinquefasciatus="http://metazoa.ensembl.org/id/",d.danaus_plexippus="http://metazoa.ensembl.org/id/",d.danio_rerio="http://www.ensembl.org/id/",d.daphnia_pulex="http://metazoa.ensembl.org/id/",d.dasypus_novemcinctus="http://www.ensembl.org/id/",d.dipodomys_ordii="http://www.ensembl.org/id/",d.drosophila_ananassae="http://metazoa.ensembl.org/id/",d.drosophila_erecta="http://metazoa.ensembl.org/id/",d.drosophila_grimshawi="http://metazoa.ensembl.org/id/",d.drosophila_melanogaster="http://metazoa.ensembl.org/id/",d.drosophila_mojavensis="http://metazoa.ensembl.org/id/",d.drosophila_persimilis="http://metazoa.ensembl.org/id/",d.drosophila_pseudoobscura="http://metazoa.ensembl.org/id/",d.drosophila_sechellia="http://metazoa.ensembl.org/id/",d.drosophila_simulans="http://metazoa.ensembl.org/id/",d.drosophila_virilis="http://metazoa.ensembl.org/id/",d.drosophila_willistoni="http://metazoa.ensembl.org/id/",d.drosophila_yakuba="http://metazoa.ensembl.org/id/",d.echinops_telfairi="http://www.ensembl.org/id/",d.equus_caballus="http://www.ensembl.org/id/",d.erinaceus_europaeus="http://www.ensembl.org/id/",d.felis_catus="http://www.ensembl.org/id/",d.gadus_morhua="http://www.ensembl.org/id/",d.gallus_gallus="http://www.ensembl.org/id/",d.gasterosteus_aculeatus="http://www.ensembl.org/id/",d.gorilla_gorilla="http://www.ensembl.org/id/",d.heliconius_melpomene="http://metazoa.ensembl.org/id/",d.helobdella_robusta="http://genome.jgi-psf.org/cgi-bin/dispGeneModel?db=Helro1&id=",d.heterorhabditis_bacteriophora="http://www.wormbase.org/search/gene/",d.homo_sapiens="http://www.ensembl.org/id/",d.ictidomys_tridecemlineatus="http://www.ensembl.org/id/",d.ixodes_scapularis="http://metazoa.ensembl.org/id/",d.latimeria_chalumnae="http://www.ensembl.org/id/",d.lottia_gigantea="http://genome.jgi-psf.org/cgi-bin/dispGeneModel?db=Lotgi1&id=",d.loxodonta_africana="http://www.ensembl.org/id/",d.macaca_mulatta="http://www.ensembl.org/id/",d.macropus_eugenii="http://www.ensembl.org/id/",d.meleagris_gallopavo="http://www.ensembl.org/id/",d.meloidogyne_hapla="http://www.wormbase.org/search/gene/",d.microcebus_murinus="http://www.ensembl.org/id/",d.monodelphis_domestica="http://www.ensembl.org/id/",d.monosiga_brevicollis="http://genome.jgi-psf.org/cgi-bin/dispGeneModel?db=Monbr1&id=",d.mustela_putorius_furo="http://www.ensembl.org/id/",d.mus_musculus="http://www.ensembl.org/id/",d.myotis_lucifugus="http://www.ensembl.org/id/",d.nasonia_vitripennis="http://metazoa.ensembl.org/id/",d.nematostella_vectensis="http://metazoa.ensembl.org/id/",d.nomascus_leucogenys="http://www.ensembl.org/id/",d.ochotona_princeps="http://www.ensembl.org/id/",d.oreochromis_niloticus="http://www.ensembl.org/id/",d.ornithorhynchus_anatinus="http://www.ensembl.org/id/",d.oryctolagus_cuniculus="http://www.ensembl.org/id/",d.oryzias_latipes="http://www.ensembl.org/id/",d.otolemur_garnettii="http://www.ensembl.org/id/",d.pan_troglodytes="http://www.ensembl.org/id/",d.pediculus_humanus="http://metazoa.ensembl.org/id/",d.pelodiscus_sinensis="http://www.ensembl.org/id/",d.petromyzon_marinus="http://www.ensembl.org/id/",d.pongo_abelii="http://www.ensembl.org/id/",d.pristionchus_pacificus="http://metazoa.ensembl.org/id/",d.procavia_capensis="http://www.ensembl.org/id/",d.proterospongia_sp="nle_MAKER_updated_Ensembl",d.pteropus_vampyrus="http://www.ensembl.org/id/",d.rattus_norvegicus="http://www.ensembl.org/id/",d.saccharomyces_cerevisiae="http://fungi.ensembl.org/id/",d.sarcophilus_harrisii="http://www.ensembl.org/id/",d.schistosoma_mansoni="http://metazoa.ensembl.org/id/",d.schizosaccharomyces_pombe="http://metazoa.ensembl.org/id/",d.sorex_araneus="http://www.ensembl.org/id/",d.strongylocentrotus_purpuratus="http://metazoa.ensembl.org/id/",d.strongyloides_ratti="http://www.wormbase.org/search/gene/",d.sus_scrofa="http://www.ensembl.org/id/",d.taeniopygia_guttata="http://www.ensembl.org/id/",d.takifugu_rubripes="http://www.ensembl.org/id/",d.tarsius_syrichta="http://www.ensembl.org/id/",d.tetraodon_nigroviridis="http://www.ensembl.org/id/",d.tribolium_castaneum="http://metazoa.ensembl.org/id/",d.trichinella_spiralis="http://metazoa.ensembl.org/id/",d.trichoplax_adhaerens="http://metazoa.ensembl.org/id/",d.tupaia_belangeri="http://www.ensembl.org/id/",d.tursiops_truncatus="http://www.ensembl.org/id/",d.vicugna_pacos="http://www.ensembl.org/id/",d.xenopus_tropicalis="http://www.ensembl.org/id/",d.xiphophorus_maculatus="http://www.ensembl.org/id/",void 0==b?"":e=d[b.toLowerCase()]+c
}Array.prototype.insert=function(a,b){this.splice(a,0,b)};