Pixastic.Actions.rotate={process:function(a){if(Pixastic.Client.hasCanvas()){var b=a.canvas,c=a.width,d=a.height,e=document.createElement("canvas");e.width=c,e.height=d,e.getContext("2d").drawImage(b,0,0,c,d);var f=-parseFloat(a.options.angle)*Math.PI/180,g=f;g>.5*Math.PI&&(g=Math.PI-g),g<.5*-Math.PI&&(g=-Math.PI-g);var h=Math.sqrt(c*c+d*d),i=Math.abs(g)-Math.abs(Math.atan2(d,c)),j=Math.abs(g)+Math.abs(Math.atan2(d,c)),k=Math.abs(Math.cos(i)*h),l=Math.abs(Math.sin(j)*h);b.width=k,b.height=l;var m=b.getContext("2d");return m.translate(k/2,l/2),m.rotate(f),m.drawImage(e,-c/2,-d/2),a.useData=!1,!0}},checkSupport:function(){return Pixastic.Client.hasCanvas()}};