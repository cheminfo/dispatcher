Pixastic.Actions.emboss={process:function(a){var b=parseFloat(a.options.strength)||1,c="undefined"!=typeof a.options.greyLevel?parseInt(a.options.greyLevel):180,d=a.options.direction||"topleft",e=!(!a.options.blend||"false"==a.options.blend),f=0,g=0;switch(d){case"topleft":f=-1,g=-1;break;case"top":f=-1,g=0;break;case"topright":f=-1,g=1;break;case"right":f=0,g=1;break;case"bottomright":f=1,g=1;break;case"bottom":f=1,g=0;break;case"bottomleft":f=1,g=-1;break;case"left":f=0,g=-1}if(Pixastic.Client.hasCanvasImageData()){var h=Pixastic.prepareData(a),i=Pixastic.prepareData(a,!0),j=(!!a.options.invertAlpha,a.options.rect),k=j.width,l=j.height,m=4*k,n=l;do{var o=(n-1)*m,p=f;1>n+p&&(p=0),n+p>l&&(p=0);var q=(n-1+p)*k*4,r=k;do{var s=o+4*(r-1),t=g;1>r+t&&(t=0),r+t>k&&(t=0);var u=q+4*(r-1+t),v=i[s]-i[u],w=i[s+1]-i[u+1],x=i[s+2]-i[u+2],y=v,z=y>0?y:-y,A=w>0?w:-w,B=x>0?x:-x;if(A>z&&(y=w),B>z&&(y=x),y*=b,e){var C=h[s]+y,D=h[s+1]+y,E=h[s+2]+y;h[s]=C>255?255:0>C?0:C,h[s+1]=D>255?255:0>D?0:D,h[s+2]=E>255?255:0>E?0:E}else{var F=c-y;0>F?F=0:F>255&&(F=255),h[s]=h[s+1]=h[s+2]=F}}while(--r)}while(--n);return!0}return Pixastic.Client.isIE()?(a.image.style.filter+=" progid:DXImageTransform.Microsoft.emboss()",!0):void 0},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()||Pixastic.Client.isIE()}};