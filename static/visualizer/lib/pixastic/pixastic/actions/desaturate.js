Pixastic.Actions.desaturate={process:function(a){var b=!(!a.options.average||"false"==a.options.average);if(Pixastic.Client.hasCanvasImageData()){var c,d,e=Pixastic.prepareData(a),f=a.options.rect,g=f.width,h=f.height,i=g*h,j=4*i;if(b)for(;i--;)e[j-=4]=e[c=j+1]=e[d=j+2]=(e[j]+e[c]+e[d])/3;else for(;i--;)e[j-=4]=e[c=j+1]=e[d=j+2]=.3*e[j]+.59*e[c]+.11*e[d];return!0}return Pixastic.Client.isIE()?(a.image.style.filter+=" gray",!0):void 0},checkSupport:function(){return Pixastic.Client.hasCanvasImageData()||Pixastic.Client.isIE()}};