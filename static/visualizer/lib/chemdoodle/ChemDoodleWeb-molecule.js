var ChemDoodle=function(){var a={};a.structures={},a.iChemLabs={},a.informatics={},a.io={};var b="4.7.0";return a.getVersion=function(){return b},a}();!function(a,b,c,d,e){b.SERVER_URL="http://ichemlabs.cloud.chemdoodle.com/ICL_servlets/WebHQ1",b.inRelay=!1,b.asynchronous=!0,b.INFO={userAgent:navigator.userAgent,v_cwc:a.getVersion(),v_jQuery:e.version,v_jQuery_ui:e.ui?e.ui.version:"N/A"},b.contactServer=function(a,c,d,f){this.inRelay?alert("Already connecting to the server, please wait for the first request to finish."):(b.inRelay=!0,e.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:a,content:c,info:b.INFO}),url:this.SERVER_URL,success:function(a){b.inRelay=!1,o=JSON.parse(a),o.message&&alert(o.message),null!=d&&o.content&&!o.stop&&d(o.content),o.stop&&null!=f&&f()},error:function(){b.inRelay=!1,alert("Server connectivity failed. Please try again or update this browser to the latest version. (XHR2 not supported)"),null!=f&&f()},beforeSend:function(a){a.withCredentials=!0},async:b.asynchronous}))},b.optimize=function(a,b,d,e){this.contactServer("optimize",{mol:c.toJSONDummy(a),dimension:b},function(e){var f=c.fromJSONDummy(e.mol);if(2==b){for(var g=0,h=f.atoms.length;h>g;g++)a.atoms[g].x=f.atoms[g].x,a.atoms[g].y=f.atoms[g].y;d()}else if(3==b){for(var g=0,h=f.atoms.length;h>g;g++)f.atoms[g].x/=20,f.atoms[g].y/=20,f.atoms[g].z/=20;d(f)}},e)},b.readSMILES=function(a,b,d){this.contactServer("readSMILES",{smiles:a},function(a){b(c.fromJSONDummy(a.mol))},d)},b.writeSMILES=function(a,b,d){this.contactServer("writeSMILES",{mol:c.toJSONDummy(a)},function(a){b(a.smiles)},d)},b.saveFile=function(a,b,d,e){this.contactServer("saveFile",{mol:c.toJSONDummy(a),ext:b},function(a){d(a.link)},e)},b.getMoleculeFromDatabase=function(a,b,d,e,f){this.contactServer("getMoleculeFromDatabase",{database:a,dimension:e?e:2,query:b},function(a){if(3==e)for(var b=0,f=a.mol.a.length;f>b;b++)a.mol.a[b].x/=20,a.mol.a[b].y/=-20,a.mol.a[b].z/=20;d(c.fromJSONDummy(a.mol))},f)},b.getMoleculeFromContent=function(a,b,c,d){this.contactServer("getMoleculeFromContent",{content:a,format:b},function(a){for(var b=!1,d=0,e=a.mol.a.length;e>d;d++)if(0!=a.mol.a[d].z){b=!0;break}if(b)for(var d=0,e=a.mol.a.length;e>d;d++)a.mol.a[d].x/=20,a.mol.a[d].y/=20,a.mol.a[d].z/=20;c(ChemDoodle.io.fromJSONDummy(a.mol))},d)},b.calculate=function(a,b,d,e){this.contactServer("calculate",{mol:c.toJSONDummy(a),descriptors:b},function(a){d(a)},e)},b.simulate1HNMR=function(b,d,e){this.contactServer("simulateNMR",{mol:c.toJSONDummy(b),nucleus:"H",isotope:1},function(b){d(a.readJCAMP(b.jcamp))},e)},b.simulate13CNMR=function(b,d,e){this.contactServer("simulateNMR",{mol:c.toJSONDummy(b),nucleus:"C",isotope:13},function(b){d(a.readJCAMP(b.jcamp))},e)},b.simulateMassParentPeak=function(b,d,e){this.contactServer("simulateMassParentPeak",{mol:c.toJSONDummy(b)},function(b){d(a.readJCAMP(b.jcamp))},e)},b.getOptimizedPDBStructure=function(a,b,e,f){this.contactServer("getOptimizedPDBStructure",{id:a,withAtoms:b},function(a){var b=null;if(a.mol)b=c.fromJSONDummy(a.mol);else var b=new d.Molecule;b.chains=c.fromJSONChains(a.ribbons),b.fromJSON=!0,e(b)},f)},b.getAd=function(a,b){this.contactServer("getAd",{},function(b){a(b.image_url,b.target_url)},b)},b.kekulize=function(a,b,d){this.contactServer("kekulize",{mol:c.toJSONDummy(a)},function(a){b(c.fromJSONDummy(a.mol))},d)},b.isGraphIsomorphism=function(a,b,d,e){this.contactServer("isGraphIsomorphism",{arrow:c.toJSONDummy(a),target:c.toJSONDummy(b)},function(a){d(a.value)},e)},b.isSubgraphIsomorphism=function(a,b,d,e){this.contactServer("isSubgraphIsomorphism",{arrow:c.toJSONDummy(a),target:c.toJSONDummy(b)},function(a){d(a.value)},e)},b.readIUPACName=function(a,b,d){this.contactServer("readIUPACName",{iupac:a},function(a){b(c.fromJSONDummy(a.mol))},d)},b.generateImage=function(a,b,d,e){this.contactServer("generateImage",{mol:c.toJSONDummy(a),ext:b},function(a){d(a.link)},e)},b.getZeoliteFromIZA=function(a,b,c,d,e,f){this.contactServer("getZeoliteFromIZA",{query:a},function(a){b(ChemDoodle.readCIF(a.cif,c,d,e))},f)}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,jQuery),ChemDoodle.extensions=function(a,b,c){var d={};return d.stringStartsWith=function(a,b){return a.match("^"+b)==b},d.vec3AngleFrom=function(a,d){var e=b.length(a),f=b.length(d),g=b.dot(a,d),h=g/e/f;return c.acos(h)},d.contextHashTo=function(b,c,d,e,f,g,h){for(var i=0,j=new a.Point(c,d).distance(new a.Point(e,f)),k=!1,l=c,m=d,n=e-c,o=f-d;j>i;){if(k){if(i+h>j){b.moveTo(e,f);break}var p=h/j;l+=p*n,m+=p*o,b.moveTo(l,m),i+=h}else{if(i+g>j){b.lineTo(e,f);break}var p=g/j;l+=p*n,m+=p*o,b.lineTo(l,m),i+=g}k=!k}},d.contextRoundRect=function(a,b,c,d,e,f){a.beginPath(),a.moveTo(b+f,c),a.lineTo(b+d-f,c),a.quadraticCurveTo(b+d,c,b+d,c+f),a.lineTo(b+d,c+e-f),a.quadraticCurveTo(b+d,c+e,b+d-f,c+e),a.lineTo(b+f,c+e),a.quadraticCurveTo(b,c+e,b,c+e-f),a.lineTo(b,c+f),a.quadraticCurveTo(b,c,b+f,c),a.closePath()},d.contextEllipse=function(a,b,c,d,e){var f=.5522848,g=d/2*f,h=e/2*f,i=b+d,j=c+e,k=b+d/2,l=c+e/2;a.beginPath(),a.moveTo(b,l),a.bezierCurveTo(b,l-h,k-g,c,k,c),a.bezierCurveTo(k+g,c,i,l-h,i,l),a.bezierCurveTo(i,l+h,k+g,j,k,j),a.bezierCurveTo(k-g,j,b,l+h,b,l),a.closePath()},d}(ChemDoodle.structures,vec3,Math),ChemDoodle.math=function(a,b,c){var d={},e={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return d.angleBetweenLargest=function(a){if(0==a.length)return{angle:0,largest:2*c.PI};if(1==a.length)return{angle:a[0]+c.PI,largest:2*c.PI};for(var b=0,d=0,e=-1,f=0,g=a.length-1;g>f;f++){var h=a[f+1]-a[f];h>b&&(b=h,d=(a[f+1]+a[f])/2,e=f)}var i=a[0]+2*c.PI-a[a.length-1];return i>b&&(d=a[0]-i/2,b=i,0>d&&(d+=2*c.PI),e=a.length-1),{angle:d,largest:b}},d.isBetween=function(a,b,c){return a>=b&&c>=a},d.getRGB=function(b,c){var d=[0,0,0];if(null!=e[b.toLowerCase()]&&(b=e[b.toLowerCase()]),"#"==b.charAt(0))return 4==b.length&&(b="#"+b.charAt(1)+b.charAt(1)+b.charAt(2)+b.charAt(2)+b.charAt(3)+b.charAt(3)),[parseInt(b.substring(1,3),16)/255*c,parseInt(b.substring(3,5),16)/255*c,parseInt(b.substring(5,7),16)/255*c];if(a.stringStartsWith(b,"rgb")){var f=b.replace(/rgb\(|\)/g,"").split(",");return 3!=f.length?d:[parseInt(f[0])/255*c,parseInt(f[1])/255*c,parseInt(f[2])/255*c]}return d},d.distanceFromPointToLineInclusive=function(a,e,f){var g=e.distance(f),h=e.angle(f),i=c.PI/2-h,j=(new b.Point(a.x-e.x,a.y-e.x),new b.Point,e.angle(a)+i),k=e.distance(a);return pcopRot=new b.Point(k*c.cos(j),-k*c.sin(j)),d.isBetween(-pcopRot.y,0,g)?c.abs(pcopRot.x):-1},d.calculateDistanceInterior=function(a,b,d){if(this.isBetween(b.x,d.x,d.x+d.w)&&this.isBetween(b.y,d.y,d.y+d.w))return a.distance(b);var e=[];e.push({x1:d.x,y1:d.y,x2:d.x+d.w,y2:d.y}),e.push({x1:d.x,y1:d.y+d.h,x2:d.x+d.w,y2:d.y+d.h}),e.push({x1:d.x,y1:d.y,x2:d.x,y2:d.y+d.h}),e.push({x1:d.x+d.w,y1:d.y,x2:d.x+d.w,y2:d.y+d.h});for(var f=[],g=0;4>g;g++){var h=e[g],i=this.intersectLines(b.x,b.y,a.x,a.y,h.x1,h.y1,h.x2,h.y2);i&&f.push(i)}if(0==f.length)return 0;for(var j=0,g=0,k=f.length;k>g;g++){var i=f[g],l=a.x-i.x,m=a.y-i.y;j=c.max(j,c.sqrt(l*l+m*m))}return j},d.intersectLines=function(a,b,c,d,e,f,g,h){c-=a,d-=b,g-=e,h-=f;var i=d*g-c*h;if(0==i)return!1;var j=(h*(a-e)-g*(b-f))/i,k=(d*(a-e)-c*(b-f))/i;return k>=0&&1>=k&&j>=0&&1>=j?{x:a+j*c,y:b+j*d}:!1},d.hsl2rgb=function(a,b,c){function d(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+(b-a)*(2/3-c)*6:a}var e,f,g;if(0==b)e=f=g=c;else{var h=.5>c?c*(1+b):c+b-c*b,i=2*c-h;e=d(i,h,a+1/3),f=d(i,h,a),g=d(i,h,a-1/3)}return[255*e,255*f,255*g]},d}(ChemDoodle.extensions,ChemDoodle.structures,Math),ChemDoodle.featureDetection=function(a,b,c,d){var e={};return e.supports_canvas=function(){return!!c.createElement("canvas").getContext},e.supports_canvas_text=function(){if(!e.supports_canvas())return!1;var a=c.createElement("canvas"),b=a.getContext("2d");return"function"==typeof b.fillText},e.supports_webgl=function(){var a=c.createElement("canvas");try{if(a.getContext("webgl"))return!0;if(a.getContext("experimental-webgl"))return!0}catch(b){}return!1},e.supports_xhr2=function(){return b.support.cors},e.supports_touch=function(){return"ontouchstart"in d},e.supports_gesture=function(){return"ongesturestart"in d},e}(ChemDoodle.iChemLabs,jQuery,document,window),ChemDoodle.SYMBOLS=["H","He","Li","Be","B","C","N","O","F","Ne","Na","Mg","Al","Si","P","S","Cl","Ar","K","Ca","Sc","Ti","V","Cr","Mn","Fe","Co","Ni","Cu","Zn","Ga","Ge","As","Se","Br","Kr","Rb","Sr","Y","Zr","Nb","Mo","Tc","Ru","Rh","Pd","Ag","Cd","In","Sn","Sb","Te","I","Xe","Cs","Ba","La","Ce","Pr","Nd","Pm","Sm","Eu","Gd","Tb","Dy","Ho","Er","Tm","Yb","Lu","Hf","Ta","W","Re","Os","Ir","Pt","Au","Hg","Tl","Pb","Bi","Po","At","Rn","Fr","Ra","Ac","Th","Pa","U","Np","Pu","Am","Cm","Bk","Cf","Es","Fm","Md","No","Lr","Rf","Db","Sg","Bh","Hs","Mt","Ds","Rg","Cn","Uut","Uuq","Uup","Uuh","Uus","Uuo"],ChemDoodle.ELEMENT=function(a){function b(a,b,c){return this.symbol=a,this.name=b,this.atomicNumber=c,!0}var c=[];c.H=new b("H","Hydrogen",1),c.He=new b("He","Helium",2),c.Li=new b("Li","Lithium",3),c.Be=new b("Be","Beryllium",4),c.B=new b("B","Boron",5),c.C=new b("C","Carbon",6),c.N=new b("N","Nitrogen",7),c.O=new b("O","Oxygen",8),c.F=new b("F","Fluorine",9),c.Ne=new b("Ne","Neon",10),c.Na=new b("Na","Sodium",11),c.Mg=new b("Mg","Magnesium",12),c.Al=new b("Al","Aluminum",13),c.Si=new b("Si","Silicon",14),c.P=new b("P","Phosphorus",15),c.S=new b("S","Sulfur",16),c.Cl=new b("Cl","Chlorine",17),c.Ar=new b("Ar","Argon",18),c.K=new b("K","Potassium",19),c.Ca=new b("Ca","Calcium",20),c.Sc=new b("Sc","Scandium",21),c.Ti=new b("Ti","Titanium",22),c.V=new b("V","Vanadium",23),c.Cr=new b("Cr","Chromium",24),c.Mn=new b("Mn","Manganese",25),c.Fe=new b("Fe","Iron",26),c.Co=new b("Co","Cobalt",27),c.Ni=new b("Ni","Nickel",28),c.Cu=new b("Cu","Copper",29),c.Zn=new b("Zn","Zinc",30),c.Ga=new b("Ga","Gallium",31),c.Ge=new b("Ge","Germanium",32),c.As=new b("As","Arsenic",33),c.Se=new b("Se","Selenium",34),c.Br=new b("Br","Bromine",35),c.Kr=new b("Kr","Krypton",36),c.Rb=new b("Rb","Rubidium",37),c.Sr=new b("Sr","Strontium",38),c.Y=new b("Y","Yttrium",39),c.Zr=new b("Zr","Zirconium",40),c.Nb=new b("Nb","Niobium",41),c.Mo=new b("Mo","Molybdenum",42),c.Tc=new b("Tc","Technetium",43),c.Ru=new b("Ru","Ruthenium",44),c.Rh=new b("Rh","Rhodium",45),c.Pd=new b("Pd","Palladium",46),c.Ag=new b("Ag","Silver",47),c.Cd=new b("Cd","Cadmium",48),c.In=new b("In","Indium",49),c.Sn=new b("Sn","Tin",50),c.Sb=new b("Sb","Antimony",51),c.Te=new b("Te","Tellurium",52),c.I=new b("I","Iodine",53),c.Xe=new b("Xe","Xenon",54),c.Cs=new b("Cs","Cesium",55),c.Ba=new b("Ba","Barium",56),c.La=new b("La","Lanthanum",57),c.Ce=new b("Ce","Cerium",58),c.Pr=new b("Pr","Praseodymium",59),c.Nd=new b("Nd","Neodymium",60),c.Pm=new b("Pm","Promethium",61),c.Sm=new b("Sm","Samarium",62),c.Eu=new b("Eu","Europium",63),c.Gd=new b("Gd","Gadolinium",64),c.Tb=new b("Tb","Terbium",65),c.Dy=new b("Dy","Dysprosium",66),c.Ho=new b("Ho","Holmium",67),c.Er=new b("Er","Erbium",68),c.Tm=new b("Tm","Thulium",69),c.Yb=new b("Yb","Ytterbium",70),c.Lu=new b("Lu","Lutetium",71),c.Hf=new b("Hf","Hafnium",72),c.Ta=new b("Ta","Tantalum",73),c.W=new b("W","Tungsten",74),c.Re=new b("Re","Rhenium",75),c.Os=new b("Os","Osmium",76),c.Ir=new b("Ir","Iridium",77),c.Pt=new b("Pt","Platinum",78),c.Au=new b("Au","Gold",79),c.Hg=new b("Hg","Mercury",80),c.Tl=new b("Tl","Thallium",81),c.Pb=new b("Pb","Lead",82),c.Bi=new b("Bi","Bismuth",83),c.Po=new b("Po","Polonium",84),c.At=new b("At","Astatine",85),c.Rn=new b("Rn","Radon",86),c.Fr=new b("Fr","Francium",87),c.Ra=new b("Ra","Radium",88),c.Ac=new b("Ac","Actinium",89),c.Th=new b("Th","Thorium",90),c.Pa=new b("Pa","Protactinium",91),c.U=new b("U","Uranium",92),c.Np=new b("Np","Neptunium",93),c.Pu=new b("Pu","Plutonium",94),c.Am=new b("Am","Americium",95),c.Cm=new b("Cm","Curium",96),c.Bk=new b("Bk","Berkelium",97),c.Cf=new b("Cf","Californium",98),c.Es=new b("Es","Einsteinium",99),c.Fm=new b("Fm","Fermium",100),c.Md=new b("Md","Mendelevium",101),c.No=new b("No","Nobelium",102),c.Lr=new b("Lr","Lawrencium",103),c.Rf=new b("Rf","Rutherfordium",104),c.Db=new b("Db","Dubnium",105),c.Sg=new b("Sg","Seaborgium",106),c.Bh=new b("Bh","Bohrium",107),c.Hs=new b("Hs","Hassium",108),c.Mt=new b("Mt","Meitnerium",109),c.Ds=new b("Ds","Darmstadtium",110),c.Rg=new b("Rg","Roentgenium",111),c.Cn=new b("Cn","Copernicium",112),c.Uut=new b("Uut","Ununtrium",113),c.Uuq=new b("Uuq","Ununquadium",114),c.Uup=new b("Uup","Ununpentium",115),c.Uuh=new b("Uuh","Ununhexium",116),c.Uus=new b("Uus","Ununseptium",117),c.Uuo=new b("Uuo","Ununoctium",118),c.H.jmolColor="#FFFFFF",c.He.jmolColor="#D9FFFF",c.Li.jmolColor="#CC80FF",c.Be.jmolColor="#C2FF00",c.B.jmolColor="#FFB5B5",c.C.jmolColor="#909090",c.N.jmolColor="#3050F8",c.O.jmolColor="#FF0D0D",c.F.jmolColor="#90E050",c.Ne.jmolColor="#B3E3F5",c.Na.jmolColor="#AB5CF2",c.Mg.jmolColor="#8AFF00",c.Al.jmolColor="#BFA6A6",c.Si.jmolColor="#F0C8A0",c.P.jmolColor="#FF8000",c.S.jmolColor="#FFFF30",c.Cl.jmolColor="#1FF01F",c.Ar.jmolColor="#80D1E3",c.K.jmolColor="#8F40D4",c.Ca.jmolColor="#3DFF00",c.Sc.jmolColor="#E6E6E6",c.Ti.jmolColor="#BFC2C7",c.V.jmolColor="#A6A6AB",c.Cr.jmolColor="#8A99C7",c.Mn.jmolColor="#9C7AC7",c.Fe.jmolColor="#E06633",c.Co.jmolColor="#F090A0",c.Ni.jmolColor="#50D050",c.Cu.jmolColor="#C88033",c.Zn.jmolColor="#7D80B0",c.Ga.jmolColor="#C28F8F",c.Ge.jmolColor="#668F8F",c.As.jmolColor="#BD80E3",c.Se.jmolColor="#FFA100",c.Br.jmolColor="#A62929",c.Kr.jmolColor="#5CB8D1",c.Rb.jmolColor="#702EB0",c.Sr.jmolColor="#00FF00",c.Y.jmolColor="#94FFFF",c.Zr.jmolColor="#94E0E0",c.Nb.jmolColor="#73C2C9",c.Mo.jmolColor="#54B5B5",c.Tc.jmolColor="#3B9E9E",c.Ru.jmolColor="#248F8F",c.Rh.jmolColor="#0A7D8C",c.Pd.jmolColor="#006985",c.Ag.jmolColor="#C0C0C0",c.Cd.jmolColor="#FFD98F",c.In.jmolColor="#A67573",c.Sn.jmolColor="#668080",c.Sb.jmolColor="#9E63B5",c.Te.jmolColor="#D47A00",c.I.jmolColor="#940094",c.Xe.jmolColor="#429EB0",c.Cs.jmolColor="#57178F",c.Ba.jmolColor="#00C900",c.La.jmolColor="#70D4FF",c.Ce.jmolColor="#FFFFC7",c.Pr.jmolColor="#D9FFC7",c.Nd.jmolColor="#C7FFC7",c.Pm.jmolColor="#A3FFC7",c.Sm.jmolColor="#8FFFC7",c.Eu.jmolColor="#61FFC7",c.Gd.jmolColor="#45FFC7",c.Tb.jmolColor="#30FFC7",c.Dy.jmolColor="#1FFFC7",c.Ho.jmolColor="#00FF9C",c.Er.jmolColor="#00E675",c.Tm.jmolColor="#00D452",c.Yb.jmolColor="#00BF38",c.Lu.jmolColor="#00AB24",c.Hf.jmolColor="#4DC2FF",c.Ta.jmolColor="#4DA6FF",c.W.jmolColor="#2194D6",c.Re.jmolColor="#267DAB",c.Os.jmolColor="#266696",c.Ir.jmolColor="#175487",c.Pt.jmolColor="#D0D0E0",c.Au.jmolColor="#FFD123",c.Hg.jmolColor="#B8B8D0",c.Tl.jmolColor="#A6544D",c.Pb.jmolColor="#575961",c.Bi.jmolColor="#9E4FB5",c.Po.jmolColor="#AB5C00",c.At.jmolColor="#754F45",c.Rn.jmolColor="#428296",c.Fr.jmolColor="#420066",c.Ra.jmolColor="#007D00",c.Ac.jmolColor="#70ABFA",c.Th.jmolColor="#00BAFF",c.Pa.jmolColor="#00A1FF",c.U.jmolColor="#008FFF",c.Np.jmolColor="#0080FF",c.Pu.jmolColor="#006BFF",c.Am.jmolColor="#545CF2",c.Cm.jmolColor="#785CE3",c.Bk.jmolColor="#8A4FE3",c.Cf.jmolColor="#A136D4",c.Es.jmolColor="#B31FD4",c.Fm.jmolColor="#B31FBA",c.Md.jmolColor="#B30DA6",c.No.jmolColor="#BD0D87",c.Lr.jmolColor="#C70066",c.Rf.jmolColor="#CC0059",c.Db.jmolColor="#D1004F",c.Sg.jmolColor="#D90045",c.Bh.jmolColor="#E00038",c.Hs.jmolColor="#E6002E",c.Mt.jmolColor="#EB0026",c.Ds.jmolColor="#000000",c.Rg.jmolColor="#000000",c.Cn.jmolColor="#000000",c.Uut.jmolColor="#000000",c.Uuq.jmolColor="#000000",c.Uup.jmolColor="#000000",c.Uuh.jmolColor="#000000",c.Uus.jmolColor="#000000",c.Uuo.jmolColor="#000000";for(var d=0,e=a.length;e>d;d++)c[a[d]].pymolColor=c[a[d]].jmolColor;return c.H.pymolColor="#E6E6E6",c.C.pymolColor="#33FF33",c.N.pymolColor="#3333FF",c.O.pymolColor="#FF4D4D",c.F.pymolColor="#B3FFFF",c.S.pymolColor="#E6C640",c.H.covalentRadius=.31,c.He.covalentRadius=.28,c.Li.covalentRadius=1.28,c.Be.covalentRadius=.96,c.B.covalentRadius=.84,c.C.covalentRadius=.76,c.N.covalentRadius=.71,c.O.covalentRadius=.66,c.F.covalentRadius=.57,c.Ne.covalentRadius=.58,c.Na.covalentRadius=1.66,c.Mg.covalentRadius=1.41,c.Al.covalentRadius=1.21,c.Si.covalentRadius=1.11,c.P.covalentRadius=1.07,c.S.covalentRadius=1.05,c.Cl.covalentRadius=1.02,c.Ar.covalentRadius=1.06,c.K.covalentRadius=2.03,c.Ca.covalentRadius=1.76,c.Sc.covalentRadius=1.7,c.Ti.covalentRadius=1.6,c.V.covalentRadius=1.53,c.Cr.covalentRadius=1.39,c.Mn.covalentRadius=1.39,c.Fe.covalentRadius=1.32,c.Co.covalentRadius=1.26,c.Ni.covalentRadius=1.24,c.Cu.covalentRadius=1.32,c.Zn.covalentRadius=1.22,c.Ga.covalentRadius=1.22,c.Ge.covalentRadius=1.2,c.As.covalentRadius=1.19,c.Se.covalentRadius=1.2,c.Br.covalentRadius=1.2,c.Kr.covalentRadius=1.16,c.Rb.covalentRadius=2.2,c.Sr.covalentRadius=1.95,c.Y.covalentRadius=1.9,c.Zr.covalentRadius=1.75,c.Nb.covalentRadius=1.64,c.Mo.covalentRadius=1.54,c.Tc.covalentRadius=1.47,c.Ru.covalentRadius=1.46,c.Rh.covalentRadius=1.42,c.Pd.covalentRadius=1.39,c.Ag.covalentRadius=1.45,c.Cd.covalentRadius=1.44,c.In.covalentRadius=1.42,c.Sn.covalentRadius=1.39,c.Sb.covalentRadius=1.39,c.Te.covalentRadius=1.38,c.I.covalentRadius=1.39,c.Xe.covalentRadius=1.4,c.Cs.covalentRadius=2.44,c.Ba.covalentRadius=2.15,c.La.covalentRadius=2.07,c.Ce.covalentRadius=2.04,c.Pr.covalentRadius=2.03,c.Nd.covalentRadius=2.01,c.Pm.covalentRadius=1.99,c.Sm.covalentRadius=1.98,c.Eu.covalentRadius=1.98,c.Gd.covalentRadius=1.96,c.Tb.covalentRadius=1.94,c.Dy.covalentRadius=1.92,c.Ho.covalentRadius=1.92,c.Er.covalentRadius=1.89,c.Tm.covalentRadius=1.9,c.Yb.covalentRadius=1.87,c.Lu.covalentRadius=1.87,c.Hf.covalentRadius=1.75,c.Ta.covalentRadius=1.7,c.W.covalentRadius=1.62,c.Re.covalentRadius=1.51,c.Os.covalentRadius=1.44,c.Ir.covalentRadius=1.41,c.Pt.covalentRadius=1.36,c.Au.covalentRadius=1.36,c.Hg.covalentRadius=1.32,c.Tl.covalentRadius=1.45,c.Pb.covalentRadius=1.46,c.Bi.covalentRadius=1.48,c.Po.covalentRadius=1.4,c.At.covalentRadius=1.5,c.Rn.covalentRadius=1.5,c.Fr.covalentRadius=2.6,c.Ra.covalentRadius=2.21,c.Ac.covalentRadius=2.15,c.Th.covalentRadius=2.06,c.Pa.covalentRadius=2,c.U.covalentRadius=1.96,c.Np.covalentRadius=1.9,c.Pu.covalentRadius=1.87,c.Am.covalentRadius=1.8,c.Cm.covalentRadius=1.69,c.Bk.covalentRadius=0,c.Cf.covalentRadius=0,c.Es.covalentRadius=0,c.Fm.covalentRadius=0,c.Md.covalentRadius=0,c.No.covalentRadius=0,c.Lr.covalentRadius=0,c.Rf.covalentRadius=0,c.Db.covalentRadius=0,c.Sg.covalentRadius=0,c.Bh.covalentRadius=0,c.Hs.covalentRadius=0,c.Mt.covalentRadius=0,c.Ds.covalentRadius=0,c.Rg.covalentRadius=0,c.Cn.covalentRadius=0,c.Uut.covalentRadius=0,c.Uuq.covalentRadius=0,c.Uup.covalentRadius=0,c.Uuh.covalentRadius=0,c.Uus.covalentRadius=0,c.Uuo.covalentRadius=0,c.H.vdWRadius=1.2,c.He.vdWRadius=1.4,c.Li.vdWRadius=1.82,c.Be.vdWRadius=0,c.B.vdWRadius=0,c.C.vdWRadius=1.7,c.N.vdWRadius=1.55,c.O.vdWRadius=1.52,c.F.vdWRadius=1.47,c.Ne.vdWRadius=1.54,c.Na.vdWRadius=2.27,c.Mg.vdWRadius=1.73,c.Al.vdWRadius=0,c.Si.vdWRadius=2.1,c.P.vdWRadius=1.8,c.S.vdWRadius=1.8,c.Cl.vdWRadius=1.75,c.Ar.vdWRadius=1.88,c.K.vdWRadius=2.75,c.Ca.vdWRadius=0,c.Sc.vdWRadius=0,c.Ti.vdWRadius=0,c.V.vdWRadius=0,c.Cr.vdWRadius=0,c.Mn.vdWRadius=0,c.Fe.vdWRadius=0,c.Co.vdWRadius=0,c.Ni.vdWRadius=1.63,c.Cu.vdWRadius=1.4,c.Zn.vdWRadius=1.39,c.Ga.vdWRadius=1.87,c.Ge.vdWRadius=0,c.As.vdWRadius=1.85,c.Se.vdWRadius=1.9,c.Br.vdWRadius=1.85,c.Kr.vdWRadius=2.02,c.Rb.vdWRadius=0,c.Sr.vdWRadius=0,c.Y.vdWRadius=0,c.Zr.vdWRadius=0,c.Nb.vdWRadius=0,c.Mo.vdWRadius=0,c.Tc.vdWRadius=0,c.Ru.vdWRadius=0,c.Rh.vdWRadius=0,c.Pd.vdWRadius=1.63,c.Ag.vdWRadius=1.72,c.Cd.vdWRadius=1.58,c.In.vdWRadius=1.93,c.Sn.vdWRadius=2.17,c.Sb.vdWRadius=0,c.Te.vdWRadius=2.06,c.I.vdWRadius=1.98,c.Xe.vdWRadius=2.16,c.Cs.vdWRadius=0,c.Ba.vdWRadius=0,c.La.vdWRadius=0,c.Ce.vdWRadius=0,c.Pr.vdWRadius=0,c.Nd.vdWRadius=0,c.Pm.vdWRadius=0,c.Sm.vdWRadius=0,c.Eu.vdWRadius=0,c.Gd.vdWRadius=0,c.Tb.vdWRadius=0,c.Dy.vdWRadius=0,c.Ho.vdWRadius=0,c.Er.vdWRadius=0,c.Tm.vdWRadius=0,c.Yb.vdWRadius=0,c.Lu.vdWRadius=0,c.Hf.vdWRadius=0,c.Ta.vdWRadius=0,c.W.vdWRadius=0,c.Re.vdWRadius=0,c.Os.vdWRadius=0,c.Ir.vdWRadius=0,c.Pt.vdWRadius=1.75,c.Au.vdWRadius=1.66,c.Hg.vdWRadius=1.55,c.Tl.vdWRadius=1.96,c.Pb.vdWRadius=2.02,c.Bi.vdWRadius=0,c.Po.vdWRadius=0,c.At.vdWRadius=0,c.Rn.vdWRadius=0,c.Fr.vdWRadius=0,c.Ra.vdWRadius=0,c.Ac.vdWRadius=0,c.Th.vdWRadius=0,c.Pa.vdWRadius=0,c.U.vdWRadius=1.86,c.Np.vdWRadius=0,c.Pu.vdWRadius=0,c.Am.vdWRadius=0,c.Cm.vdWRadius=0,c.Bk.vdWRadius=0,c.Cf.vdWRadius=0,c.Es.vdWRadius=0,c.Fm.vdWRadius=0,c.Md.vdWRadius=0,c.No.vdWRadius=0,c.Lr.vdWRadius=0,c.Rf.vdWRadius=0,c.Db.vdWRadius=0,c.Sg.vdWRadius=0,c.Bh.vdWRadius=0,c.Hs.vdWRadius=0,c.Mt.vdWRadius=0,c.Ds.vdWRadius=0,c.Rg.vdWRadius=0,c.Cn.vdWRadius=0,c.Uut.vdWRadius=0,c.Uuq.vdWRadius=0,c.Uup.vdWRadius=0,c.Uuh.vdWRadius=0,c.Uus.vdWRadius=0,c.Uuo.vdWRadius=0,c.H.valency=1,c.He.valency=0,c.Li.valency=1,c.Be.valency=2,c.B.valency=3,c.C.valency=4,c.N.valency=3,c.O.valency=2,c.F.valency=1,c.Ne.valency=0,c.Na.valency=1,c.Mg.valency=0,c.Al.valency=0,c.Si.valency=4,c.P.valency=3,c.S.valency=2,c.Cl.valency=1,c.Ar.valency=0,c.K.valency=0,c.Ca.valency=0,c.Sc.valency=0,c.Ti.valency=1,c.V.valency=1,c.Cr.valency=2,c.Mn.valency=3,c.Fe.valency=2,c.Co.valency=1,c.Ni.valency=1,c.Cu.valency=0,c.Zn.valency=0,c.Ga.valency=0,c.Ge.valency=4,c.As.valency=3,c.Se.valency=2,c.Br.valency=1,c.Kr.valency=0,c.Rb.valency=0,c.Sr.valency=0,c.Y.valency=0,c.Zr.valency=0,c.Nb.valency=1,c.Mo.valency=2,c.Tc.valency=3,c.Ru.valency=2,c.Rh.valency=1,c.Pd.valency=0,c.Ag.valency=0,c.Cd.valency=0,c.In.valency=0,c.Sn.valency=4,c.Sb.valency=3,c.Te.valency=2,c.I.valency=1,c.Xe.valency=0,c.Cs.valency=0,c.Ba.valency=0,c.La.valency=0,c.Ce.valency=0,c.Pr.valency=0,c.Nd.valency=0,c.Pm.valency=0,c.Sm.valency=0,c.Eu.valency=0,c.Gd.valency=0,c.Tb.valency=0,c.Dy.valency=0,c.Ho.valency=0,c.Er.valency=0,c.Tm.valency=0,c.Yb.valency=0,c.Lu.valency=0,c.Hf.valency=0,c.Ta.valency=1,c.W.valency=2,c.Re.valency=3,c.Os.valency=2,c.Ir.valency=3,c.Pt.valency=0,c.Au.valency=1,c.Hg.valency=0,c.Tl.valency=0,c.Pb.valency=4,c.Bi.valency=3,c.Po.valency=2,c.At.valency=1,c.Rn.valency=0,c.Fr.valency=0,c.Ra.valency=0,c.Ac.valency=0,c.Th.valency=0,c.Pa.valency=0,c.U.valency=0,c.Np.valency=0,c.Pu.valency=0,c.Am.valency=0,c.Cm.valency=0,c.Bk.valency=0,c.Cf.valency=0,c.Es.valency=0,c.Fm.valency=0,c.Md.valency=0,c.No.valency=0,c.Lr.valency=0,c.Rf.valency=0,c.Db.valency=0,c.Sg.valency=0,c.Bh.valency=0,c.Hs.valency=0,c.Mt.valency=0,c.Ds.valency=0,c.Rg.valency=0,c.Cn.valency=0,c.Uut.valency=0,c.Uuq.valency=0,c.Uup.valency=0,c.Uuh.valency=0,c.Uus.valency=0,c.Uuo.valency=0,c.H.mass=1,c.He.mass=4,c.Li.mass=7,c.Be.mass=9,c.B.mass=11,c.C.mass=12,c.N.mass=14,c.O.mass=16,c.F.mass=19,c.Ne.mass=20,c.Na.mass=23,c.Mg.mass=24,c.Al.mass=27,c.Si.mass=28,c.P.mass=31,c.S.mass=32,c.Cl.mass=35,c.Ar.mass=40,c.K.mass=39,c.Ca.mass=40,c.Sc.mass=45,c.Ti.mass=48,c.V.mass=51,c.Cr.mass=52,c.Mn.mass=55,c.Fe.mass=56,c.Co.mass=59,c.Ni.mass=58,c.Cu.mass=63,c.Zn.mass=64,c.Ga.mass=69,c.Ge.mass=74,c.As.mass=75,c.Se.mass=80,c.Br.mass=79,c.Kr.mass=84,c.Rb.mass=85,c.Sr.mass=88,c.Y.mass=89,c.Zr.mass=90,c.Nb.mass=93,c.Mo.mass=98,c.Tc.mass=0,c.Ru.mass=102,c.Rh.mass=103,c.Pd.mass=106,c.Ag.mass=107,c.Cd.mass=114,c.In.mass=115,c.Sn.mass=120,c.Sb.mass=121,c.Te.mass=130,c.I.mass=127,c.Xe.mass=132,c.Cs.mass=133,c.Ba.mass=138,c.La.mass=139,c.Ce.mass=140,c.Pr.mass=141,c.Nd.mass=142,c.Pm.mass=0,c.Sm.mass=152,c.Eu.mass=153,c.Gd.mass=158,c.Tb.mass=159,c.Dy.mass=164,c.Ho.mass=165,c.Er.mass=166,c.Tm.mass=169,c.Yb.mass=174,c.Lu.mass=175,c.Hf.mass=180,c.Ta.mass=181,c.W.mass=184,c.Re.mass=187,c.Os.mass=192,c.Ir.mass=193,c.Pt.mass=195,c.Au.mass=197,c.Hg.mass=202,c.Tl.mass=205,c.Pb.mass=208,c.Bi.mass=209,c.Po.mass=0,c.At.mass=0,c.Rn.mass=0,c.Fr.mass=0,c.Ra.mass=0,c.Ac.mass=0,c.Th.mass=232,c.Pa.mass=231,c.U.mass=238,c.Np.mass=0,c.Pu.mass=0,c.Am.mass=0,c.Cm.mass=0,c.Bk.mass=0,c.Cf.mass=0,c.Es.mass=0,c.Fm.mass=0,c.Md.mass=0,c.No.mass=0,c.Lr.mass=0,c.Rf.mass=0,c.Db.mass=0,c.Sg.mass=0,c.Bh.mass=0,c.Hs.mass=0,c.Mt.mass=0,c.Ds.mass=0,c.Rg.mass=0,c.Cn.mass=0,c.Uut.mass=0,c.Uuq.mass=0,c.Uup.mass=0,c.Uuh.mass=0,c.Uus.mass=0,c.Uuo.mass=0,c}(ChemDoodle.SYMBOLS),ChemDoodle.RESIDUE=function(){function a(a,b){return this.symbol=a,this.name=b,!0}var b=[];return b.Ala=new a("Ala","Alanine"),b.Arg=new a("Arg","Arginine"),b.Asn=new a("Asn","Asparagine"),b.Asp=new a("Asp","Aspartic Acid"),b.Cys=new a("Cys","Cysteine"),b.Gln=new a("Gln","Glutamine"),b.Glu=new a("Glu","Glutamic Acid"),b.Gly=new a("Gly","Glycine"),b.His=new a("His","Histidine"),b.Ile=new a("Ile","Isoleucine"),b.Leu=new a("Leu","Leucine"),b.Lys=new a("Lys","Lysine"),b.Met=new a("Met","Methionine"),b.Phe=new a("Phe","Phenylalanine"),b.Pro=new a("Pro","Proline"),b.Ser=new a("Ser","Serine"),b.Thr=new a("Thr","Threonine"),b.Trp=new a("Trp","Tryptophan"),b.Tyr=new a("Tyr","Tyrosine"),b.Val=new a("Val","Valine"),b.Asx=new a("Asx","Asparagine/Aspartic Acid"),b.Glx=new a("Glx","Glutamine/Glutamic Acid"),b["*"]=new a("*","Other"),b.A=new a("A","Adenine"),b.G=new a("G","Guanine"),b.I=new a("I",""),b.C=new a("C","Cytosine"),b.T=new a("T","Thymine"),b.U=new a("U","Uracil"),b.Ala.polar=!1,b.Arg.polar=!0,b.Asn.polar=!0,b.Asp.polar=!0,b.Cys.polar=!0,b.Gln.polar=!0,b.Glu.polar=!0,b.Gly.polar=!1,b.His.polar=!0,b.Ile.polar=!1,b.Leu.polar=!1,b.Lys.polar=!0,b.Met.polar=!1,b.Phe.polar=!1,b.Pro.polar=!1,b.Ser.polar=!0,b.Thr.polar=!0,b.Trp.polar=!0,b.Tyr.polar=!0,b.Val.polar=!1,b.Asx.polar=!0,b.Glx.polar=!0,b.Ala.aminoColor="#C8C8C8",b.Arg.aminoColor="#145AFF",b.Asn.aminoColor="#00DCDC",b.Asp.aminoColor="#E60A0A",b.Cys.aminoColor="#E6E600",b.Gln.aminoColor="#00DCDC",b.Glu.aminoColor="#E60A0A",b.Gly.aminoColor="#EBEBEB",b.His.aminoColor="#8282D2",b.Ile.aminoColor="#0F820F",b.Leu.aminoColor="#0F820F",b.Lys.aminoColor="#145AFF",b.Met.aminoColor="#E6E600",b.Phe.aminoColor="#3232AA",b.Pro.aminoColor="#DC9682",b.Ser.aminoColor="#FA9600",b.Thr.aminoColor="#FA9600",b.Trp.aminoColor="#B45AB4",b.Tyr.aminoColor="#3232AA",b.Val.aminoColor="#0F820F",b.Asx.aminoColor="#FF69B4",b.Glx.aminoColor="#FF69B4",b["*"].aminoColor="#BEA06E",b.A.aminoColor="#BEA06E",b.G.aminoColor="#BEA06E",b.I.aminoColor="#BEA06E",b.C.aminoColor="#BEA06E",b.T.aminoColor="#BEA06E",b.U.aminoColor="#BEA06E",b.Ala.shapelyColor="#8CFF8C",b.Arg.shapelyColor="#00007C",b.Asn.shapelyColor="#FF7C70",b.Asp.shapelyColor="#A00042",b.Cys.shapelyColor="#FFFF70",b.Gln.shapelyColor="#FF4C4C",b.Glu.shapelyColor="#660000",b.Gly.shapelyColor="#FFFFFF",b.His.shapelyColor="#7070FF",b.Ile.shapelyColor="#004C00",b.Leu.shapelyColor="#455E45",b.Lys.shapelyColor="#4747B8",b.Met.shapelyColor="#B8A042",b.Phe.shapelyColor="#534C52",b.Pro.shapelyColor="#525252",b.Ser.shapelyColor="#FF7042",b.Thr.shapelyColor="#B84C00",b.Trp.shapelyColor="#4F4600",b.Tyr.shapelyColor="#8C704C",b.Val.shapelyColor="#FF8CFF",b.Asx.shapelyColor="#FF00FF",b.Glx.shapelyColor="#FF00FF",b["*"].shapelyColor="#FF00FF",b.A.shapelyColor="#A0A0FF",b.G.shapelyColor="#FF7070",b.I.shapelyColor="#80FFFF",b.C.shapelyColor="#FF8C4B",b.T.shapelyColor="#A0FFA0",b.U.shapelyColor="#FF8080",b}(),function(a){a.Queue=function(){var a=[],b=0;this.getSize=function(){return a.length-b},this.isEmpty=function(){return 0==a.length},this.enqueue=function(b){a.push(b)},this.dequeue=function(){var c=void 0;return a.length&&(c=a[b],2*++b>=a.length&&(a=a.slice(b),b=0)),c},this.getOldestElement=function(){var c=void 0;return a.length&&(c=a[b]),c}}}(ChemDoodle.structures),function(a,b){a.Point=function(a,c){return this.x=a?a:0,this.y=c?c:0,this.sub=function(a){this.x-=a.x,this.y-=a.y},this.add=function(a){this.x+=a.x,this.y+=a.y},this.distance=function(a){var c=a.x-this.x,d=a.y-this.y;return b.sqrt(c*c+d*d)},this.angleForStupidCanvasArcs=function(a){var c=a.x-this.x,d=a.y-this.y,e=0;for(e=0==c?0==d?0:d>0?b.PI/2:3*b.PI/2:0==d?c>0?0:b.PI:0>c?b.atan(d/c)+b.PI:0>d?b.atan(d/c)+2*b.PI:b.atan(d/c);0>e;)e+=2*b.PI;return e%=2*b.PI},this.angle=function(a){var c=a.x-this.x,d=this.y-a.y,e=0;for(e=0==c?0==d?0:d>0?b.PI/2:3*b.PI/2:0==d?c>0?0:b.PI:0>c?b.atan(d/c)+b.PI:0>d?b.atan(d/c)+2*b.PI:b.atan(d/c);0>e;)e+=2*b.PI;return e%=2*b.PI},!0}}(ChemDoodle.structures,Math),function(a,b,c,d,e){c.Atom=function(c,f,g,h){return this.x=f?f:0,this.y=g?g:0,this.z=h?h:0,this.charge=0,this.numLonePair=0,this.mass=-1,this.coordinationNumber=0,this.bondNumber=0,this.angleOfLeastInterference=0,this.isHidden=!1,this.color=!1,this.label=c?c.replace(/\s/g,""):"C",this.altLabel=null,a[this.label]||(this.label="C"),this.isLone=!1,this.isHover=!1,this.isSelected=!1,this.add3D=function(a){this.x+=a.x,this.y+=a.y,this.z+=a.z},this.sub3D=function(a){this.x-=a.x,this.y-=a.y,this.z-=a.z},this.distance3D=function(a){var b=a.x-this.x,c=a.y-this.y,e=a.z-this.z;return d.sqrt(b*b+c*c+e*e)},this.hover=function(a){this.isHover=a},this.draw=function(c,e){this.textBounds=[],this.specs&&(e=this.specs);var f=e.getFontString(e.atoms_font_size_2D,e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D);if(c.font=f,c.fillStyle=e.atoms_color,e.atoms_useJMOLColors?c.fillStyle=a[this.label].jmolColor:e.atoms_usePYMOLColors&&(c.fillStyle=a[this.label].pymolColor),this.isLone&&!e.atoms_displayAllCarbonLabels_2D||e.atoms_circles_2D)c.beginPath(),c.arc(this.x,this.y,e.atoms_circleDiameter_2D/2,0,2*d.PI,!1),c.fill(),e.atoms_circleBorderWidth_2D>0&&(c.lineWidth=e.atoms_circleBorderWidth_2D,c.strokeStyle="black",c.stroke(this.x,this.y,0,2*d.PI,e.atoms_circleDiameter_2D/2));
else if(this.isLabelVisible(e)){if(c.textAlign="center",c.textBaseline="middle",void 0!=this.altLabel){c.fillText(this.altLabel,this.x,this.y);var g=c.measureText(this.altLabel).width;this.textBounds.push({x:this.x-g/2,y:this.y-e.atoms_font_size_2D/2+1,w:g,h:e.atoms_font_size_2D-2})}else{c.fillText(this.label,this.x,this.y);var g=c.measureText(this.label).width;if(this.textBounds.push({x:this.x-g/2,y:this.y-e.atoms_font_size_2D/2+1,w:g,h:e.atoms_font_size_2D-2}),-1!=this.mass){var h=e.getFontString(.7*e.atoms_font_size_2D,e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D),i=c.font;c.font=h;var j=c.measureText(this.mass).width;c.fillText(this.mass,this.x-j-.5,this.y-.3*e.atoms_font_size_2D),c.font=i}var k=this.getImplicitHydrogenCount();if(e.atoms_implicitHydrogens_2D&&k>0){var l=c.measureText("H").width;if(k>1){var m=g/2+l/2,n=0,h=e.getFontString(.8*e.atoms_font_size_2D,e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D);c.font=h;var o=c.measureText(k).width;1==this.bondNumber?this.angleOfLeastInterference>d.PI/2&&this.angleOfLeastInterference<3*d.PI/2&&(m=-g/2-o-l/2):this.angleOfLeastInterference<=d.PI/4||(this.angleOfLeastInterference<3*d.PI/4?(m=0,n=.9*-e.atoms_font_size_2D):this.angleOfLeastInterference<=5*d.PI/4?m=-g/2-o-l/2:this.angleOfLeastInterference<7*d.PI/4&&(m=0,n=.9*e.atoms_font_size_2D)),c.font=f,c.fillText("H",this.x+m,this.y+n),c.font=h,c.fillText(k,this.x+m+l/2+o/2,this.y+n+.3*e.atoms_font_size_2D),this.textBounds.push({x:this.x+m-l/2,y:this.y+n-e.atoms_font_size_2D/2+1,w:l,h:e.atoms_font_size_2D-2}),this.textBounds.push({x:this.x+m+l/2,y:this.y+n+.3*e.atoms_font_size_2D-e.atoms_font_size_2D/2+1,w:o,h:.8*e.atoms_font_size_2D-2})}else{var m=g/2+l/2,n=0;1==this.bondNumber?this.angleOfLeastInterference>d.PI/2&&this.angleOfLeastInterference<3*d.PI/2&&(m=-g/2-l/2):this.angleOfLeastInterference<=d.PI/4||(this.angleOfLeastInterference<3*d.PI/4?(m=0,n=.9*-e.atoms_font_size_2D):this.angleOfLeastInterference<=5*d.PI/4?m=-g/2-l/2:this.angleOfLeastInterference<7*d.PI/4&&(m=0,n=.9*e.atoms_font_size_2D)),c.fillText("H",this.x+m,this.y+n),this.textBounds.push({x:this.x+m-l/2,y:this.y+n-e.atoms_font_size_2D/2+1,w:l,h:e.atoms_font_size_2D-2})}}}if(0!=this.charge){var p=this.charge.toFixed(0);"1"==p?p="+":"-1"==p?p="–":b.stringStartsWith(p,"-")?p=p.substring(1)+"–":p+="+";var q=this.angleOfLeastInterference,r=e.atoms_font_size_2D;this.isLabelVisible(e)&&k>0&&(q+=d.PI/4),c.textAlign="center",c.textBaseline="middle",c.fillText(p,this.x+r*d.cos(q),this.y-r*d.sin(q))}this.numLonePair>0&&(c.fillStyle="black",2==this.bondNumber&&d.abs(this.largestAngle-d.PI)<d.PI/60?(this.drawLonePairs(c,e,d.floor(this.numLonePair/2),this.angleOfLeastInterference,this.largestAngle),this.drawLonePairs(c,e,d.floor(this.numLonePair/2)+this.numLonePair%2,this.angleOfLeastInterference+d.PI,this.largestAngle)):this.drawLonePairs(c,e,this.numLonePair,this.angleOfLeastInterference,this.largestAngle))}this.drawChildExtras&&this.drawDecorations(c)},this.drawLonePairs=function(a,b,c,e,f){for(var g=f/(c+(0==this.bondNumber?0:1)),h=e-f/2+g,i=0;c>i;i++){var e=h+i*g,j=this.x+Math.cos(e)*b.atoms_lonePairDistance_2D,k=this.y-Math.sin(e)*b.atoms_lonePairDistance_2D,l=e+Math.PI/2,m=Math.cos(l)*b.atoms_lonePairSpread_2D/2,n=-Math.sin(l)*b.atoms_lonePairSpread_2D/2;a.beginPath(),a.arc(j+m,k+n,b.atoms_lonePairDiameter_2D,0,2*d.PI,!1),a.fill(),a.beginPath(),a.arc(j-m,k-n,b.atoms_lonePairDiameter_2D,0,2*d.PI,!1),a.fill()}},this.drawDecorations=function(a){if(this.isHover||this.isSelected){a.strokeStyle=this.isHover?"#885110":"#0060B2",a.lineWidth=1.2,a.beginPath();var b=this.isHover?7:15;a.arc(this.x,this.y,b,0,2*d.PI,!1),a.stroke()}},this.render=function(b,c){this.specs&&(c=this.specs);var d=e.translate(b.modelViewMatrix,[this.x,this.y,this.z],[]),f=c.atoms_useVDWDiameters_3D?a[this.label].vdWRadius*c.atoms_vdwMultiplier_3D:c.atoms_sphereDiameter_3D/2;0==f&&(f=1),e.scale(d,[f,f,f]);var g=c.atoms_color;c.atoms_useJMOLColors?g=a[this.label].jmolColor:c.atoms_usePYMOLColors?g=a[this.label].pymolColor:this.color&&(g=this.color),b.material.setDiffuseColor(g),b.setMatrixUniforms(d);var h=this.renderAsStar?b.starBuffer:b.sphereBuffer;b.drawElements(b.TRIANGLES,h.vertexIndexBuffer.numItems,b.UNSIGNED_SHORT,0)},this.isLabelVisible=function(a){return a.atoms_displayAllCarbonLabels_2D||"C"!=this.label||this.altLabel||-1!=this.mass||0!=this.charge||0!=this.numLonePair||this.isHidden&&a.atoms_showHiddenCarbons_2D||a.atoms_displayTerminalCarbonLabels_2D&&1==this.bondNumber},this.getImplicitHydrogenCount=function(){if("H"==this.label||null==a[this.label])return 0;var b=a[this.label].valency,c=b-this.coordinationNumber;if(this.charge>0){var d=4-b;this.charge<=d?c+=this.charge:c=4-this.coordinationNumber-this.charge+d}else c+=this.charge;return 0>c?0:c},!0},c.Atom.prototype=new c.Point(0,0)}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,Math,mat4),function(a,b,c,d,e,f,g){c.Bond=function(h,i,j){return this.a1=h,this.a2=i,this.bondOrder=j?j:1,this.stereo=c.Bond.STEREO_NONE,this.isHover=!1,this.ring=null,this.getCenter=function(){return new c.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)},this.getLength=function(){return this.a1.distance(this.a2)},this.getLength3D=function(){return this.a1.distance3D(this.a2)},this.contains=function(a){return a==this.a1||a==this.a2},this.getNeighbor=function(a){return a==this.a1?this.a2:a==this.a2?this.a1:null},this.draw=function(f,g){if(this.a1.x!=this.a2.x||this.a1.y!=this.a2.y){this.specs&&(g=this.specs);var h=this.a1.x,i=this.a2.x,j=this.a1.y,k=this.a2.y,l=this.a1.distance(this.a2),m=i-h,n=k-j;if(g.atoms_display&&!g.atoms_circles_2D&&this.a1.isLabelVisible(g)){for(var o=0,p=0,q=this.a1.textBounds.length;q>p;p++)o=Math.max(o,d.calculateDistanceInterior(this.a1,this.a2,this.a1.textBounds[p]));o+=g.bonds_atomLabelBuffer_2D;var r=o/l;h+=m*r,j+=n*r}if(g.atoms_display&&!g.atoms_circles_2D&&this.a2.isLabelVisible(g)){for(var o=0,p=0,q=this.a2.textBounds.length;q>p;p++)o=Math.max(o,d.calculateDistanceInterior(this.a2,this.a1,this.a2.textBounds[p]));o+=g.bonds_atomLabelBuffer_2D;var r=o/l;i-=m*r,k-=n*r}if(g.bonds_clearOverlaps_2D){var s=h+.15*m,t=j+.15*n,u=i-.15*m,v=k-.15*n;f.strokeStyle=g.backgroundColor,f.lineWidth=g.bonds_width_2D+2*g.bonds_overlapClearWidth_2D,f.lineCap="round",f.beginPath(),f.moveTo(s,t),f.lineTo(u,v),f.closePath(),f.stroke()}if(f.strokeStyle=g.bonds_color,f.fillStyle=g.bonds_color,f.lineWidth=g.bonds_width_2D,f.lineCap=g.bonds_ends_2D,g.bonds_useJMOLColors||g.bonds_usePYMOLColors){var w=f.createLinearGradient(h,j,i,k),x=a[this.a1.label].jmolColor,y=a[this.a2.label].jmolColor;if(g.atoms_usePYMOLColors)var x=a[this.a1.label].pymolColor,y=a[this.a2.label].pymolColor;w.addColorStop(0,x),g.bonds_colorGradient||(w.addColorStop(.5,x),w.addColorStop(.51,y)),w.addColorStop(1,y),f.strokeStyle=w,f.fillStyle=w}switch(this.bondOrder){case.5:f.beginPath(),f.moveTo(h,j),b.contextHashTo(f,h,j,i,k,g.bonds_hashSpacing_2D,g.bonds_hashSpacing_2D),f.stroke();break;case 1:if(this.stereo==c.Bond.STEREO_PROTRUDING||this.stereo==c.Bond.STEREO_RECESSED){var z=g.bonds_width_2D/2,A=this.a1.distance(this.a2)*g.bonds_wedgeThickness_2D/2,B=this.a1.angle(this.a2)+e.PI/2,C=e.cos(B),D=e.sin(B),E=h-C*z,F=j+D*z,G=h+C*z,H=j-D*z,I=i+C*A,J=k-D*A,K=i-C*A,L=k+D*A;f.beginPath(),f.moveTo(E,F),f.lineTo(G,H),f.lineTo(I,J),f.lineTo(K,L),f.closePath(),this.stereo==c.Bond.STEREO_PROTRUDING?f.fill():(f.save(),f.clip(),f.lineWidth=2*A,f.lineCap="butt",f.beginPath(),f.moveTo(h,j),b.contextHashTo(f,h,j,i,k,g.bonds_hashWidth_2D,g.bonds_hashSpacing_2D),f.stroke(),f.restore())}else{if(this.stereo==c.Bond.STEREO_AMBIGUOUS){f.beginPath(),f.moveTo(h,j);for(var M,N,O,P,Q=e.floor(e.sqrt(m*m+n*n)/g.bonds_wavyLength_2D),R=h,S=j,B=this.a1.angle(this.a2)+e.PI/2,C=e.cos(B),D=e.sin(B),T=m/Q,U=n/Q,p=0,q=Q;q>p;p++)R+=T,S+=U,M=g.bonds_wavyLength_2D*C+R-.5*T,O=g.bonds_wavyLength_2D*-D+S-.5*U,N=g.bonds_wavyLength_2D*-C+R-.5*T,P=g.bonds_wavyLength_2D*D+S-.5*U,p%2==0?f.quadraticCurveTo(M,O,R,S):f.quadraticCurveTo(N,P,R,S);f.stroke();break}f.beginPath(),f.moveTo(h,j),f.lineTo(i,k),f.stroke()}break;case 1.5:f.beginPath(),f.moveTo(h,j),f.lineTo(i,k),f.stroke();break;case 2:if(this.stereo==c.Bond.STEREO_AMBIGUOUS){var A=this.a1.distance(this.a2)*g.bonds_saturationWidth_2D/2,B=this.a1.angle(this.a2)+e.PI/2,E=h-e.cos(B)*A,F=j+e.sin(B)*A,G=h+e.cos(B)*A,H=j-e.sin(B)*A,I=i+e.cos(B)*A,J=k-e.sin(B)*A,K=i-e.cos(B)*A,L=k+e.sin(B)*A;f.beginPath(),f.moveTo(E,F),f.lineTo(I,J),f.moveTo(G,H),f.lineTo(K,L),f.stroke()}else if(g.bonds_symmetrical_2D||null==this.ring&&("C"!=this.a1.label||"C"!=this.a2.label)){var A=this.a1.distance(this.a2)*g.bonds_saturationWidth_2D/2,B=this.a1.angle(this.a2)+e.PI/2,E=h-e.cos(B)*A,F=j+e.sin(B)*A,G=h+e.cos(B)*A,H=j-e.sin(B)*A,I=i+e.cos(B)*A,J=k-e.sin(B)*A,K=i-e.cos(B)*A,L=k+e.sin(B)*A;f.beginPath(),f.moveTo(E,F),f.lineTo(K,L),f.moveTo(G,H),f.lineTo(I,J),f.stroke()}else{f.beginPath(),f.moveTo(h,j),f.lineTo(i,k);var V=0,l=this.a1.distance(this.a2),W=this.a1.angle(this.a2),B=W+e.PI/2,A=l*g.bonds_saturationWidth_2D,X=g.bonds_saturationAngle_2D;if(X<e.PI/2&&(V=-(A/e.tan(X))),e.abs(V)<l/2){var Y=h-e.cos(W)*V,Z=i+e.cos(W)*V,$=j+e.sin(W)*V,_=k-e.sin(W)*V,E=Y-e.cos(B)*A,F=$+e.sin(B)*A,G=Y+e.cos(B)*A,H=$-e.sin(B)*A,I=Z-e.cos(B)*A,J=_+e.sin(B)*A,K=Z+e.cos(B)*A,L=_-e.sin(B)*A,ab=null==this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>e.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-e.PI;ab?(f.moveTo(E,F),f.lineTo(I,J)):(f.moveTo(G,H),f.lineTo(K,L)),f.stroke()}}break;case 3:var A=this.a1.distance(this.a2)*g.bonds_saturationWidth_2D,B=this.a1.angle(this.a2)+e.PI/2,E=h-e.cos(B)*A,F=j+e.sin(B)*A,G=h+e.cos(B)*A,H=j-e.sin(B)*A,I=i+e.cos(B)*A,J=k-e.sin(B)*A,K=i-e.cos(B)*A,L=k+e.sin(B)*A;f.beginPath(),f.moveTo(E,F),f.lineTo(K,L),f.moveTo(G,H),f.lineTo(I,J),f.moveTo(h,j),f.lineTo(i,k),f.stroke()}}},this.drawDecorations=function(a){if(this.isHover||this.isSelected){var b=2*e.PI,c=(this.a1.angleForStupidCanvasArcs(this.a2)+e.PI/2)%b;a.strokeStyle=this.isHover?"#885110":"#0060B2",a.lineWidth=1.2,a.beginPath();var d=(c+e.PI)%b;d%=2*e.PI,a.arc(this.a1.x,this.a1.y,7,c,d,!1),a.stroke(),a.beginPath(),c+=e.PI,d=(c+e.PI)%b,a.arc(this.a2.x,this.a2.y,7,c,d,!1),a.stroke()}},this.render=function(c,d){this.specs&&(d=this.specs);var h=(d.bonds_renderAsLines_3D?1.1:1.001)*this.a1.distance3D(this.a2)/(d.bonds_useJMOLColors||d.bonds_usePYMOLColors?2:1);if(0==h)return!1;var i=[d.bonds_cylinderDiameter_3D/2,h,d.bonds_cylinderDiameter_3D/2],j=f.translate(c.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),k=null,l=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z];(d.bonds_useJMOLColors||d.bonds_usePYMOLColors)&&(g.scale(l,.5),k=f.translate(c.modelViewMatrix,[this.a2.x,this.a2.y,this.a2.z],[]));var m=[0],n=null;if(d.bonds_showBondOrders_3D){switch(this.bondOrder){case 2:m=[-d.bonds_cylinderDiameter_3D,d.bonds_cylinderDiameter_3D];break;case 3:m=[-1.2*d.bonds_cylinderDiameter_3D,0,1.2*d.bonds_cylinderDiameter_3D]}if(m.length>1){var o=[0,0,1],p=f.inverse(c.rotationMatrix,[]);f.multiplyVec3(p,o),n=g.cross(l,o,[]),g.normalize(n)}}var q=[0,1,0],r=0,s=null;this.a1.x==this.a2.x&&this.a1.z==this.a2.z?(s=[0,0,1],this.a2.y<this.a1.y&&(r=e.PI)):(r=b.vec3AngleFrom(q,l),s=g.cross(q,l,[]));for(var t=0,u=m.length;u>t;t++){var v=f.set(j,[]);0!=m[t]&&f.translate(v,g.scale(n,m[t],[])),0!=r&&f.rotate(v,r,s),f.scale(v,i);var w=d.bonds_color;d.bonds_useJMOLColors?w=a[this.a1.label].jmolColor:d.bonds_usePYMOLColors&&(w=a[this.a1.label].pymolColor),c.material.setDiffuseColor(w),c.setMatrixUniforms(v),d.bonds_renderAsLines_3D?c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems):c.drawArrays(c.TRIANGLE_STRIP,0,c.cylinderBuffer.vertexPositionBuffer.numItems),(d.bonds_useJMOLColors||d.bonds_usePYMOLColors)&&(f.set(k,v),0!=m[t]&&f.translate(v,g.scale(n,m[t],[])),f.rotate(v,r+e.PI,s),f.scale(v,i),c.material.setDiffuseColor(d.bonds_usePYMOLColors?a[this.a2.label].pymolColor:a[this.a2.label].jmolColor),c.setMatrixUniforms(v),d.bonds_renderAsLines_3D?c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems):c.drawArrays(c.TRIANGLE_STRIP,0,c.cylinderBuffer.vertexPositionBuffer.numItems))}},!0},c.Bond.STEREO_NONE="none",c.Bond.STEREO_PROTRUDING="protruding",c.Bond.STEREO_RECESSED="recessed",c.Bond.STEREO_AMBIGUOUS="ambiguous"}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,Math,mat4,vec3),function(a,b){a.Ring=function(){return this.atoms=[],this.bonds=[],this.center=null,this.setupBonds=function(){for(var a=0,b=this.bonds.length;b>a;a++)this.bonds[a].ring=this;this.center=this.getCenter()},this.getCenter=function(){for(var c=minY=1/0,d=maxY=-1/0,e=0,f=this.atoms.length;f>e;e++)c=b.min(this.atoms[e].x,c),minY=b.min(this.atoms[e].y,minY),d=b.max(this.atoms[e].x,d),maxY=b.max(this.atoms[e].y,maxY);return new a.Point((d+c)/2,(maxY+minY)/2)},!0}}(ChemDoodle.structures,Math),function(a,b,c,d,e){c.Molecule=function(){return this.atoms=[],this.bonds=[],this.rings=[],this.findRings=!0,this.draw=function(a,b){if(this.specs&&(b=this.specs),b.atoms_display&&!b.atoms_circles_2D)for(var c=0,d=this.atoms.length;d>c;c++)this.atoms[c].draw(a,b);if(b.bonds_display)for(var c=0,d=this.bonds.length;d>c;c++)this.bonds[c].draw(a,b);if(b.atoms_display&&b.atoms_circles_2D)for(var c=0,d=this.atoms.length;d>c;c++)this.atoms[c].draw(a,b)},this.render=function(a,b){this.specs&&(b=this.specs);var e=this.atoms.length>0&&void 0!=this.atoms[0].hetatm;if(e){if(b.macro_displayBonds){this.bonds.length>0&&(b.bonds_renderAsLines_3D&&!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(a.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:b.bonds_width_2D),a.lineBuffer.bindBuffers(a)):a.cylinderBuffer.bindBuffers(a),a.material.setTempColors(b.bonds_materialAmbientColor_3D,null,b.bonds_materialSpecularColor_3D,b.bonds_materialShininess_3D));for(var f=0,g=this.bonds.length;g>f;f++){var h=this.bonds[f];!h.a1.hetatm&&(-1==b.macro_atomToLigandDistance||void 0!=h.a1.closestDistance&&b.macro_atomToLigandDistance>=h.a1.closestDistance&&b.macro_atomToLigandDistance>=h.a2.closestDistance)&&h.render(a,this.residueSpecs?this.residueSpecs:b)}}if(b.macro_displayAtoms){this.atoms.length>0&&(a.sphereBuffer.bindBuffers(a),a.material.setTempColors(b.atoms_materialAmbientColor_3D,null,b.atoms_materialSpecularColor_3D,b.atoms_materialShininess_3D));for(var f=0,g=this.atoms.length;g>f;f++){var i=this.atoms[f];!i.hetatm&&(-1==b.macro_atomToLigandDistance||void 0!=i.closestDistance&&b.macro_atomToLigandDistance>=i.closestDistance)&&i.render(a,this.residueSpecs?this.residueSpecs:b)}}}if(b.bonds_display){this.bonds.length>0&&(b.bonds_renderAsLines_3D?(a.lineWidth(b.bonds_width_2D),a.lineBuffer.bindBuffers(a)):a.cylinderBuffer.bindBuffers(a),a.material.setTempColors(b.bonds_materialAmbientColor_3D,null,b.bonds_materialSpecularColor_3D,b.bonds_materialShininess_3D));for(var f=0,g=this.bonds.length;g>f;f++){var h=this.bonds[f];(!e||h.a1.hetatm)&&h.render(a,b)}}if(b.atoms_display){for(var f=0,g=this.atoms.length;g>f;f++){var i=this.atoms[f];i.bondNumber=0,i.renderAsStar=!1}for(var f=0,g=this.bonds.length;g>f;f++){var h=this.bonds[f];h.a1.bondNumber++,h.a2.bondNumber++}this.atoms.length>0&&(a.sphereBuffer.bindBuffers(a),a.material.setTempColors(b.atoms_materialAmbientColor_3D,null,b.atoms_materialSpecularColor_3D,b.atoms_materialShininess_3D));for(var j=[],f=0,g=this.atoms.length;g>f;f++){var i=this.atoms[f];(!e||i.hetatm&&(b.macro_showWater||!i.isWater))&&(b.atoms_nonBondedAsStars_3D&&0==i.bondNumber?(i.renderAsStar=!0,j.push(i)):i.render(a,b))}if(j.length>0){a.starBuffer.bindBuffers(a);for(var f=0,g=j.length;g>f;f++)j[f].render(a,b)}}if(this.chains){if(a.setMatrixUniforms(a.modelViewMatrix),b.proteins_displayRibbon){a.material.setTempColors(b.proteins_materialAmbientColor_3D,null,b.proteins_materialSpecularColor_3D,b.proteins_materialShininess_3D);for(var k=0,l=this.ribbons.length;l>k;k++)if(b.proteins_useShapelyColors||b.proteins_useAminoColors||b.proteins_usePolarityColors){var m=b.proteins_ribbonCartoonize?this.cartoons[k]:this.ribbons[k];m.front.bindBuffers(a);for(var f=0,g=m.front.segments.length;g>f;f++)m.front.segments[f].render(a,b);m.back.bindBuffers(a);for(var f=0,g=m.back.segments.length;g>f;f++)m.back.segments[f].render(a,b)}else if(b.proteins_ribbonCartoonize){var m=this.cartoons[k];m.front.bindBuffers(a);for(var f=0,g=m.front.cartoonSegments.length;g>f;f++)m.front.cartoonSegments[f].render(a,b);m.back.bindBuffers(a);for(var f=0,g=m.back.cartoonSegments.length;g>f;f++)m.back.cartoonSegments[f].render(a,b)}else{var m=this.ribbons[k];m.front.render(a,b),m.back.render(a,b)}}if(b.proteins_displayBackbone){if(!this.alphaCarbonTrace){this.alphaCarbonTrace={nodes:[],edges:[]};for(var k=0,l=this.chains.length;l>k;k++){var n=this.chains[k],o=n.length>2&&d[n[2].name]&&"#BEA06E"==d[n[2].name].aminoColor;if(!o&&n.length>0)for(var f=1,g=n.length-2;g>f;f++){var p=n[f].cp1;p.chainColor=n.chainColor,this.alphaCarbonTrace.nodes.push(p);var h=new c.Bond(n[f].cp1,n[f+1].cp1);h.residueName=n[f].name,h.chainColor=n.chainColor,this.alphaCarbonTrace.edges.push(h),f==n.length-3&&(p=n[f+1].cp1,p.chainColor=n.chainColor,this.alphaCarbonTrace.nodes.push(p))}}}if(this.alphaCarbonTrace.nodes.length>0){var q=new c.VisualSpecifications;q.atoms_display=!0,q.bonds_display=!0,q.atoms_sphereDiameter_3D=b.proteins_backboneThickness,q.bonds_cylinderDiameter_3D=b.proteins_backboneThickness,q.bonds_useJMOLColors=!1,q.atoms_color=b.proteins_backboneColor,q.bonds_color=b.proteins_backboneColor,q.atoms_useVDWDiameters_3D=!1,a.material.setTempColors(b.proteins_materialAmbientColor_3D,null,b.proteins_materialSpecularColor_3D,b.proteins_materialShininess_3D),a.material.setDiffuseColor(b.proteins_backboneColor);for(var f=0,g=this.alphaCarbonTrace.nodes.length;g>f;f++){var p=this.alphaCarbonTrace.nodes[f];b.macro_colorByChain&&(q.atoms_color=p.chainColor),a.sphereBuffer.bindBuffers(a),p.render(a,q)}for(var f=0,g=this.alphaCarbonTrace.edges.length;g>f;f++){var r=this.alphaCarbonTrace.edges[f],s=null,t=d[r.residueName]?d[r.residueName]:d["*"];b.macro_colorByChain?s=r.chainColor:b.proteins_useShapelyColors?s=t.shapelyColor:b.proteins_useAminoColors?s=t.aminoColor:b.proteins_usePolarityColors&&(s=t.polar?"#C10000":"#FFFFFF"),null!=s&&(q.bonds_color=s),a.cylinderBuffer.bindBuffers(a),r.render(a,q)}}}if(b.nucleics_display){a.material.setTempColors(b.nucleics_materialAmbientColor_3D,null,b.nucleics_materialSpecularColor_3D,b.nucleics_materialShininess_3D);for(var k=0,l=this.tubes.length;l>k;k++){a.setMatrixUniforms(a.modelViewMatrix);var m=this.tubes[k];m.render(a,b)}}}b.crystals_displayUnitCell&&this.unitCell&&(a.setMatrixUniforms(a.modelViewMatrix),this.unitCell.bindBuffers(a),a.material.setDiffuseColor(b.crystals_unitCellColor),a.lineWidth(b.crystals_unitCellLineWidth),a.drawElements(a.LINES,this.unitCell.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)),this.surface&&b.surfaces_display&&(a.setMatrixUniforms(a.modelViewMatrix),this.surface.bindBuffers(a),a.material.setTempColors(b.surfaces_materialAmbientColor_3D,b.surfaces_color,b.surfaces_materialSpecularColor_3D,b.surfaces_materialShininess_3D),"Dot"==b.surfaces_style?a.drawArrays(a.POINTS,0,this.surface.vertexPositionBuffer.numItems):a.drawElements(a.TRIANGLES,this.surface.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0))},this.getCenter3D=function(){if(1==this.atoms.length)return new c.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var a=minY=minZ=1/0,b=maxY=maxZ=-1/0;if(this.chains)for(var d=0,f=this.chains.length;f>d;d++)for(var g=this.chains[d],h=0,i=g.length;i>h;h++){var j=g[h];a=e.min(j.cp1.x,a),minY=e.min(j.cp1.y,minY),minZ=e.min(j.cp1.z,minZ),b=e.max(j.cp1.x,b),maxY=e.max(j.cp1.y,maxY),maxZ=e.max(j.cp1.z,maxZ),a=e.min(j.cp2.x,a),minY=e.min(j.cp2.y,minY),minZ=e.min(j.cp2.z,minZ),b=e.max(j.cp2.x,b),maxY=e.max(j.cp2.y,maxY),maxZ=e.max(j.cp2.z,maxZ)}for(var d=0,f=this.atoms.length;f>d;d++)a=e.min(this.atoms[d].x,a),minY=e.min(this.atoms[d].y,minY),minZ=e.min(this.atoms[d].z,minZ),b=e.max(this.atoms[d].x,b),maxY=e.max(this.atoms[d].y,maxY),maxZ=e.max(this.atoms[d].z,maxZ);return new c.Atom("C",(b+a)/2,(maxY+minY)/2,(maxZ+minZ)/2)},this.getCenter=function(){if(1==this.atoms.length)return new c.Point(this.atoms[0].x,this.atoms[0].y);for(var a=minY=1/0,b=maxY=-1/0,d=0,f=this.atoms.length;f>d;d++)a=e.min(this.atoms[d].x,a),minY=e.min(this.atoms[d].y,minY),b=e.max(this.atoms[d].x,b),maxY=e.max(this.atoms[d].y,maxY);return new c.Point((b+a)/2,(maxY+minY)/2)},this.getDimension=function(){if(1==this.atoms.length)return new c.Point(0,0);var a=minY=1/0,b=maxY=-1/0;if(this.chains){for(var d=0,f=this.chains.length;f>d;d++)for(var g=this.chains[d],h=0,i=g.length;i>h;h++){var j=g[h];a=e.min(j.cp1.x,a),minY=e.min(j.cp1.y,minY),b=e.max(j.cp1.x,b),maxY=e.max(j.cp1.y,maxY),a=e.min(j.cp2.x,a),minY=e.min(j.cp2.y,minY),b=e.max(j.cp2.x,b),maxY=e.max(j.cp2.y,maxY)}a-=30,minY-=30,minZ-=30,b+=30,maxY+=30,maxZ+=30}for(var d=0,f=this.atoms.length;f>d;d++)a=e.min(this.atoms[d].x,a),minY=e.min(this.atoms[d].y,minY),b=e.max(this.atoms[d].x,b),maxY=e.max(this.atoms[d].y,maxY);return new c.Point(b-a,maxY-minY)},this.check=function(b){if(b&&this.doChecks){if(this.findRings)if(this.bonds.length-this.atoms.length!=this.fjNumCache){this.rings=new a.informatics.SSSRFinder(this).rings;for(var c=0,d=this.bonds.length;d>c;c++)this.bonds[c].ring=null;for(var c=0,d=this.rings.length;d>c;c++)this.rings[c].setupBonds()}else for(var c=0,d=this.rings.length;d>c;c++){var e=this.rings[c];e.center=e.getCenter()}if(this.atoms.length!=this.atomNumCache&&this.bonds.length!=this.bondNumCache)for(var c=0,d=this.atoms.length;d>c;c++)if(this.atoms[c].isLone=!1,"C"==this.atoms[c].label){for(var f=0,g=0,h=this.bonds.length;h>g;g++)(this.bonds[g].a1==this.atoms[c]||this.bonds[g].a2==this.atoms[c])&&f++;0==f&&(this.atoms[c].isLone=!0)}for(var i=!1,c=0,d=this.atoms.length;d>c;c++)0!=this.atoms[c].z&&(i=!0);i&&(this.sortAtomsByZ(),this.sortBondsByZ()),this.setupMetaData(),this.atomNumCache=this.atoms.length,this.bondNumCache=this.bonds.length,this.fjNumCache=this.bonds.length-this.atoms.length}this.doChecks=!b},this.getAngles=function(a){for(var b=[],c=0,d=this.bonds.length;d>c;c++)this.bonds[c].contains(a)&&b.push(a.angle(this.bonds[c].getNeighbor(a)));return b.sort(),b},this.getCoordinationNumber=function(a){for(var b=0,c=0,d=a.length;d>c;c++)b+=a[c].bondOrder;return b},this.getBonds=function(a){for(var b=[],c=0,d=this.bonds.length;d>c;c++)this.bonds[c].contains(a)&&b.push(this.bonds[c]);return b},this.sortAtomsByZ=function(){for(var a=1,b=this.atoms.length;b>a;a++)for(var c=a;c>0&&this.atoms[c].z<this.atoms[c-1].z;){var d=this.atoms[c];this.atoms[c]=this.atoms[c-1],this.atoms[c-1]=d,c--}},this.sortBondsByZ=function(){for(var a=1,b=this.bonds.length;b>a;a++)for(var c=a;c>0&&this.bonds[c].a1.z+this.bonds[c].a2.z<this.bonds[c-1].a1.z+this.bonds[c-1].a2.z;){var d=this.bonds[c];this.bonds[c]=this.bonds[c-1],this.bonds[c-1]=d,c--}},this.setupMetaData=function(){for(var b=0,c=this.atoms.length;c>b;b++){var d=this.atoms[b],f=this.getBonds(d),g=this.getAngles(d);d.isHidden=2==f.length&&e.abs(e.abs(g[1]-g[0])-e.PI)<e.PI/30&&f[0].bondOrder==f[1].bondOrder;var h=a.math.angleBetweenLargest(g);d.angleOfLeastInterference=h.angle%(2*e.PI),d.largestAngle=h.largest,d.coordinationNumber=this.getCoordinationNumber(f),d.bondNumber=f.length}},this.scaleToAverageBondLength=function(a){var b=this.getAverageBondLength();if(0!=b)for(var c=a/b,d=0,e=this.atoms.length;e>d;d++)this.atoms[d].x*=c,this.atoms[d].y*=c},this.getAverageBondLength=function(){if(0==this.bonds.length)return 0;for(var a=0,b=0,c=this.bonds.length;c>b;b++)a+=this.bonds[b].getLength();return a/=this.bonds.length},!0}}(ChemDoodle,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math),function(a,b,c,d){function e(a){var b=a*a,d=a*a*a,e=[6/d,0,0,0,6/d,2/b,0,0,1/d,1/b,1/a,0,0,0,0,1],h=[-1/6,.5,-0.5,1/6,.5,-1,.5,0,-0.5,0,.5,0,1/6,2/3,1/6,0];f=c.multiply(h,e,[]),g=a}var f=null,g=-1;a.Residue=function(h){this.resSeq=h,this.setup=function(b,c){this.horizontalResolution=c;var e=[b.x-this.cp1.x,b.y-this.cp1.y,b.z-this.cp1.z],f=[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],g=d.cross(e,f,[]);this.D=d.cross(g,e,[]),d.normalize(g),d.normalize(this.D),this.guidePointsSmall=[],this.guidePointsLarge=[];var h=[(b.x+this.cp1.x)/2,(b.y+this.cp1.y)/2,(b.z+this.cp1.z)/2];this.helix&&(d.scale(g,1.5),d.add(h,g)),this.guidePointsSmall[0]=new a.Atom("",h[0]-this.D[0]/2,h[1]-this.D[1]/2,h[2]-this.D[2]/2);for(var i=1;c>i;i++)this.guidePointsSmall[i]=new a.Atom("",this.guidePointsSmall[0].x+this.D[0]*i/c,this.guidePointsSmall[0].y+this.D[1]*i/c,this.guidePointsSmall[0].z+this.D[2]*i/c);d.scale(this.D,4),this.guidePointsLarge[0]=new a.Atom("",h[0]-this.D[0]/2,h[1]-this.D[1]/2,h[2]-this.D[2]/2);for(var i=1;c>i;i++)this.guidePointsLarge[i]=new a.Atom("",this.guidePointsLarge[0].x+this.D[0]*i/c,this.guidePointsLarge[0].y+this.D[1]*i/c,this.guidePointsLarge[0].z+this.D[2]*i/c)},this.getGuidePointSet=function(a){return 0==a?this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall:1==a?this.guidePointsSmall:2==a?this.guidePointsLarge:void 0},this.computeLineSegments=function(a,b,c,d,f){f!=g&&e(f),this.split=b.helix!=this.helix||b.sheet!=this.sheet,this.lineSegments=this.innerCompute(0,a,b,c,!1,f),d&&(this.lineSegmentsCartoon=this.innerCompute(b.helix||b.sheet?2:1,a,b,c,!0,f))},this.innerCompute=function(e,g,h,i,j,k){for(var l=[],m=this.getGuidePointSet(e),n=g.getGuidePointSet(e),o=h.getGuidePointSet(e),p=i.getGuidePointSet(e),q=0,r=this.guidePointsLarge.length;r>q;q++){for(var s=[n[q].x,n[q].y,n[q].z,1,m[q].x,m[q].y,m[q].z,1,o[q].x,o[q].y,o[q].z,1,p[q].x,p[q].y,p[q].z,1],t=c.multiply(s,f,[]),u=[],v=0;k>v;v++){for(var w=3;w>0;w--)for(var x=0;4>x;x++)t[4*w+x]+=t[4*(w-1)+x];u[v]=new a.Atom("",t[12]/t[15],t[13]/t[15],t[14]/t[15])}l[q]=u}if(j&&this.arrow)for(var w=0,y=k;y>w;w++)for(var z=1.5-1.3*w/k,A=b.floor(this.horizontalResolution/2),B=l[A],x=0,C=l.length;C>x;x++)if(x!=A){var D=B[w],E=l[x][w],F=[E.x-D.x,E.y-D.y,E.z-D.z];d.scale(F,z),E.x=D.x+F[0],E.y=D.y+F[1],E.z=D.z+F[2]}return l}}}(ChemDoodle.structures,Math,mat4,vec3),function(a,b,c,d,e){b.Spectrum=function(){return this.data=[],this.metadata=[],this.dataDisplay=[],this.title=null,this.xUnit=null,this.yUnit=null,this.continuous=!0,this.integrationSensitivity=.01,this.memory={offsetTop:0,offsetLeft:0,offsetBottom:0,flipXAxis:!1,scale:1,width:0,height:0},this.draw=function(b,c,f,g){this.specs&&(c=this.specs);var h=5,i=0,j=0;b.fillStyle=c.text_color,b.textAlign="center",b.textBaseline="alphabetic",b.font=c.getFontString(c.text_font_size,c.text_font_families),this.xUnit&&(j+=c.text_font_size,b.fillText(this.xUnit,f/2,g-2)),this.yUnit&&c.plots_showYAxis&&(i+=c.text_font_size,b.save(),b.translate(c.text_font_size,g/2),b.rotate(-e.PI/2),b.fillText(this.yUnit,0,0),b.restore()),null!=this.title&&(h+=c.text_font_size,b.fillText(this.title,f/2,c.text_font_size)),j+=5+c.text_font_size,c.plots_showYAxis&&(i+=5+b.measureText("1000").width),c.plots_showGrid&&(b.strokeStyle=c.plots_gridColor,b.lineWidth=c.plots_gridLineWidth,b.strokeRect(i,h,f-i,g-j-h)),b.textAlign="center",b.textBaseline="top";for(var k=this.maxX-this.minX,l=k/100,m=.001;l>m||k/m>25;)m*=10;for(var n=0,o=c.plots_flipXAxis?f:0,p=e.round(this.minX/m)*m;p<=this.maxX;p+=m/2){var q=this.getTransformedX(p,c,f,i);if(q>i)if(b.strokeStyle="black",b.lineWidth=1,n%2==0){b.beginPath(),b.moveTo(q,g-j),b.lineTo(q,g-j+2),b.stroke();for(var r=p.toFixed(5);"0"==r.charAt(r.length-1);)r=r.substring(0,r.length-1);"."==r.charAt(r.length-1)&&(r=r.substring(0,r.length-1));var s=b.measureText(r).width;c.plots_flipXAxis&&(s*=-1);var t=q-s/2;(c.plots_flipXAxis?o>t:t>o)&&(b.fillText(r,q,g-j+2),o=q+s/2),c.plots_showGrid&&(b.strokeStyle=c.plots_gridColor,b.lineWidth=c.plots_gridLineWidth,b.beginPath(),b.moveTo(q,g-j),b.lineTo(q,h),b.stroke())}else b.beginPath(),b.moveTo(q,g-j),b.lineTo(q,g-j+2),b.stroke();n++}if(c.plots_showYAxis||c.plots_showGrid){var u=1/c.scale,n=0;b.textAlign="right",b.textBaseline="middle";for(var p=0;10>=p;p++){var v=u/10*p,w=h+(g-j-h)*(1-v*c.scale);if(c.plots_showGrid&&(b.strokeStyle=c.plots_gridColor,b.lineWidth=c.plots_gridLineWidth,b.beginPath(),b.moveTo(i,w),b.lineTo(f,w),b.stroke()),c.plots_showYAxis){b.strokeStyle="black",b.lineWidth=1,b.beginPath(),b.moveTo(i,w),b.lineTo(i-3,w),b.stroke();var x=100*v,y=e.max(0,3-e.floor(x).toString().length),r=x.toFixed(y);if(y>0)for(;"0"==r.charAt(r.length-1);)r=r.substring(0,r.length-1);"."==r.charAt(r.length-1)&&(r=r.substring(0,r.length-1)),b.fillText(r,i-3,w)}}}if(b.strokeStyle="black",b.lineWidth=1,b.beginPath(),b.moveTo(f,g-j),b.lineTo(i,g-j),c.plots_showYAxis&&b.lineTo(i,h),b.stroke(),this.dataDisplay.length>0){b.textAlign="left",b.textBaseline="top";for(var z=0,p=0,A=this.dataDisplay.length;A>p;p++)if(this.dataDisplay[p].value)b.fillText([this.dataDisplay[p].display,": ",this.dataDisplay[p].value].join(""),i+10,h+10+z*(c.text_font_size+5)),z++;else if(this.dataDisplay[p].tag)for(var B=0,C=this.metadata.length;C>B;B++)if(a.stringStartsWith(this.metadata[B],this.dataDisplay[p].tag)){var D=this.metadata[B];if(this.dataDisplay[p].display){var E=d.inArray("=",this.metadata[B]);D=[this.dataDisplay[p].display,": ",E>-1?this.metadata[B].substring(E+2):this.metadata[B]].join("")}b.fillText(D,i+10,h+10+z*(c.text_font_size+5)),z++;break}}this.drawPlot(b,c,f,g,h,i,j),this.memory.offsetTop=h,this.memory.offsetLeft=i,this.memory.offsetBottom=j,this.memory.flipXAxis=c.plots_flipXAxis,this.memory.scale=c.scale,this.memory.width=f,this.memory.height=g},this.drawPlot=function(a,c,d,f,g,h,i){this.specs&&(c=this.specs),a.strokeStyle=this.plots_color||c.plots_color,a.lineWidth=c.plots_width;var j=[];if(a.beginPath(),this.continuous)for(var k=!1,l=0,m=0,n=this.data.length;n>m;m++){var o=this.getTransformedX(this.data[m].x,c,d,h);if(o>=h&&d>o){var p=this.getTransformedY(this.data[m].y,c,f,i,g);c.plots_showIntegration&&e.abs(this.data[m].y)>this.integrationSensitivity&&j.push(new b.Point(this.data[m].x,this.data[m].y)),k||(a.moveTo(o,p),k=!0),a.lineTo(o,p),l++,l%1e3==0&&(a.stroke(),a.beginPath(),a.moveTo(o,p))}else if(k)break}else for(var m=0,n=this.data.length;n>m;m++){var o=this.getTransformedX(this.data[m].x,c,d,h);o>=h&&d>o&&(a.moveTo(o,f-i),a.lineTo(o,this.getTransformedY(this.data[m].y,c,f,i,g)))}if(a.stroke(),c.plots_showIntegration&&j.length>1){a.strokeStyle=c.plots_integrationColor,a.lineWidth=c.plots_integrationLineWidth,a.beginPath();var q,r=j[1].x>j[0].x;if(this.flipXAxis&&!r||!this.flipXAxis&&r){for(var m=j.length-2;m>=0;m--)j[m].y=j[m].y+j[m+1].y;q=j[0].y}else{for(var m=1,n=j.length;n>m;m++)j[m].y=j[m].y+j[m-1].y;q=j[j.length-1].y}for(var m=0,n=j.length;n>m;m++){var o=this.getTransformedX(j[m].x,c,d,h),p=this.getTransformedY(j[m].y/c.scale/q,c,f,i,g);0==m?a.moveTo(o,p):a.lineTo(o,p)}a.stroke()}},this.getTransformedY=function(a,b,c,d,e){return e+(c-d-e)*(1-a*b.scale)},this.getInverseTransformedY=function(a){return(1-(a-this.memory.offsetTop)/(this.memory.height-this.memory.offsetBottom-this.memory.offsetTop))/this.memory.scale*100},this.getTransformedX=function(a,b,c,d){var e=d+(a-this.minX)/(this.maxX-this.minX)*(c-d);return(b.plots_flipXAxis||this.memory.flipXAxis)&&(e=c+d-e),e},this.getInverseTransformedX=function(a){return this.memory.flipXAxis&&(a=this.memory.width+this.memory.offsetLeft-a),(a-this.memory.offsetLeft)*(this.maxX-this.minX)/(this.memory.width-this.memory.offsetLeft)+this.minX},this.setup=function(){for(var a=Number.MAX_VALUE,b=Number.MIN_VALUE,c=Number.MIN_VALUE,d=0,f=this.data.length;f>d;d++)a=e.min(a,this.data[d].x),b=e.max(b,this.data[d].x),c=e.max(c,this.data[d].y);this.continuous?(this.minX=a,this.maxX=b):(this.minX=a-1,this.maxX=b+1);for(var d=0,f=this.data.length;f>d;d++)this.data[d].y/=c},this.zoom=function(a,b,c,d){var f=this.getInverseTransformedX(a),g=this.getInverseTransformedX(b);
return this.minX=e.min(f,g),this.maxX=e.max(f,g),d?this.getScale(this.minX,this.maxX):void 0},this.getScale=function(a,b){for(var d=Number.MIN_VALUE,f=0,g=this.data.length;g>f;f++)c.isBetween(this.data[f].x,a,b)&&(d=e.max(d,this.data[f].y));return 1/d},this.translate=function(a,b){var c=a/(b-this.memory.offsetLeft)*(this.maxX-this.minX)*(this.memory.flipXAxis?1:-1);this.minX+=c,this.maxX+=c},this.alertMetadata=function(){alert(this.metadata.join("\n"))},this.getInternalCoordinates=function(a,b){return new ChemDoodle.structures.Point(this.getInverseTransformedX(a),this.getInverseTransformedY(b))},this.getClosestPlotInternalCoordinates=function(a){var b=this.getInverseTransformedX(a-1),d=this.getInverseTransformedX(a+1);if(b>d){var e=b;b=d,d=e}for(var f=-1,g=-1/0,h=!1,i=0,j=this.data.length;j>i;i++){var k=this.data[i];if(c.isBetween(k.x,b,d))k.y>g&&(h=!0,g=k.y,f=i);else if(h)break}if(-1==f)return null;var k=this.data[f];return new ChemDoodle.structures.Point(k.x,100*k.y)},this.getClosestPeakInternalCoordinates=function(a){for(var b=this.getInverseTransformedX(a),c=0,d=1/0,f=0,g=this.data.length;g>f;f++){var h=e.abs(this.data[f].x-b);if(!(d>=h))break;d=h,c=f}for(var i=highestRight=c,j=maxRight=this.data[c].y,f=c+1,g=this.data.length;g>f&&this.data[f].y+.05>maxRight;f++)maxRight=this.data[f].y,highestRight=f;for(var f=c-1;f>=0&&this.data[f].y+.05>j;f--)j=this.data[f].y,i=f;var k=this.data[i-c>highestRight-c?highestRight:i];return new ChemDoodle.structures.Point(k.x,100*k.y)},!0}}(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,jQuery,Math),function(a){a._Mesh=function(){return!0},a._Mesh.prototype.storeData=function(a,b,c){this.positionData=a,this.normalData=b,this.indexData=c},a._Mesh.prototype.setupBuffers=function(a){if(this.vertexPositionBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.positionData),a.STATIC_DRAW),this.vertexPositionBuffer.itemSize=3,this.vertexPositionBuffer.numItems=this.positionData.length/3,this.vertexNormalBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexNormalBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.normalData),a.STATIC_DRAW),this.vertexNormalBuffer.itemSize=3,this.vertexNormalBuffer.numItems=this.normalData.length/3,this.indexData&&(this.vertexIndexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),a.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length),this.partitions)for(var b=0,c=this.partitions.length;c>b;b++){var d=this.partitions[b],e=this.generateBuffers(a,d.positionData,d.normalData,d.indexData);d.vertexPositionBuffer=e[0],d.vertexNormalBuffer=e[1],d.vertexIndexBuffer=e[2]}},a._Mesh.prototype.generateBuffers=function(a,b,c,d){var e=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW),e.itemSize=3,e.numItems=b.length/3;var f=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,f),a.bufferData(a.ARRAY_BUFFER,new Float32Array(c),a.STATIC_DRAW),f.itemSize=3,f.numItems=c.length/3;var g=null;return d&&(g=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,g),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),a.STATIC_DRAW),g.itemSize=1,g.numItems=d.length),[e,f,g]},a._Mesh.prototype.bindBuffers=function(a){this.vertexPositionBuffer||this.setupBuffers(a),a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer),a.vertexAttribPointer(a.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.vertexNormalBuffer),a.vertexAttribPointer(a.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,a.FLOAT,!1,0,0),this.vertexIndexBuffer&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}}(ChemDoodle.structures,Math),function(a,b){a.Cylinder=function(a,c,d){for(var e=[],f=[],g=0;d>g;g++){var h=2*g*b.PI/d,i=b.cos(h),j=b.sin(h);f.push(i,0,j),e.push(a*i,0,a*j),f.push(i,0,j),e.push(a*i,c,a*j)}return f.push(1,0,0),e.push(a,0,0),f.push(1,0,0),e.push(a,c,0),this.storeData(e,f),!0},a.Cylinder.prototype=new a._Mesh}(ChemDoodle.structures,Math),function(a,b){a.Sphere=function(a,c,d){for(var e=[],f=[],g=0;c>=g;g++)for(var h=g*b.PI/c,i=b.sin(h),j=b.cos(h),k=0;d>=k;k++){var l=2*k*b.PI/d,m=b.sin(l),n=b.cos(l),o=n*i,p=j,q=m*i;f.push(o,p,q),e.push(a*o,a*p,a*q)}var r=[];d+=1;for(var g=0;c>g;g++)for(var k=0;d>k;k++){var s=g*d+k%d,t=s+d;r.push(s),r.push(t),r.push(s+1),d-1>k&&(r.push(t),r.push(t+1),r.push(s+1))}return this.storeData(e,f,r),!0},a.Sphere.prototype=new a._Mesh}(ChemDoodle.structures,Math),function(a,b,c,d){function e(b,c,d,e){this.name=c,this.entire=b,this.pi=e,this.getColor=function(c){return c.macro_colorByChain?this.chainColor:this.name?this.getResidueColor(a[this.name]?this.name:"*",c):this.helix?b.front?c.proteins_ribbonCartoonHelixPrimaryColor:c.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?c.proteins_ribbonCartoonSheetColor:b.front?c.proteins_primaryColor:c.proteins_secondaryColor},this.getResidueColor=function(b,c){var d=a[b];return c.proteins_useShapelyColors?d.shapelyColor:c.proteins_useAminoColors?d.aminoColor:c.proteins_usePolarityColors?d.polar?"#C10000":"#FFFFFF":"#FFFFFF"},this.render=function(a,b){null!=this.entire.partitions&&this.pi!=this.entire.partitions.lastRender&&(f(a,this.entire.partitions[this.pi]),this.entire.partitions.lastRender=this.pi),this.vertexIndexBuffer||(this.vertexIndexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),a.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=d.length),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),a.material.setDiffuseColor(this.getColor(b)),a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)}}var f=function(a,b){a.bindBuffer(a.ARRAY_BUFFER,b.vertexPositionBuffer),a.vertexAttribPointer(a.shader.vertexPositionAttribute,b.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,b.vertexNormalBuffer),a.vertexAttribPointer(a.shader.vertexNormalAttribute,b.vertexNormalBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,b.vertexIndexBuffer)};b.Ribbon=function(a,b,g){var h=a[0].lineSegments.length,i=a[0].lineSegments[0].length;this.partitions=[],this.partitions.lastRender=0;var j=null;this.front=b>0;for(var k=0,l=a.length-1;l>k;k++){(null==j||j.positionData.length>65e3)&&(this.partitions.length>0&&k--,j={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(j));var m=a[k];j.count++;for(var n=0;h>n;n++)for(var o=g?m.lineSegmentsCartoon[n]:m.lineSegments[n],p=0==n,q=!1,r=0;i>r;r++){var s=o[r],t=k,u=r+1;k==a.length-2&&r==i-1?u--:r==i-1&&(t++,u=0);var v=g?a[t].lineSegmentsCartoon[n][u]:a[t].lineSegments[n][u],w=!1,x=n+1;n==h-1&&(x-=2,w=!0);var y=g?m.lineSegmentsCartoon[x][r]:m.lineSegments[x][r],z=[v.x-s.x,v.y-s.y,v.z-s.z],A=[y.x-s.x,y.y-s.y,y.z-s.z],B=d.cross(z,A,[]);0==r&&(d.normalize(z),d.scale(z,-1),j.normalData.push(z[0],z[1],z[2]),j.positionData.push(s.x,s.y,s.z)),p||q?(d.normalize(A),d.scale(A,-1),j.normalData.push(A[0],A[1],A[2]),j.positionData.push(s.x,s.y,s.z),p&&r==i-1&&(p=!1,r=-1)):(d.normalize(B),(w&&!this.front||!w&&this.front)&&d.scale(B,-1),j.normalData.push(B[0],B[1],B[2]),d.scale(B,c.abs(b)),j.positionData.push(s.x+B[0],s.y+B[1],s.z+B[2]),n==h-1&&r==i-1&&(q=!0,r=-1)),(-1==r||r==i-1)&&(d.normalize(z),j.normalData.push(z[0],z[1],z[2]),j.positionData.push(s.x,s.y,s.z))}}h+=2,i+=2,g&&(this.cartoonSegments=[]),this.segments=[];for(var C=0,D=this.partitions.length;D>C;C++){var j=this.partitions[C],E=null;g&&(E=[]);for(var k=0,l=j.count-1;l>k;k++){for(var F=k,n=0;C>n;n++)F+=this.partitions[n].count-1;var G=a[F];if(k>0&&g&&G.split){var H=new e(this,null,E,C);G.helix&&(H.helix=!0),G.sheet&&(H.sheet=!0),this.cartoonSegments.push(H),E=[]}for(var I=k*h*i,J=[],n=0,K=h-1;K>n;n++)for(var L=I+n*i,r=0;i>r;r++){var M=1;k==j.count-1?M=0:r==i-1&&(M=h*i-r);var N=[L+r,L+i+r,L+i+r+M,L+r,L+r+M,L+i+r+M];if(r!=i-1)for(var O=0;6>O;O++)J.push(N[O]);if(r==i-2&&k<j.count-1){var P=h*i-r;N[2]+=P,N[4]+=P,N[5]+=P}for(var O=0;6>O;O++)j.indexData.push(N[O]);if(g)for(var O=0;6>O;O++)E.push(N[O])}var Q=a[F+1].name;this.segments.push(new e(this,Q,J,C))}if(g){for(var H=new e(this,null,E,C),F=j.count-1,n=0;C>n;n++)F+=this.partitions[n].count-1;var G=a[F];G.helix&&(H.helix=!0),G.sheet&&(H.sheet=!0),this.cartoonSegments.push(H)}}return this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData),1==this.partitions.length&&(this.partitions=null),this.render=function(a,b){this.bindBuffers(a);var c=b.macro_colorByChain?this.chainColor:null;if(c||(c=this.front?b.proteins_primaryColor:b.proteins_secondaryColor),a.material.setDiffuseColor(c),a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0),this.partitions)for(var d=1,e=this.partitions.length;e>d;d++){var g=this.partitions[d];f(a,g),a.drawElements(a.TRIANGLES,g.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)}},!0},b.Ribbon.prototype=new b._Mesh}(ChemDoodle.RESIDUE,ChemDoodle.structures,Math,vec3),function(a,b,c){b.Light=function(b,d,e){return this.diffuseRGB=a.getRGB(b,1),this.specularRGB=a.getRGB(d,1),this.direction=e,this.lightScene=function(a){var b="u_light.";a.uniform3f(a.getUniformLocation(a.program,b+"diffuse_color"),this.diffuseRGB[0],this.diffuseRGB[1],this.diffuseRGB[2]),a.uniform3f(a.getUniformLocation(a.program,b+"specular_color"),this.specularRGB[0],this.specularRGB[1],this.specularRGB[2]);var d=c.create(this.direction);c.normalize(d),c.negate(d),a.uniform3f(a.getUniformLocation(a.program,b+"direction"),d[0],d[1],d[2]);var e=[0,0,0],f=[e[0]+d[0],e[1]+d[1],e[2]+d[2]],g=c.length(f);0==g?f=[0,0,1]:c.scale(1/g),a.uniform3f(a.getUniformLocation(a.program,b+"half_vector"),f[0],f[1],f[2])},!0}}(ChemDoodle.math,ChemDoodle.structures,vec3),function(a){a.Line=function(){return this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0]),!0},a.Line.prototype=new a._Mesh}(ChemDoodle.structures),function(a,b){b.Material=function(b){var c="u_material.",d=b.getUniformLocation(b.program,c+"ambient_color"),e=b.getUniformLocation(b.program,c+"diffuse_color"),f=b.getUniformLocation(b.program,c+"specular_color"),g=b.getUniformLocation(b.program,c+"shininess"),h=b.getUniformLocation(b.program,c+"alpha");return this.setTempColors=function(c,i,j,k){if(!this.aCache||this.aCache!=c){this.aCache=c;var l=a.getRGB(c,1);b.uniform3f(d,l[0],l[1],l[2])}if(null!=i&&(!this.dCache||this.dCache!=i)){this.dCache=i;var l=a.getRGB(i,1);b.uniform3f(e,l[0],l[1],l[2])}if(!this.sCache||this.sCache!=j){this.sCache=j;var l=a.getRGB(j,1);b.uniform3f(f,l[0],l[1],l[2])}this.snCache&&this.snCache==k||(this.snCache=k,b.uniform1f(g,k)),this.alCache=1,b.uniform1f(h,1)},this.setDiffuseColor=function(c){if(!this.dCache||this.dCache!=c){this.dCache=c;var d=a.getRGB(c,1);b.uniform3f(e,d[0],d[1],d[2])}},this.setAlpha=function(a){this.alCache&&this.alCache==a||(this.alCache=a,b.uniform1f(h,a))},!0}}(ChemDoodle.math,ChemDoodle.structures),function(a,b,c){a.MolecularSurface=function(d,e,f,g,h){function i(a,b,c,d){var e=a.index;if(a.contained){e=-1;for(var f=1/0,g=0,h=b.length;h>g;g++)for(var i=b[g],j=0,k=i.length;k>j;j++){var l=i[j];if(!l.contained&&l.index!=c&&l.index!=d){var m=l.distance3D(a);f>m&&(e=l.index,f=m)}}}return e}for(var j=[],k=[],l=[],m=[],n=0;e>=n;n++)for(var o=n*c.PI/e,p=c.sin(o),q=c.cos(o),r=0;f>=r;r++){var s=2*r*c.PI/f;m.push(c.cos(s)*p,q,c.sin(s)*p)}for(var t=[],u=0,v=d.atoms.length;v>u;u++){for(var w=[],x=d.atoms[u],y=b[x.label][h]+g,z=[],A=0,B=d.atoms.length;B>A;A++)if(A!=u){var C=d.atoms[A];C.index=A,x.distance3D(C)<y+b[C.label][h]+g&&z.push(C)}for(var A=0,B=m.length;B>A;A+=3){for(var D=new a.Atom("C",x.x+y*m[A],x.y+y*m[A+1],x.z+y*m[A+2]),E=0,F=z.length;F>E;E++){var C=z[E];if(D.distance3D(C)<b[C.label][h]+g){D.contained=!0;break}}w.push(D)}t.push(w)}var G=[];f++;for(var n=0;e>n;n++)for(var r=0;f>r;r++){var H=n*f+r%f,I=H+f;G.push(H),G.push(I),G.push(H+1),f-1>r&&(G.push(I),G.push(I+1),G.push(H+1))}for(var J=0,u=0,v=t.length;v>u;u++){for(var w=t[u],A=0,B=w.length;B>A;A++){var D=w[A];D.contained||(D.index=J,J++,j.push(D.x,D.y,D.z),k.push(m[3*A],m[3*A+1],m[3*A+2]))}for(var A=0,B=G.length;B>A;A+=3){var H=w[G[A]],I=w[G[A+1]],K=w[G[A+2]];H.contained||I.contained||K.contained||l.push(H.index,I.index,K.index)}}for(var L=[],u=0,v=t.length;v>u;u++)for(var w=t[u],A=0,B=G.length;B>A;A+=3){for(var H=w[G[A]],I=w[G[A+1]],K=w[G[A+2]],z=[],E=0,F=t.length;F>E;E++)E!=u&&z.push(t[E]);if(!(H.contained&&I.contained&&K.contained)&&(H.contained||I.contained||K.contained)){var M=i(H,z,-1,-1),N=i(I,z,M,-1),O=i(K,z,M,N);if(-1!=M&&-1!=N&&-1!=O){for(var P=!1,E=0,F=L.length;F>E;E+=3){var Q=L[E],R=L[E+1],S=L[E+2],T=M==Q||M==R||M==S,U=N==Q||N==R||N==S,V=O==Q||O==R||O==S;if(T&&U&&V){P=!0;break}}P||L.push(M,N,O)}}}return l=l.concat(L),this.storeData(j,k,l),!0},a.MolecularSurface.prototype=new a._Mesh}(ChemDoodle.structures,ChemDoodle.ELEMENT,Math),function(a,b){a.Shader=function(){return this.init=function(a){var b=this.getShader(a,"vertex-shader");null==b&&(b=this.loadDefaultVertexShader(a));var c=this.getShader(a,"fragment-shader");null==c&&(c=this.loadDefaultFragmentShader(a)),a.attachShader(a.program,b),a.attachShader(a.program,c),a.linkProgram(a.program),a.getProgramParameter(a.program,a.LINK_STATUS)||alert("Could not initialize shaders: "+a.getProgramInfoLog(program)),a.useProgram(a.program),this.vertexPositionAttribute=a.getAttribLocation(a.program,"a_vertex_position"),a.enableVertexAttribArray(this.vertexPositionAttribute),this.vertexNormalAttribute=a.getAttribLocation(a.program,"a_vertex_normal"),a.enableVertexAttribArray(this.vertexNormalAttribute)},this.getShader=function(a,c){var d=b.getElementById(c);if(!d)return null;for(var e=[],f=d.firstChild;f;)3==f.nodeType&&e.push(f.textContent),f=f.nextSibling;var g;if("x-shader/x-fragment"==d.type)g=a.createShader(a.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!=d.type)return null;g=a.createShader(a.VERTEX_SHADER)}return a.shaderSource(g,e.join("")),a.compileShader(g),a.getShaderParameter(g,a.COMPILE_STATUS)?g:(alert(d.type+" "+a.getShaderInfoLog(g)),null)},this.loadDefaultVertexShader=function(a){var b=[];b.push("struct Light"),b.push("{"),b.push("vec3 diffuse_color;"),b.push("vec3 specular_color;"),b.push("vec3 direction;"),b.push("vec3 half_vector;"),b.push("};"),b.push("struct Material"),b.push("{"),b.push("vec3 ambient_color;"),b.push("vec3 diffuse_color;"),b.push("vec3 specular_color;"),b.push("float shininess;"),b.push("float alpha;"),b.push("};"),b.push("attribute vec3 a_vertex_position;"),b.push("attribute vec3 a_vertex_normal;"),b.push("uniform Light u_light;"),b.push("uniform Material u_material;"),b.push("uniform mat4 u_model_view_matrix;"),b.push("uniform mat4 u_projection_matrix;"),b.push("uniform mat3 u_normal_matrix;"),b.push("varying vec4 v_diffuse;"),b.push("varying vec4 v_ambient;"),b.push("varying vec3 v_normal;"),b.push("varying vec3 v_light_direction;"),b.push("void main(void)"),b.push("{"),b.push("if(length(a_vertex_normal)==0.0){"),b.push("v_normal = a_vertex_normal;"),b.push("}else{"),b.push("v_normal = normalize(u_normal_matrix * a_vertex_normal);"),b.push("}"),b.push("vec4 diffuse = vec4(u_light.diffuse_color, 1.0);"),b.push("v_light_direction = u_light.direction;"),b.push("v_ambient = vec4(u_material.ambient_color, 1.0);"),b.push("v_diffuse = vec4(u_material.diffuse_color, 1.0) * diffuse;"),b.push("gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.0);"),b.push("}");var c=a.createShader(a.VERTEX_SHADER);return a.shaderSource(c,b.join("")),a.compileShader(c),a.getShaderParameter(c,a.COMPILE_STATUS)?c:(alert("Vertex shader failed to compile: "+a.getShaderInfoLog(c)),null)},this.loadDefaultFragmentShader=function(a){var b=[];b.push("precision mediump float;\n"),b.push("struct Light"),b.push("{"),b.push("vec3 diffuse_color;"),b.push("vec3 specular_color;"),b.push("vec3 direction;"),b.push("vec3 half_vector;"),b.push("};"),b.push("struct Material"),b.push("{"),b.push("vec3 ambient_color;"),b.push("vec3 diffuse_color;"),b.push("vec3 specular_color;"),b.push("float shininess;"),b.push("float alpha;"),b.push("};"),b.push("uniform Light u_light;"),b.push("uniform Material u_material;"),b.push("varying vec4 v_diffuse;"),b.push("varying vec4 v_ambient;"),b.push("varying vec3 v_normal;"),b.push("varying vec3 v_light_direction;"),b.push("void main(void)"),b.push("{"),b.push("if(length(v_normal)==0.0){"),b.push("gl_FragColor = vec4(v_diffuse.rgba);"),b.push("}else{"),b.push("float nDotL = max(dot(v_normal, v_light_direction), 0.0);"),b.push("vec4 color = vec4(v_diffuse.rgb*nDotL, v_diffuse.a);"),b.push("float nDotHV = max(dot(v_normal, u_light.half_vector), 0.0);"),b.push("vec4 specular = vec4(u_material.specular_color * u_light.specular_color, 1.0);"),b.push("color+=vec4(specular.rgb * pow(nDotHV, u_material.shininess), specular.a);"),b.push("gl_FragColor = color+v_ambient;"),b.push("gl_FragColor.a*=u_material.alpha;"),b.push("}"),b.push("}");var c=a.createShader(a.FRAGMENT_SHADER);return a.shaderSource(c,b.join("")),a.compileShader(c),a.getShaderParameter(c,a.COMPILE_STATUS)?c:(alert("Fragment shader failed to compile: "+a.getShaderInfoLog(c)),null)},!0}}(ChemDoodle.structures,document),function(a,b){a.Shape=function(c,d){for(var e=c.length,f=[],g=[],h=new a.Point,i=0,j=e;j>i;i++){var k=i+1;i==j-1&&(k=0);for(var l=[0,0,1],m=c[i],n=c[k],o=[n.x-m.x,n.y-m.y,0],p=b.cross(l,o),q=0;2>q;q++)f.push(m.x,m.y,d/2),f.push(m.x,m.y,-d/2),f.push(n.x,n.y,d/2),f.push(n.x,n.y,-d/2);for(var q=0;4>q;q++)g.push(p[0],p[1],p[2]);g.push(0,0,1),g.push(0,0,-1),g.push(0,0,1),g.push(0,0,-1),h.add(m)}h.x/=e,h.y/=e,g.push(0,0,1),f.push(h.x,h.y,d/2),g.push(0,0,-1),f.push(h.x,h.y,-d/2);for(var r=[],s=8*e,i=0,j=e;j>i;i++){var t=8*i;r.push(t),r.push(t+1),r.push(t+3),r.push(t),r.push(t+2),r.push(t+3),r.push(t+4),r.push(t+6),r.push(s),r.push(t+5),r.push(t+7),r.push(s+1)}return this.storeData(f,g,r),!0},a.Shape.prototype=new a._Mesh}(ChemDoodle.structures,vec3),function(a,b,c){a.Star=function(){for(var a=[.8944,.4472,0,.2764,.4472,.8506,.2764,.4472,-.8506,-.7236,.4472,.5257,-.7236,.4472,-.5257,-.3416,.4472,0,-.1056,.4472,.3249,-.1056,.4472,-.3249,.2764,.4472,.2008,.2764,.4472,-.2008,-.8944,-.4472,0,-.2764,-.4472,.8506,-.2764,-.4472,-.8506,.7236,-.4472,.5257,.7236,-.4472,-.5257,.3416,-.4472,0,.1056,-.4472,.3249,.1056,-.4472,-.3249,-.2764,-.4472,.2008,-.2764,-.4472,-.2008,-.5527,.1058,0,-.1708,.1058,.5527,-.1708,.1058,-.5527,.4471,.1058,.3249,.4471,.1058,-.3249,.5527,-.1058,0,.1708,-.1058,.5527,.1708,-.1058,-.5527,-.4471,-.1058,.3249,-.4471,-.1058,-.3249,0,1,0,0,-1,0],b=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],d=[],e=[],f=[],g=0,h=b.length;h>g;g+=3){var i=3*b[g],j=3*b[g+1],k=3*b[g+2],l=[a[i],a[i+1],a[i+2]],m=[a[j],a[j+1],a[j+2]],n=[a[k],a[k+1],a[k+2]],o=[l[0]-m[0],l[1]-m[1],l[2]-m[2]],p=[n[0]-m[0],n[1]-m[1],n[2]-m[2]],q=c.cross(p,o,[]);c.normalize(q),d.push(l[0],l[1],l[2],m[0],m[1],m[2],n[0],n[1],n[2]),e.push(q[0],q[1],q[2],q[0],q[1],q[2],q[0],q[1],q[2]),f.push(g,g+1,g+2)}return this.storeData(d,e,f),!0},a.Star.prototype=new a._Mesh}(ChemDoodle.structures,Math,vec3),function(a,b,c,d,e,f){var g=function(a,b){a.bindBuffer(a.ARRAY_BUFFER,b.vertexPositionBuffer),a.vertexAttribPointer(a.shader.vertexPositionAttribute,b.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,b.vertexNormalBuffer),a.vertexAttribPointer(a.shader.vertexNormalAttribute,b.vertexNormalBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,b.vertexIndexBuffer)},h=function(a,b,c){var f=d.sqrt(b[1]*b[1]+b[2]*b[2]),g=[1,0,0,0,0,b[2]/f,-b[1]/f,0,0,b[1]/f,b[2]/f,0,0,0,0,1],h=[1,0,0,0,0,b[2]/f,b[1]/f,0,0,-b[1]/f,b[2]/f,0,0,0,0,1],i=[f,0,-b[0],0,0,1,0,0,b[0],0,f,0,0,0,0,1],j=[f,0,b[0],0,0,1,0,0,-b[0],0,f,0,0,0,0,1],k=[d.cos(c),-d.sin(c),0,0,d.sin(c),d.cos(c),0,0,0,0,1,0,0,0,0,1],l=e.multiply(g,e.multiply(i,e.multiply(k,e.multiply(j,h,[]))));this.rotate=function(){return e.multiplyVec3(l,a)}};c.Tube=function(i,j,k){var l=i[0].lineSegments[0].length;this.partitions=[];var m=null;this.ends=[],this.ends.push(i[0].lineSegments[0][0]),this.ends.push(i[i.length-2].lineSegments[0][0]);for(var n=[1,0,0],o=0,p=i.length-1;p>o;o++){(null==m||m.positionData.length>65e3)&&(this.partitions.length>0&&o--,m={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(m));var q=i[o];m.count++;for(var r=1/0,s=new c.Atom("",i[o+1].cp1.x,i[o+1].cp1.y,i[o+1].cp1.z),t=0;l>t;t++){var u=q.lineSegments[0][t],v=null;v=t==l-1?o==i.length-2?q.lineSegments[0][t-1]:i[o+1].lineSegments[0][0]:q.lineSegments[0][t+1];var w=[v.x-u.x,v.y-u.y,v.z-u.z];f.normalize(w),o==i.length-2&&t==l-1&&f.scale(w,-1);var x=vec3.cross(w,n,[]);f.normalize(x),f.scale(x,j/2);for(var y=new h(x,w,2*Math.PI/k),z=0,A=k;A>z;z++){var B=y.rotate();z==d.floor(k/4)&&(n=[B[0],B[1],B[2]]),m.normalData.push(B[0],B[1],B[2]),m.positionData.push(u.x+B[0],u.y+B[1],u.z+B[2])}if(null!=s){var C=u.distance3D(s);r>C&&(r=C,i[o+1].pPoint=u)}}}for(var D=0,E=this.partitions.length;E>D;D++)for(var m=this.partitions[D],o=0,p=m.count-1;p>o;o++)for(var F=o*l*k,t=0,G=l;G>t;t++)for(var H=F+t*k,z=0;k>z;z++){var I=1;z==k-1&&(nextRes=o==i.length-2?0:-z);var J=H+z;m.indexData.push(J),m.indexData.push(J+k),m.indexData.push(J+k+I),m.indexData.push(J),m.indexData.push(J+I),m.indexData.push(J+k+I)}this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData);for(var K=[new c.Point(2,0)],o=0;60>o;o++){var L=o/60*d.PI;K.push(new c.Point(2*d.cos(L),-2*d.sin(L)))}K.push(new c.Point(-2,0),new c.Point(-2,4),new c.Point(2,4));var M=new c.Shape(K,1);return this.render=function(h,k){if(this.bindBuffers(h),h.material.setDiffuseColor(k.macro_colorByChain?this.chainColor:k.nucleics_tubeColor),h.drawElements(h.TRIANGLES,this.vertexIndexBuffer.numItems,h.UNSIGNED_SHORT,0),this.partitions)for(var l=1,m=this.partitions.length;m>l;l++){var n=this.partitions[l];g(h,n),h.drawElements(h.TRIANGLES,n.vertexIndexBuffer.numItems,h.UNSIGNED_SHORT,0)}h.sphereBuffer.bindBuffers(h);for(var l=0;2>l;l++){var n=this.ends[l],o=e.translate(h.modelViewMatrix,[n.x,n.y,n.z],[]),p=j/2;e.scale(o,[p,p,p]),h.setMatrixUniforms(o),h.drawElements(h.TRIANGLES,h.sphereBuffer.vertexIndexBuffer.numItems,h.UNSIGNED_SHORT,0)}h.cylinderBuffer.bindBuffers(h);for(var l=1,m=i.length-1;m>l;l++){var q=i[l],r=q.pPoint,s=new c.Atom("",q.cp2.x,q.cp2.y,q.cp2.z),t=1.001*r.distance3D(s),u=[j/4,t,j/4],o=e.translate(h.modelViewMatrix,[r.x,r.y,r.z],[]),v=[0,1,0],w=0,x=null,y=[s.x-r.x,s.y-r.y,s.z-r.z];r.x==s.x&&r.z==s.z?(x=[0,0,1],r.y<r.y&&(w=d.PI)):(w=a.vec3AngleFrom(v,y),x=f.cross(v,y,[])),0!=w&&e.rotate(o,w,x),e.scale(o,u),h.setMatrixUniforms(o),h.drawArrays(h.TRIANGLE_STRIP,0,h.cylinderBuffer.vertexPositionBuffer.numItems)}M.bindBuffers(h),k.nucleics_useShapelyColors||k.macro_colorByChain||h.material.setDiffuseColor(k.nucleics_baseColor);for(var l=1,m=i.length-1;m>l;l++){var q=i[l],s=q.cp2,o=e.translate(h.modelViewMatrix,[s.x,s.y,s.z],[]),v=[0,1,0],w=0,x=null,z=q.cp3,y=[z.x-s.x,z.y-s.y,z.z-s.z];s.x==z.x&&s.z==z.z?(x=[0,0,1],s.y<s.y&&(w=d.PI)):(w=a.vec3AngleFrom(v,y),x=f.cross(v,y,[])),0!=w&&e.rotate(o,w,x);var A=[1,0,0],B=e.rotate(e.identity([]),w,x);e.multiplyVec3(B,A);var C=q.cp4,D=q.cp5;if(C.y!=D.y||C.z!=D.z){var E=[D.x-C.x,D.y-C.y,D.z-C.z],F=a.vec3AngleFrom(A,E);f.dot(y,f.cross(A,E))<0&&(F*=-1),e.rotateY(o,F)}k.nucleics_useShapelyColors&&!k.macro_colorByChain&&h.material.setDiffuseColor(b[q.name]?b[q.name].shapelyColor:b["*"].shapelyColor),h.setMatrixUniforms(o),h.drawElements(h.TRIANGLES,M.vertexIndexBuffer.numItems,h.UNSIGNED_SHORT,0)}},!0},c.Tube.prototype=new c._Mesh}(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,Math,mat4,vec3),function(a){a.UnitCell=function(a){var b=[],c=[],d=function(a,d,e,f){b.push(a[0],a[1],a[2]),b.push(d[0],d[1],d[2]),b.push(e[0],e[1],e[2]),b.push(f[0],f[1],f[2]);for(var g=0;4>g;g++)c.push(0,0,0)};d(a.o,a.x,a.xy,a.y),d(a.o,a.y,a.yz,a.z),d(a.o,a.z,a.xz,a.x),d(a.yz,a.y,a.xy,a.xyz),d(a.xyz,a.xz,a.z,a.yz),d(a.xy,a.x,a.xz,a.xyz);for(var e=[],f=0;6>f;f++){var g=4*f;e.push(g,g+1,g+1,g+2,g+2,g+3,g+3,g)}return this.storeData(b,c,e),!0},a.UnitCell.prototype=new a._Mesh}(ChemDoodle.structures,vec3),function(a,b,c){a.Plate=function(a){for(this.lanes=new Array(a),i=0,ii=a;ii>i;i++)this.lanes[i]=[];return this.sort=function(){for(i=0,ii=this.lanes.length;ii>i;i++)this.lanes[i].sort(function(a,b){return a-b})},this.draw=function(a){var d=a.canvas.width,e=a.canvas.height;for(this.origin=9*e/10,this.front=e/10,this.laneLength=this.origin-this.front,a.strokeStyle="#000000",a.beginPath(),a.moveTo(0,this.front),b.contextHashTo(a,0,this.front,d,this.front,3,3),a.closePath(),a.stroke(),a.beginPath(),a.moveTo(0,this.origin),a.lineTo(d,this.origin),a.closePath(),a.stroke(),i=0,ii=this.lanes.length;ii>i;i++){var f=(i+1)*d/(ii+1);for(a.beginPath(),a.moveTo(f,this.origin),a.lineTo(f,this.origin+3),a.closePath(),a.stroke(),s=0,ss=this.lanes[i].length;ss>s;s++){var g=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case"compact":a.beginPath(),a.arc(f,g,3,0,2*c.PI,!1),a.closePath();break;case"expanded":a.beginPath(),a.arc(f,g,7,0,2*c.PI,!1),a.closePath();break;case"trailing":break;case"widened":b.contextOval(a,f-18,g-10,36,10);break;case"cresent":a.beginPath(),a.arc(f,g,9,0,c.PI,!0),a.closePath()}switch(this.lanes[i][s].style){case"solid":a.fillStyle="#000000",a.fill();break;case"transparent":a.stroke();break;case"gradient":}}}},!0},a.Plate.Spot=function(a,b,c){this.type=a,this.rf=b,this.style=c?c:"solid"}}(ChemDoodle.structures,ChemDoodle.extensions,Math),function(a,b,c){a.default_backgroundColor="#FFFFFF",a.default_scale=1,a.default_rotateAngle=0,a.default_bondLength_2D=20,a.default_angstromsPerBondLength=1.25,a.default_lightDirection_3D=[-.1,-.1,-1],a.default_lightDiffuseColor_3D="#FFFFFF",a.default_lightSpecularColor_3D="#FFFFFF",a.default_projectionPerspective_3D=!0,a.default_projectionPerspectiveVerticalFieldOfView_3D=45,a.default_projectionOrthoWidth_3D=40,a.default_projectionWidthHeightRatio_3D=null,a.default_projectionFrontCulling_3D=.1,a.default_projectionBackCulling_3D=1e4,a.default_atoms_display=!0,a.default_atoms_color="#000000",a.default_atoms_font_size_2D=12,a.default_atoms_font_families_2D=["Helvetica","Arial","Dialog"],a.default_atoms_font_bold_2D=!1,a.default_atoms_font_italic_2D=!1,a.default_atoms_circles_2D=!1,a.default_atoms_circleDiameter_2D=10,a.default_atoms_circleBorderWidth_2D=1,a.default_atoms_lonePairDistance_2D=8,a.default_atoms_lonePairSpread_2D=4,a.default_atoms_lonePairDiameter_2D=1,a.default_atoms_useJMOLColors=!1,a.default_atoms_usePYMOLColors=!1,a.default_atoms_resolution_3D=60,a.default_atoms_sphereDiameter_3D=.8,a.default_atoms_useVDWDiameters_3D=!1,a.default_atoms_vdwMultiplier_3D=1,a.default_atoms_materialAmbientColor_3D="#000000",a.default_atoms_materialSpecularColor_3D="#555555",a.default_atoms_materialShininess_3D=32,a.default_atoms_implicitHydrogens_2D=!0,a.default_atoms_displayTerminalCarbonLabels_2D=!1,a.default_atoms_showHiddenCarbons_2D=!0,a.default_atoms_displayAllCarbonLabels_2D=!1,a.default_atoms_nonBondedAsStars_3D=!1,a.default_bonds_display=!0,a.default_bonds_color="#000000",a.default_bonds_width_2D=1,a.default_bonds_saturationWidth_2D=.2,a.default_bonds_ends_2D="round",a.default_bonds_useJMOLColors=!1,a.default_bonds_usePYMOLColors=!1,a.default_bonds_colorGradient=!1,a.default_bonds_saturationAngle_2D=c.PI/3,a.default_bonds_symmetrical_2D=!1,a.default_bonds_clearOverlaps_2D=!1,a.default_bonds_overlapClearWidth_2D=.5,a.default_bonds_atomLabelBuffer_2D=1,a.default_bonds_wedgeThickness_2D=.22,a.default_bonds_hashWidth_2D=1,a.default_bonds_hashSpacing_2D=2.5,a.default_bonds_showBondOrders_3D=!1,a.default_bonds_resolution_3D=60,a.default_bonds_renderAsLines_3D=!1,a.default_bonds_cylinderDiameter_3D=.3,a.default_bonds_materialAmbientColor_3D="#222222",a.default_bonds_materialSpecularColor_3D="#555555",a.default_bonds_materialShininess_3D=32,a.default_proteins_displayRibbon=!0,a.default_proteins_displayBackbone=!1,a.default_proteins_backboneThickness=1.5,a.default_proteins_backboneColor="#CCCCCC",a.default_proteins_ribbonCartoonize=!1,a.default_proteins_useShapelyColors=!1,a.default_proteins_useAminoColors=!1,a.default_proteins_usePolarityColors=!1,a.default_proteins_primaryColor="#FF0D0D",a.default_proteins_secondaryColor="#FFFF30",a.default_proteins_ribbonCartoonHelixPrimaryColor="#00E740",a.default_proteins_ribbonCartoonHelixSecondaryColor="#9905FF",a.default_proteins_ribbonCartoonSheetColor="#E8BB99",a.default_proteins_ribbonThickness=.2,a.default_proteins_verticalResolution=10,a.default_proteins_horizontalResolution=9,a.default_proteins_materialAmbientColor_3D="#222222",a.default_proteins_materialSpecularColor_3D="#555555",a.default_proteins_materialShininess_3D=32,a.default_nucleics_display=!0,a.default_nucleics_tubeColor="#CCCCCC",a.default_nucleics_baseColor="#C10000",a.default_nucleics_useShapelyColors=!0,a.default_nucleics_tubeThickness=1.5,a.default_nucleics_tubeResolution_3D=60,a.default_nucleics_verticalResolution=10,a.default_nucleics_materialAmbientColor_3D="#222222",a.default_nucleics_materialSpecularColor_3D="#555555",a.default_nucleics_materialShininess_3D=32,a.default_macro_displayAtoms=!1,a.default_macro_displayBonds=!1,a.default_macro_atomToLigandDistance=-1,a.default_macro_showWater=!1,a.default_macro_colorByChain=!1,a.default_surfaces_display=!0,a.default_surfaces_style="Dot",a.default_surfaces_color="#E9B862",a.default_surfaces_materialAmbientColor_3D="#000000",a.default_surfaces_materialSpecularColor_3D="#000000",a.default_surfaces_materialShininess_3D=32,a.default_crystals_displayUnitCell=!0,a.default_crystals_unitCellColor="green",a.default_crystals_unitCellLineWidth=1,a.default_plots_color="#000000",a.default_plots_width=1,a.default_plots_showIntegration=!1,a.default_plots_integrationColor="#c10000",a.default_plots_integrationLineWidth=1,a.default_plots_showGrid=!1,a.default_plots_gridColor="gray",a.default_plots_gridLineWidth=.5,a.default_plots_showYAxis=!0,a.default_plots_flipXAxis=!1,a.default_text_font_size=12,a.default_text_font_families=["Helvetica","Arial","Dialog"],a.default_text_color="#000000",b.VisualSpecifications=function(){this.backgroundColor=a.default_backgroundColor,this.scale=a.default_scale,this.rotateAngle=a.default_rotateAngle,this.bondLength=a.default_bondLength_2D,this.angstromsPerBondLength=a.default_angstromsPerBondLength,this.lightDirection_3D=a.default_lightDirection_3D,this.lightDiffuseColor_3D=a.default_lightDiffuseColor_3D,this.lightSpecularColor_3D=a.default_lightSpecularColor_3D,this.projectionPerspective_3D=a.default_projectionPerspective_3D,this.projectionPerspectiveVerticalFieldOfView_3D=a.default_projectionPerspectiveVerticalFieldOfView_3D,this.projectionOrthoWidth_3D=a.default_projectionOrthoWidth_3D,this.projectionWidthHeightRatio_3D=a.default_projectionWidthHeightRatio_3D,this.projectionFrontCulling_3D=a.default_projectionFrontCulling_3D,this.projectionBackCulling_3D=a.default_projectionBackCulling_3D,this.atoms_display=a.default_atoms_display,this.atoms_color=a.default_atoms_color,this.atoms_font_size_2D=a.default_atoms_font_size_2D,this.atoms_font_families_2D=[];for(var b=0,c=a.default_atoms_font_families_2D.length;c>b;b++)this.atoms_font_families_2D[b]=a.default_atoms_font_families_2D[b];this.atoms_font_bold_2D=a.default_atoms_font_bold_2D,this.atoms_font_italic_2D=a.default_atoms_font_italic_2D,this.atoms_circles_2D=a.default_atoms_circles_2D,this.atoms_circleDiameter_2D=a.default_atoms_circleDiameter_2D,this.atoms_circleBorderWidth_2D=a.default_atoms_circleBorderWidth_2D,this.atoms_lonePairDistance_2D=a.default_atoms_lonePairDistance_2D,this.atoms_lonePairSpread_2D=a.default_atoms_lonePairSpread_2D,this.atoms_lonePairDiameter_2D=a.default_atoms_lonePairDiameter_2D,this.atoms_useJMOLColors=a.default_atoms_useJMOLColors,this.atoms_usePYMOLColors=a.default_atoms_usePYMOLColors,this.atoms_resolution_3D=a.default_atoms_resolution_3D,this.atoms_sphereDiameter_3D=a.default_atoms_sphereDiameter_3D,this.atoms_useVDWDiameters_3D=a.default_atoms_useVDWDiameters_3D,this.atoms_vdwMultiplier_3D=a.default_atoms_vdwMultiplier_3D,this.atoms_materialAmbientColor_3D=a.default_atoms_materialAmbientColor_3D,this.atoms_materialSpecularColor_3D=a.default_atoms_materialSpecularColor_3D,this.atoms_materialShininess_3D=a.default_atoms_materialShininess_3D,this.atoms_implicitHydrogens_2D=a.default_atoms_implicitHydrogens_2D,this.atoms_displayTerminalCarbonLabels_2D=a.default_atoms_displayTerminalCarbonLabels_2D,this.atoms_showHiddenCarbons_2D=a.default_atoms_showHiddenCarbons_2D,this.atoms_displayAllCarbonLabels_2D=a.default_atoms_displayAllCarbonLabels_2D,this.atoms_nonBondedAsStars_3D=a.default_atoms_nonBondedAsStars_3D,this.bonds_display=a.default_bonds_display,this.bonds_color=a.default_bonds_color,this.bonds_width_2D=a.default_bonds_width_2D,this.bonds_saturationWidth_2D=a.default_bonds_saturationWidth_2D,this.bonds_ends_2D=a.default_bonds_ends_2D,this.bonds_useJMOLColors=a.default_bonds_useJMOLColors,this.bonds_usePYMOLColors=a.default_bonds_usePYMOLColors,this.bonds_colorGradient=a.default_bonds_colorGradient,this.bonds_saturationAngle_2D=a.default_bonds_saturationAngle_2D,this.bonds_symmetrical_2D=a.default_bonds_symmetrical_2D,this.bonds_clearOverlaps_2D=a.default_bonds_clearOverlaps_2D,this.bonds_overlapClearWidth_2D=a.default_bonds_overlapClearWidth_2D,this.bonds_atomLabelBuffer_2D=a.default_bonds_atomLabelBuffer_2D,this.bonds_wedgeThickness_2D=a.default_bonds_wedgeThickness_2D,this.bonds_hashWidth_2D=a.default_bonds_hashWidth_2D,this.bonds_hashSpacing_2D=a.default_bonds_hashSpacing_2D,this.bonds_showBondOrders_3D=a.default_bonds_showBondOrders_3D,this.bonds_resolution_3D=a.default_bonds_resolution_3D,this.bonds_renderAsLines_3D=a.default_bonds_renderAsLines_3D,this.bonds_cylinderDiameter_3D=a.default_bonds_cylinderDiameter_3D,this.bonds_materialAmbientColor_3D=a.default_bonds_materialAmbientColor_3D,this.bonds_materialSpecularColor_3D=a.default_bonds_materialSpecularColor_3D,this.bonds_materialShininess_3D=a.default_bonds_materialShininess_3D,this.proteins_displayRibbon=a.default_proteins_displayRibbon,this.proteins_displayBackbone=a.default_proteins_displayBackbone,this.proteins_backboneThickness=a.default_proteins_backboneThickness,this.proteins_backboneColor=a.default_proteins_backboneColor,this.proteins_ribbonCartoonize=a.default_proteins_ribbonCartoonize,this.proteins_useShapelyColors=a.default_proteins_useShapelyColors,this.proteins_useAminoColors=a.default_proteins_useAminoColors,this.proteins_usePolarityColors=a.default_proteins_usePolarityColors,this.proteins_primaryColor=a.default_proteins_primaryColor,this.proteins_secondaryColor=a.default_proteins_secondaryColor,this.proteins_ribbonCartoonHelixPrimaryColor=a.default_proteins_ribbonCartoonHelixPrimaryColor,this.proteins_ribbonCartoonHelixSecondaryColor=a.default_proteins_ribbonCartoonHelixSecondaryColor,this.proteins_ribbonCartoonSheetColor=a.default_proteins_ribbonCartoonSheetColor,this.proteins_ribbonThickness=a.default_proteins_ribbonThickness,this.proteins_verticalResolution=a.default_proteins_verticalResolution,this.proteins_horizontalResolution=a.default_proteins_horizontalResolution,this.proteins_materialAmbientColor_3D=a.default_proteins_materialAmbientColor_3D,this.proteins_materialSpecularColor_3D=a.default_proteins_materialSpecularColor_3D,this.proteins_materialShininess_3D=a.default_proteins_materialShininess_3D,this.macro_displayAtoms=a.default_macro_displayAtoms,this.macro_displayBonds=a.default_macro_displayBonds,this.macro_atomToLigandDistance=a.default_macro_atomToLigandDistance,this.nucleics_display=a.default_nucleics_display,this.nucleics_tubeColor=a.default_nucleics_tubeColor,this.nucleics_baseColor=a.default_nucleics_baseColor,this.nucleics_useShapelyColors=a.default_nucleics_useShapelyColors,this.nucleics_tubeThickness=a.default_nucleics_tubeThickness,this.nucleics_tubeResolution_3D=a.default_nucleics_tubeResolution_3D,this.nucleics_verticalResolution=a.default_nucleics_verticalResolution,this.nucleics_materialAmbientColor_3D=a.default_nucleics_materialAmbientColor_3D,this.nucleics_materialSpecularColor_3D=a.default_nucleics_materialSpecularColor_3D,this.nucleics_materialShininess_3D=a.default_nucleics_materialShininess_3D,this.macro_showWater=a.default_macro_showWater,this.macro_colorByChain=a.default_macro_colorByChain,this.surfaces_display=a.default_surfaces_display,this.surfaces_style=a.default_surfaces_style,this.surfaces_color=a.default_surfaces_color,this.surfaces_materialAmbientColor_3D=a.default_surfaces_materialAmbientColor_3D,this.surfaces_materialSpecularColor_3D=a.default_surfaces_materialSpecularColor_3D,this.surfaces_materialShininess_3D=a.default_surfaces_materialShininess_3D,this.crystals_displayUnitCell=a.default_crystals_displayUnitCell,this.crystals_unitCellColor=a.default_crystals_unitCellColor,this.crystals_unitCellLineWidth=a.default_crystals_unitCellLineWidth,this.plots_color=a.default_plots_color,this.plots_width=a.default_plots_width,this.plots_showIntegration=a.default_plots_showIntegration,this.plots_integrationColor=a.default_plots_integrationColor,this.plots_integrationLineWidth=a.default_plots_integrationLineWidth,this.plots_showGrid=a.default_plots_showGrid,this.plots_gridColor=a.default_plots_gridColor,this.plots_gridLineWidth=a.default_plots_gridLineWidth,this.plots_showYAxis=a.default_plots_showYAxis,this.plots_flipXAxis=a.default_plots_flipXAxis,this.text_font_size=a.default_text_font_size,this.text_font_families=[];
for(var b=0,c=a.default_text_font_families.length;c>b;b++)this.text_font_families[b]=a.default_text_font_families[b];this.text_color=a.default_text_color,this.set3DRepresentation=function(b){this.atoms_display=!0,this.bonds_display=!0,this.bonds_color="#777777",this.atoms_useVDWDiameters_3D=!0,this.atoms_useJMOLColors=!0,this.bonds_useJMOLColors=!0,this.bonds_showBondOrders_3D=!0,this.bonds_renderAsLines_3D=!1,"Ball and Stick"==b?(this.atoms_vdwMultiplier_3D=.3,this.bonds_useJMOLColors=!1,this.bonds_cylinderDiameter_3D=.3,this.bonds_materialAmbientColor_3D=a.default_atoms_materialAmbientColor_3D):"van der Waals Spheres"==b?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=1):"Stick"==b?(this.atoms_useVDWDiameters_3D=!1,this.bonds_showBondOrders_3D=!1,this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=.8,this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):"Wireframe"==b?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=.05,this.atoms_sphereDiameter_3D=.15,this.bonds_materialAmbientColor_3D=a.default_atoms_materialAmbientColor_3D):"Line"==b?(this.atoms_display=!1,this.bonds_renderAsLines_3D=!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=.05):alert('"'+b+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')},this.getFontString=function(a,b,c,d){var e=[];c&&e.push("bold "),d&&e.push("italic "),e.push(a+"px ");for(var f=0,g=b.length;g>f;f++){var h=b[f];-1!=h.indexOf(" ")&&(h='"'+h+'"'),e.push((0!=f?",":"")+h)}return e.join("")}}}(ChemDoodle,ChemDoodle.structures,Math),function(a,b,c,d){c.getPointsPerAngstrom=function(){return a.default_bondLength_2D/a.default_angstromsPerBondLength},c.BondDeducer=function(){return this.margin=1.1,this.deduceCovalentBonds=function(a,e){var f=c.getPointsPerAngstrom();e&&(f=e);for(var g=0,h=a.atoms.length;h>g;g++)for(var i=g+1;h>i;i++){var j=a.atoms[g],k=a.atoms[i];j.distance3D(k)<(b[j.label].covalentRadius+b[k.label].covalentRadius)*f*this.margin&&a.bonds.push(new d.Bond(j,k,1))}},!0}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.informatics,ChemDoodle.structures),function(a){a.HydrogenDeducer=function(){return this.removeHydrogens=function(a){for(var b=[],c=[],d=0,e=a.bonds.length;e>d;d++)"H"!=a.bonds[d].a1.label&&"H"!=a.bonds[d].a2.label&&c.push(a.bonds[d]);for(var d=0,e=a.atoms.length;e>d;d++)"H"!=a.atoms[d].label&&b.push(a.atoms[d]);a.atoms=b,a.bonds=c},!0}}(ChemDoodle.informatics),function(a,b,c){b.MolecularSurfaceGenerator=function(){return this.generateSurface=function(a,b,d,e,f){return new c.MolecularSurface(a,b,d,e,f)},!0}}(ChemDoodle,ChemDoodle.informatics,ChemDoodle.structures),function(a,b){a.Splitter=function(){return this.split=function(a){for(var c=[],d=0,e=a.atoms.length;e>d;d++)a.atoms[d].visited=!1;for(var d=0,e=a.bonds.length;e>d;d++)a.bonds[d].visited=!1;for(var d=0,e=a.atoms.length;e>d;d++){var f=a.atoms[d];if(!f.visited){var g=new b.Molecule;g.atoms.push(f),f.visited=!0;var h=new b.Queue;for(h.enqueue(f);!h.isEmpty();)for(var i=h.dequeue(),j=0,k=a.bonds.length;k>j;j++){var l=a.bonds[j];if(l.contains(i)&&!l.visited){l.visited=!0,g.bonds.push(l);var m=l.getNeighbor(i);m.visited||(m.visited=!0,g.atoms.push(m),h.enqueue(m))}}c.push(g)}}return c},!0}}(ChemDoodle.informatics,ChemDoodle.structures),function(a,b){a.StructureBuilder=function(){return this.copy=function(a){for(var c=0,d=a.atoms.length;d>c;c++)a.atoms[c].metaID=c;for(var e=new b.Molecule,c=0,d=a.atoms.length;d>c;c++)e.atoms[c]=new b.Atom(a.atoms[c].label,a.atoms[c].x,a.atoms[c].y,a.atoms[c].z);for(var c=0,d=a.bonds.length;d>c;c++)e.bonds[c]=new b.Bond(e.atoms[a.bonds[c].a1.metaID],e.atoms[a.bonds[c].a2.metaID],a.bonds[c].bondOrder);return e},!0}}(ChemDoodle.informatics,ChemDoodle.structures),function(a){a._Counter=function(){return this.value=0,this.molecule=null,this.setMolecule=function(a){this.value=0,this.molecule=a,this.innerCalculate&&this.innerCalculate()},!0}}(ChemDoodle.informatics),function(a){a.FrerejacqueNumberCounter=function(a){return this.setMolecule(a),!0},a.FrerejacqueNumberCounter.prototype=new a._Counter,a.FrerejacqueNumberCounter.prototype.innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+new a.NumberOfMoleculesCounter(this.molecule).value}}(ChemDoodle.informatics),function(a,b){b.NumberOfMoleculesCounter=function(a){return this.setMolecule(a),!0},b.NumberOfMoleculesCounter.prototype=new b._Counter,b.NumberOfMoleculesCounter.prototype.innerCalculate=function(){for(var b=0,c=this.molecule.atoms.length;c>b;b++)this.molecule.atoms[b].visited=!1;for(var b=0,c=this.molecule.atoms.length;c>b;b++)if(!this.molecule.atoms[b].visited){this.value++;var d=new a.Queue;for(this.molecule.atoms[b].visited=!0,d.enqueue(this.molecule.atoms[b]);!d.isEmpty();)for(var e=d.dequeue(),f=0,g=this.molecule.bonds.length;g>f;f++){var h=this.molecule.bonds[f];if(h.contains(e)){var i=h.getNeighbor(e);i.visited||(i.visited=!0,d.enqueue(i))}}}}}(ChemDoodle.structures,ChemDoodle.informatics),function(a,b){a._RingFinder=function(){return this.atoms=null,this.bonds=null,this.rings=null,this.reduce=function(a){for(var b=0,c=a.atoms.length;c>b;b++)a.atoms[b].visited=!1;for(var b=0,c=a.bonds.length;c>b;b++)a.bonds[b].visited=!1;for(var d=!0;d;){d=!1;for(var b=0,c=a.atoms.length;c>b;b++){for(var e=0,f=null,g=0,h=a.bonds.length;h>g;g++)if(a.bonds[g].contains(a.atoms[b])&&!a.bonds[g].visited){if(e++,2==e)break;f=a.bonds[g]}1==e&&(d=!0,f.visited=!0,a.atoms[b].visited=!0)}}for(var b=0,c=a.atoms.length;c>b;b++)a.atoms[b].visited||this.atoms.push(a.atoms[b]);for(var b=0,c=a.bonds.length;c>b;b++)a.bonds[b].visited||this.bonds.push(a.bonds[b]);0==this.bonds.length&&0!=this.atoms.length&&(this.atoms=[])},this.setMolecule=function(a){this.atoms=[],this.bonds=[],this.rings=[],this.reduce(a),this.atoms.length>2&&this.innerGetRings&&this.innerGetRings()},this.fuse=function(){for(var a=0,c=this.rings.length;c>a;a++)for(var d=0,e=this.bonds.length;e>d;d++)-1!=b(this.bonds[d].a1,this.rings[a].atoms)&&-1!=b(this.bonds[d].a2,this.rings[a].atoms)&&this.rings[a].bonds.push(this.bonds[d])},!0}}(ChemDoodle.informatics,jQuery.inArray),function(a,b,c){function d(a,e){if(this.atoms=[],e)for(var f=0,g=e.atoms.length;g>f;f++)this.atoms[f]=e.atoms[f];return this.atoms.push(a),this.grow=function(a,b){for(var e=this.atoms[this.atoms.length-1],f=[],g=0,h=a.length;h>g;g++)if(a[g].contains(e)){var i=a[g].getNeighbor(e);-1==c(i,b)&&f.push(i)}for(var j=[],g=0,h=f.length;h>g;g++)j.push(new d(f[g],this));return j},this.check=function(a,d,e){for(var f=0,g=d.atoms.length-1;g>f;f++)if(-1!=c(d.atoms[f],this.atoms))return null;var h=null;if(d.atoms[d.atoms.length-1]==this.atoms[this.atoms.length-1]){h=new b.Ring,h.atoms[0]=e;for(var f=0,g=this.atoms.length;g>f;f++)h.atoms.push(this.atoms[f]);for(var f=d.atoms.length-2;f>=0;f--)h.atoms.push(d.atoms[f])}else{for(var i=[],f=0,g=a.length;g>f;f++)a[f].contains(d.atoms[d.atoms.length-1])&&i.push(a[f]);for(var f=0,g=i.length;g>f;f++)if((1==d.atoms.length||!i[f].contains(d.atoms[d.atoms.length-2]))&&i[f].contains(this.atoms[this.atoms.length-1])){h=new b.Ring,h.atoms[0]=e;for(var j=0,k=this.atoms.length;k>j;j++)h.atoms.push(this.atoms[j]);for(var j=d.atoms.length-1;j>=0;j--)h.atoms.push(d.atoms[j]);break}}return h},!0}a.EulerFacetRingFinder=function(a){return this.fingerBreak=5,this.setMolecule(a),!0},a.EulerFacetRingFinder.prototype=new a._RingFinder,a.EulerFacetRingFinder.prototype.innerGetRings=function(){for(var a=0,b=this.atoms.length;b>a;a++){for(var e=[],f=0,g=this.bonds.length;g>f;f++)this.bonds[f].contains(this.atoms[a])&&e.push(this.bonds[f].getNeighbor(this.atoms[a]));for(var f=0,g=e.length;g>f;f++)for(var h=f+1;h<e.length;h++){var i=[];i[0]=new d(e[f]),i[1]=new d(e[h]);var j=[];j[0]=this.atoms[a];for(var k=0,l=e.length;l>k;k++)k!=f&&k!=h&&j.push(e[k]);var m=[],n=i[0].check(this.bonds,i[1],this.atoms[a]);for(n&&(m[0]=n);0==m.length&&i.length>0&&i[0].atoms.length<this.fingerBreak;){for(var o=[],k=0,l=i.length;l>k;k++)for(var p=i[k].grow(this.bonds,j),q=0,r=p.length;r>q;q++)o.push(p[q]);i=o;for(var k=0,l=i.length;l>k;k++)for(var q=k+1;l>q;q++){var s=i[k].check(this.bonds,i[q],this.atoms[a]);s&&m.push(s)}if(0==m.length){for(var t=[],k=0,l=j.length;l>k;k++)for(var q=0,r=this.bonds.length;r>q;q++)if(this.bonds[q].contains(j[k])){var e=this.bonds[q].getNeighbor(j[k]);-1==c(e,j)&&-1==c(e,t)&&t.push(e)}for(var k=0,l=t.length;l>k;k++)j.push(t[k])}}if(m.length>0){for(var u=null,k=0,l=m.length;l>k;k++)(!u||u.atoms.length>m[k].atoms.length)&&(u=m[k]);for(var v=!1,k=0,l=this.rings.length;l>k;k++){for(var w=!0,q=0,r=u.atoms.length;r>q;q++)if(-1==c(u.atoms[q],this.rings[k].atoms)){w=!1;break}if(w){v=!0;break}}v||this.rings.push(u)}}}this.fuse()}}(ChemDoodle.informatics,ChemDoodle.structures,jQuery.inArray),function(a){a.SSSRFinder=function(b){if(this.rings=[],b.atoms.length>0){var c=new a.FrerejacqueNumberCounter(b).value,d=new a.EulerFacetRingFinder(b).rings;d.sort(function(a,b){return a.atoms.length-b.atoms.length});for(var e=0,f=b.bonds.length;f>e;e++)b.bonds[e].visited=!1;for(var e=0,f=d.length;f>e;e++){for(var g=!1,h=0,i=d[e].bonds.length;i>h;h++)if(!d[e].bonds[h].visited){g=!0;break}if(g){for(var h=0,i=d[e].bonds.length;i>h;h++)d[e].bonds[h].visited=!0;this.rings.push(d[e])}if(this.rings.length==c)break}}return!0}}(ChemDoodle.informatics),function(a,b,c,d,e,f,g,h){var i=/\s+/g,j=/\(|\)|\s+/g,k=/\'|\s+/g,l=/,|\'|\s+/g,m=/^\s+/,n=/[0-9]/g,o=/[0-9]|\+|\-/g,p=function(a){return 0!=a.length},q={P:[],A:[[0,.5,.5]],B:[[.5,0,.5]],C:[[.5,.5,0]],I:[[.5,.5,.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,.5,.5],[.5,0,.5],[.5,.5,0]]},r=function(a){var b=0,c=0,d=0,e=0,f=a.indexOf("x"),g=a.indexOf("y"),h=a.indexOf("z");if(-1!=f&&(c++,f>0&&"+"!=a.charAt(f-1)&&(c*=-1)),-1!=g&&(d++,g>0&&"+"!=a.charAt(g-1)&&(d*=-1)),-1!=h&&(e++,h>0&&"+"!=a.charAt(h-1)&&(e*=-1)),a.length>2)for(var i="+",j=0,k=a.length;k>j;j++){var l=a.charAt(j);"-"!=l&&"/"!=l||j!=a.length-1&&!a.charAt(j+1).match(n)||(i=l),l.match(n)&&("+"==i?b+=parseInt(l):"-"==i?b-=parseInt(l):"/"==i&&(b/=parseInt(l)))}return[b,c,d,e]},s=function(a,b,c,d,f,g){var h=(e.cos(d)-e.cos(g)*e.cos(f))/e.sin(g);return[a,0,0,0,b*e.cos(g),b*e.sin(g),0,0,c*e.cos(f),c*h,c*e.sqrt(1-e.pow(e.cos(f),2)-h*h),0,0,0,0,1]};c.CIFInterpreter=function(){this.read=function(c,g,n,t){g=g?g:1,n=n?n:1,t=t?t:1;var u=new d.Molecule;if(null==c||0==c.length)return u;for(var v=c.split("\n"),w=0,x=0,y=0,z=0,A=0,B=0,C="P",D=null,E=null,F=null,G=null,H=!0;v.length>0;)if(H?G=v.shift():H=!0,G.length>0)if(b.stringStartsWith(G,"_cell_length_a"))w=parseFloat(G.split(j)[1]);else if(b.stringStartsWith(G,"_cell_length_b"))x=parseFloat(G.split(j)[1]);else if(b.stringStartsWith(G,"_cell_length_c"))y=parseFloat(G.split(j)[1]);else if(b.stringStartsWith(G,"_cell_angle_alpha"))z=e.PI*parseFloat(G.split(j)[1])/180;else if(b.stringStartsWith(G,"_cell_angle_beta"))A=e.PI*parseFloat(G.split(j)[1])/180;else if(b.stringStartsWith(G,"_cell_angle_gamma"))B=e.PI*parseFloat(G.split(j)[1])/180;else if(b.stringStartsWith(G,"_symmetry_space_group_name_H-M"))C=G.split(k)[1];else if(b.stringStartsWith(G,"loop_")){for(var I={fields:[],lines:[]},J=!1;null!=(G=v.shift())&&!b.stringStartsWith(G=G.replace(m,""),"loop_")&&G.length>0;)if(b.stringStartsWith(G,"_")){if(J)break;I.fields=I.fields.concat(G.split(i).filter(p))}else J=!0,I.lines.push(G);0!=v.length&&(b.stringStartsWith(G,"loop_")||b.stringStartsWith(G,"_"))&&(H=!1),-1!=h("_symmetry_equiv_pos_as_xyz",I.fields)||-1!=h("_space_group_symop_operation_xyz",I.fields)?D=I:-1!=h("_atom_site_label",I.fields)?E=I:-1!=h("_geom_bond_atom_site_label_1",I.fields)&&(F=I)}var K=s(w,x,y,z,A,B);if(null!=E){for(var L=altLabelIndex=xIndex=yIndex=zIndex=-1,M=0,N=E.fields.length;N>M;M++){var O=E.fields[M];"_atom_site_type_symbol"==O?L=M:"_atom_site_label"==O?altLabelIndex=M:"_atom_site_fract_x"==O?xIndex=M:"_atom_site_fract_y"==O?yIndex=M:"_atom_site_fract_z"==O&&(zIndex=M)}for(var M=0,N=E.lines.length;N>M;M++){G=E.lines[M];var P=G.split(i).filter(p),Q=new d.Atom(P[-1==L?altLabelIndex:L].split(o)[0],parseFloat(P[xIndex]),parseFloat(P[yIndex]),parseFloat(P[zIndex]));u.atoms.push(Q),-1!=altLabelIndex&&(Q.cifId=P[altLabelIndex],Q.cifPart=0)}}if(null!=D&&null==F){for(var R=0,M=0,N=D.fields.length;N>M;M++){var O=D.fields[M];("_symmetry_equiv_pos_as_xyz"==O||"_space_group_symop_operation_xyz"==O)&&(R=M)}for(var S=q[C],T=[],M=0,N=D.lines.length;N>M;M++)for(var U=D.lines[M].split(l).filter(p),V=r(U[R]),W=r(U[R+1]),X=r(U[R+2]),Y=0,Z=u.atoms.length;Z>Y;Y++){var Q=u.atoms[Y],$=Q.x*V[1]+Q.y*V[2]+Q.z*V[3]+V[0],_=Q.x*W[1]+Q.y*W[2]+Q.z*W[3]+W[0],ab=Q.x*X[1]+Q.y*X[2]+Q.z*X[3]+X[0],bb=new d.Atom(Q.label,$,_,ab);if(T.push(bb),null!=Q.cifId&&(bb.cifId=Q.cifId,bb.cifPart=M+1),S)for(var cb=0,db=S.length;db>cb;cb++){var eb=S[cb],fb=new d.Atom(Q.label,$+eb[0],_+eb[1],ab+eb[2]);T.push(fb),null!=Q.cifId&&(fb.cifId=Q.cifId,fb.cifPart=M+1)}}for(var M=0,N=T.length;N>M;M++){for(var Q=T[M];Q.x>=1;)Q.x--;for(;Q.x<0;)Q.x++;for(;Q.y>=1;)Q.y--;for(;Q.y<0;)Q.y++;for(;Q.z>=1;)Q.z--;for(;Q.z<0;)Q.z++}for(var gb=[],M=0,N=T.length;N>M;M++){for(var hb=!1,Q=T[M],Y=0,Z=u.atoms.length;Z>Y;Y++)if(u.atoms[Y].distance3D(Q)<1e-4){hb=!0;break}if(!hb){for(var Y=0,Z=gb.length;Z>Y;Y++)if(gb[Y].distance3D(Q)<1e-4){hb=!0;break}hb||gb.push(Q)}}u.atoms=u.atoms.concat(gb)}for(var ib=[],M=0;g>M;M++)for(var Y=0;n>Y;Y++)for(var cb=0;t>cb;cb++)if(0!=M||0!=Y||0!=cb)for(var jb=0,kb=u.atoms.length;kb>jb;jb++){var Q=u.atoms[jb],lb=new d.Atom(Q.label,Q.x+M,Q.y+Y,Q.z+cb);ib.push(lb),null!=Q.cifId&&(lb.cifId=Q.cifId,lb.cifPart=Q.cifPart+(D?D.lines.length:0)+M+10*Y+100*cb)}u.atoms=u.atoms.concat(ib);for(var M=0,N=u.atoms.length;N>M;M++){var Q=u.atoms[M],mb=f.multiplyVec3(K,[Q.x,Q.y,Q.z]);Q.x=mb[0],Q.y=mb[1],Q.z=mb[2]}if(null!=F){for(var nb=atom2=-1,M=0,N=F.fields.length;N>M;M++){var O=F.fields[M];"_geom_bond_atom_site_label_1"==O?nb=M:"_geom_bond_atom_site_label_2"==O&&(atom2=M)}for(var cb=0,db=F.lines.length;db>cb;cb++)for(var P=F.lines[cb].split(i).filter(p),ob=P[nb],pb=P[atom2],M=0,N=u.atoms.length;N>M;M++)for(var Y=M+1;N>Y;Y++){var qb=u.atoms[M],rb=u.atoms[Y];if(qb.cifPart!=rb.cifPart)break;(qb.cifId==ob&&rb.cifId==pb||qb.cifId==pb&&rb.cifId==ob)&&u.bonds.push(new d.Bond(qb,rb))}}else(new a.informatics.BondDeducer).deduceCovalentBonds(u,1);var sb=[-g/2,-n/2,-t/2];return u.unitCellVectors={o:f.multiplyVec3(K,sb,[]),x:f.multiplyVec3(K,[sb[0]+1,sb[1],sb[2]]),y:f.multiplyVec3(K,[sb[0],sb[1]+1,sb[2]]),z:f.multiplyVec3(K,[sb[0],sb[1],sb[2]+1]),xy:f.multiplyVec3(K,[sb[0]+1,sb[1]+1,sb[2]]),xz:f.multiplyVec3(K,[sb[0]+1,sb[1],sb[2]+1]),yz:f.multiplyVec3(K,[sb[0],sb[1]+1,sb[2]+1]),xyz:f.multiplyVec3(K,[sb[0]+1,sb[1]+1,sb[2]+1])},u}};var t=new c.CIFInterpreter;a.readCIF=function(a,b,c,d){return t.read(a,b,c,d)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,Math,mat4,vec3,jQuery.inArray),function(a,b,c,d,e){function f(a,b,c){for(var d=a.length,e="",f=0;b-d>f;f++)e+=" ";return c?a+e:e+a}c.MOLInterpreter=function(){this.read=function(c,e){e||(e=a.default_bondLength_2D);var f=new d.Molecule;if(null==c||0==c.length)return f;for(var g=c.split("\n"),h=g[3],i=parseInt(h.substring(0,3)),j=parseInt(h.substring(3,6)),k=0;i>k;k++){var l=g[4+k];f.atoms[k]=new d.Atom(l.substring(31,34),parseFloat(l.substring(0,10))*e,(1==e?1:-1)*parseFloat(l.substring(10,20))*e,parseFloat(l.substring(20,30))*e);var m=parseInt(l.substring(34,36));switch(0!=m&&null!=b[f.atoms[k].label]&&(f.atoms[k].mass=b[f.atoms[k].label].mass+m),parseInt(l.substring(36,39))){case 1:f.atoms[k].charge=3;break;case 2:f.atoms[k].charge=2;break;case 3:f.atoms[k].charge=1;break;case 5:f.atoms[k].charge=-1;break;case 6:f.atoms[k].charge=-2;break;case 7:f.atoms[k].charge=-3}}for(var k=0;j>k;k++){var l=g[4+i+k],n=parseInt(l.substring(6,9)),o=parseInt(l.substring(9,12));if(n>3)switch(n){case 4:n=1.5;break;default:n=1}var p=new d.Bond(f.atoms[parseInt(l.substring(0,3))-1],f.atoms[parseInt(l.substring(3,6))-1],n);switch(o){case 3:p.stereo=d.Bond.STEREO_AMBIGUOUS;break;case 1:p.stereo=d.Bond.STEREO_PROTRUDING;break;case 6:p.stereo=d.Bond.STEREO_RECESSED}f.bonds[k]=p}return f},this.write=function(c){var g="Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n";g=g+f(c.atoms.length.toString(),3)+f(c.bonds.length.toString(),3)+"  0  0  0  0            999 v2000\n";for(var h=c.getCenter(),i=0,j=c.atoms.length;j>i;i++){var k=c.atoms[i],l=" 0";if(-1!=k.mass&&null!=b[k.label]){var m=k.mass-b[k.label].mass;5>m&&m>-4&&(l=(m>-1?" ":"")+m)}var n="  0";if(0!=k.charge)switch(k.charge){case 3:n="  1";break;case 2:n="  2";break;case 1:n="  3";break;case-1:n="  5";break;case-2:n="  6";break;case-3:n="  7"}g=g+f(((k.x-h.x)/a.default_bondLength_2D).toFixed(4),10)+f((-(k.y-h.y)/a.default_bondLength_2D).toFixed(4),10)+f((k.z/a.default_bondLength_2D).toFixed(4),10)+" "+f(k.label,3,!0)+l+n+"  0  0  0  0\n"}for(var i=0,j=c.bonds.length;j>i;i++){var o=c.bonds[i],p=0;o.stereo==d.Bond.STEREO_AMBIGUOUS?p=3:o.stereo==d.Bond.STEREO_PROTRUDING?p=1:o.stereo==d.Bond.STEREO_RECESSED&&(p=6),g=g+f((e(o.a1,c.atoms)+1).toString(),3)+f((e(o.a2,c.atoms)+1).toString(),3)+f(o.bondOrder.toString(),3)+"  "+p+"     0  0\n"}return g+="M  END"}};var g=new c.MOLInterpreter;a.readMOL=function(a,b){return g.read(a,b)},a.writeMOL=function(a){return g.write(a)}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures,jQuery.inArray),function(a,b,c,d,e,f,g){c.PDBInterpreter=function(){function c(a,b,c,d,e){for(var f=0,g=b.length;g>f;f++){var h=b[f];if(h.id==c&&d>=h.start&&d<=h.end)return e?a.helix=!0:a.sheet=!0,void(d+1==h.end&&(a.arrow=!0))}}this.calculateRibbonDistances=!1,this.deduceResidueBonds=!1,this.read=function(h,i){var j=new d.Molecule;if(j.chains=[],null==h||0==h.length)return j;var k=h.split("\n");i||(i=1);for(var l=[],m=[],n=null,o=[],p=[],q=[],r=0,s=k.length;s>r;r++){var t=k[r];if(b.stringStartsWith(t,"HELIX"))l.push({id:t.substring(19,20),start:parseInt(t.substring(21,25)),end:parseInt(t.substring(33,37))});else if(b.stringStartsWith(t,"SHEET"))m.push({id:t.substring(21,22),start:parseInt(t.substring(22,26)),end:parseInt(t.substring(33,37))});else if(b.stringStartsWith(t,"ATOM")){var u=t.substring(16,17);if(" "==u||"A"==u){var v=f(t.substring(76,78));if(0==v.length){var w=f(t.substring(12,14));"HD"==w?v="H":w.length>0&&(v=w.length>1?w.charAt(0)+w.substring(1).toLowerCase():w)}var x=new d.Atom(v,parseFloat(t.substring(30,38))*i,parseFloat(t.substring(38,46))*i,parseFloat(t.substring(46,54))*i);x.hetatm=!1,p.push(x);var y=parseInt(t.substring(22,26));if(0==o.length)for(var z=0;2>z;z++){var A=new d.Residue(-1);A.cp1=x,A.cp2=x,o.push(A)}if(y!=Number.NaN&&o[o.length-1].resSeq!=y){var B=new d.Residue(y);B.name=f(t.substring(17,20)),3==B.name.length?B.name=B.name.substring(0,1)+B.name.substring(1).toLowerCase():2==B.name.length&&"D"==B.name.charAt(0)&&(B.name=B.name.substring(1)),o.push(B);var C=t.substring(21,22);c(B,l,C,y,!0),c(B,m,C,y,!1)}var D=f(t.substring(12,16)),E=o[o.length-1];"CA"==D||"P"==D||"O5'"==D?E.cp1||(E.cp1=x):"N3"==D&&("C"==E.name||"U"==E.name||"T"==E.name)||"N1"==D&&("A"==E.name||"G"==E.name)?E.cp3=x:"C2"==D?E.cp4=x:"C4"==D&&("C"==E.name||"U"==E.name||"T"==E.name)||"C6"==D&&("A"==E.name||"G"==E.name)?E.cp5=x:"O"==D||"C6"==D&&("C"==E.name||"U"==E.name||"T"==E.name)||"N9"==D?o[o.length-1].cp2||(("C6"==D||"N9"==D)&&(n=x),E.cp2=x):"C"==D&&(n=x)}}else if(b.stringStartsWith(t,"HETATM")){var F=f(t.substring(76,78));F.length>1&&(F=F.substring(0,1)+F.substring(1).toLowerCase());var G=new d.Atom(F,parseFloat(t.substring(30,38))*i,parseFloat(t.substring(38,46))*i,parseFloat(t.substring(46,54))*i);G.hetatm=!0;var H=f(t.substring(17,20));"HOH"==H&&(G.isWater=!0),j.atoms.push(G),q[parseInt(f(t.substring(6,11)))]=G}else if(b.stringStartsWith(t,"CONECT")){var I=parseInt(f(t.substring(6,11)));if(q[I])for(var J=q[I],r=0;4>r;r++){var K=f(t.substring(11+5*r,16+5*r));if(0!=K.length){var L=parseInt(K);if(q[L]){for(var M=q[L],N=!1,z=0,O=j.bonds.length;O>z;z++){var P=j.bonds[z];if(P.a1==J&&P.a2==M||P.a1==M&&P.a2==J){N=!0;break}}N||j.bonds.push(new d.Bond(J,M))}}}}else if(b.stringStartsWith(t,"TER"))this.endChain(j,o,n),o=[];else if(b.stringStartsWith(t,"ENDMDL"))break}if(this.endChain(j,o,n),0==j.bonds.size&&(new a.informatics.BondDeducer).deduceCovalentBonds(j,i),this.deduceResidueBonds)for(var r=0,s=p.length;s>r;r++)for(var Q=g.min(s,r+20),z=r+1;Q>z;z++){var R=p[r],S=p[z];R.distance3D(S)<1.1*(e[R.label].covalentRadius+e[S.label].covalentRadius)&&j.bonds.push(new d.Bond(R,S,1))}return j.atoms=j.atoms.concat(p),this.calculateRibbonDistances&&this.calculateDistances(j,p),j},this.endChain=function(a,b,c){if(b.length>0){var e=b[b.length-1];e.cp1||(e.cp1=a.atoms[a.atoms.length-2]),e.cp2||(e.cp2=a.atoms[a.atoms.length-1]);for(var f=0;4>f;f++){var g=new d.Residue(-1);g.cp1=c,g.cp2=b[b.length-1].cp2,b.push(g)}a.chains.push(b)}},this.calculateDistances=function(a,b){for(var c=[],d=0,e=a.atoms.length;e>d;d++){var f=a.atoms[d];f.hetatm&&(f.isWater||c.push(f))}for(var d=0,e=b.length;e>d;d++){var f=b[d];if(f.closestDistance=Number.POSITIVE_INFINITY,0==c.length)f.closestDistance=0;else for(var g=0,h=c.length;h>g;g++)f.closestDistance=Math.min(f.closestDistance,f.distance3D(c[g]))}}};var h=new c.PDBInterpreter;a.readPDB=function(a,b){return h.read(a,b)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,ChemDoodle.ELEMENT,jQuery.trim,Math),function(a,b,c,d,e,f){var g={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},h={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},i={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};c.JCAMPInterpreter=function(){this.convertHZ2PPM=!1;var a=/[\s,]+/;this.read=function(c){this.isBreak=function(a){return null!=g[a]||null!=h[a]||null!=i[a]||" "==a||"-"==a||"+"==a},this.getValue=function(a){var b=a.charAt(0),c=a.substring(1);return parseFloat(null!=g[b]?g[b]+c:null!=h[b]?h[b]+c:b+c)},this.convertToFloatArray=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=parseFloat(a[c]);return b};var e=new d.Spectrum;if(null==c||0==c.length)return e;for(var j,k,l,m,n={},o=c.split(/[\n\r]+/),p=[],q=1,r=1,s=1,t=-1,u=void 0,v=void 0,w=!0,x=!1,y=0,z=o.length;z>y;y++){var A=f(o[y]),B=A.indexOf("$$");-1!=B&&(A=A.substring(0,B));var C=!1;if(0!=p.length&&b.stringStartsWith(o[y],"##")||(0!=p.length&&p.push("\n"),p.push(f(A)),C=!0),!C||o.length==y+1){var D=p.join(""),E=p[0].replace(/^##([^=]*)=.*/,"$1").replace(/[ _\/-]/g,"").toUpperCase();if(w&&D.length<100&&e.metadata.push(D),D=f(D.replace(/^[^=]*=/,"")),p=[A],"DATATABLE"==E){var F=D.substring(0,D.indexOf("\n")).split(/[ ,;\t]+/);var1=0,var2=1,n.first&&(k=n.first[var1],l=n.first[var2]),n.last&&(j=n.last[var1],yLast=n.last[var2]),n.vardim&&(m=n.vardim[var1]),n.factor&&(q=n.factor[var1],r=n.factor[var2]),n.units&&(e.xUnit=n.units[var1],e.yUnit=n.units[var2]),n.units&&(t=(j-k)/(m-1)),this.convertHZ2PPM&&"HZ"==e.xUnit.toUpperCase()&&(e.xUnit="PPM",x=!0),F[1]&&"PEAKS"==F[1]&&(E="PEAKTABLE"),F[1]&&"XYDATA"==F[1]&&(E="XYDATA")}if("TITLE"==E)e.title=D;else if("XUNITS"==E)e.xUnit=D,this.convertHZ2PPM&&"HZ"==e.xUnit.toUpperCase()&&(e.xUnit="PPM",x=!0);else if("YUNITS"==E)e.yUnit=D;else if("XYPAIRS"==E);else if("FIRSTX"==E)k=parseFloat(D);else if("LASTX"==E)j=parseFloat(D);else if("FIRSTY"==E)l=parseFloat(D);else if("NPOINTS"==E)m=parseFloat(D);else if("XFACTOR"==E)q=parseFloat(D);else if("YFACTOR"==E)r=parseFloat(D);else if("DELTAX"==E)t=parseFloat(D);else if(".OBSERVEFREQUENCY"==E)this.convertHZ2PPM&&(s=parseFloat(D));else if("$OFFSET"==E)this.convertHZ2PPM&&(u=0,v=parseFloat(D));else if("$REFERENCEPOINT"==E);else if(".SHIFTREFERENCE"==E){if(this.convertHZ2PPM){var G=D.replace(/[()]/g,"").split(",");u=parseInt(f(G[2])),v=parseFloat(f(G[3]))}}else{if("XYDATA"==E){x||(s=1),w=!1;for(var H=D.split("\n"),I=(j-k)/(m-1),I=t,J=k-I,K=l,L=void 0,M=1,N=H.length;N>M;M++){for(var O=[],P=f(H[M]),p=[],Q=!1,R=0,S=P.length;S>R;R++)this.isBreak(P.charAt(R))?(p.length>0&&(1!=p.length||" "!=p[0])&&O.push(p.join("")),p=[P.charAt(R)]):"|"==P.charAt(R)?Q=!0:p.push(P.charAt(R));O.push(p.join(""));for(var R=(parseFloat(O[0]),1),S=O.length;S>R;R++){var T=O[R];if(1!=R||!L&&0!=L)if(null!=i[T.charAt(0)]){var U=parseInt(i[T.charAt(0)]+T.substring(1))-1;J+=I*U,L&&(K+=L*U),e.data.push(new d.Point(J/s,K*r))}else null!=h[T.charAt(0)]?(J+=I,L=this.getValue(T),K+=L,e.data.push(new d.Point(J/s,K*r))):(J+=I,L=void 0,K=this.getValue(T),e.data.push(new d.Point(J/s,K*r)));else;}}if(u||0==u){u>=e.data.length&&(u=e.data.length-1);for(var V=v-e.data[u].x,y=0,z=e.data.length;z>y;y++)e.data[y].x+=V}break}if("PEAKTABLE"==E){w=!1,e.continuous=!1;for(var H=D.split("\n"),M=1,N=H.length;N>M;M++)for(var W=H[M].split(a),R=0,S=W.length;S>R+1;R+=2)e.data.push(new d.Point(parseFloat(f(W[R])),parseFloat(f(W[R+1]))));break}if("VARNAME"==E){var G=D.split(/[, \t]+/);n.varname=G}else if("SYMBOL"==E){var G=D.split(/[, \t]+/);n.symbol=G}else if("VARTYPE"==E){var G=D.split(/[, \t]+/);n.vartype=G}else if("VARFORM"==E){var G=D.split(/[, \t]+/);n.varform=G}else if("VARDIM"==E){var G=this.convertToFloatArray(D.split(/[, \t]+/));n.vardim=G}else if("UNITS"==E){var G=D.split(/[, \t]+/);n.units=G}else if("FACTOR"==E){var G=this.convertToFloatArray(D.split(/[, \t]+/));n.factor=G}else if("FIRST"==E){var G=this.convertToFloatArray(D.split(/[, \t]+/));n.first=G}else if("LAST"==E){var G=this.convertToFloatArray(D.split(/[, \t]+/));n.last=G}else if("MIN"==E){var G=this.convertToFloatArray(D.split(/[, \t]+/));n.min=G}else if("MAX"==E){var G=this.convertToFloatArray(D.split(/[, \t]+/));n.max=G}}}}return e.setup(),e}};var j=new c.JCAMPInterpreter;j.convertHZ2PPM=!0,a.readJCAMP=function(a){return j.read(a)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,jQuery,jQuery.trim),function(a,b,c){a.fromJSONChains=function(a){for(var c=[],d=0,e=a.cs.length;e>d;d++){for(var f=a.cs[d],g=[],h=0,i=f.length;i>h;h++){var j=f[h],k=new b.Residue;k.name=j.n,k.cp1=new b.Atom("",j.x1,j.y1,j.z1),k.cp2=new b.Atom("",j.x2,j.y2,j.z2),j.x3&&(k.cp3=new b.Atom("",j.x3,j.y3,j.z3),k.cp4=new b.Atom("",j.x4,j.y4,j.z4),k.cp5=new b.Atom("",j.x5,j.y5,j.z5)),k.helix=j.h,k.sheet=j.s,k.arrow=j.a,g.push(k)}c.push(g)}return c},a.fromJSONPDB=function(b){var c=a.fromJSONDummy(b.mol);return c.findRings=!1,c.fromJSON=!0,c.chains=a.fromJSONChains(b.ribbons),c},a.fromJSONDummy=function(a){for(var c=new b.Molecule,d=0,e=a.a.length;e>d;d++){var f=a.a[d],g=new b.Atom(f.l?f.l:"C",f.x,f.y);f.z&&(g.z=f.z),f.c&&(g.charge=f.c),f.m&&(g.mass=f.m),void 0!=f.p_h&&(g.hetatm=f.p_h),void 0!=f.p_w&&(g.isWater=f.p_w),void 0!=f.p_d&&(g.closestDistance=f.p_d),c.atoms.push(g)}for(var d=0,e=a.b.length;e>d;d++){var f=a.b[d],h=new b.Bond(c.atoms[f.b],c.atoms[f.e],f.o?f.o:1);f.s&&(h.stereo=f.s),c.bonds.push(h)}return c},a.toJSONDummy=function(a){for(var d={a:[],b:[]},e=0,f=a.atoms.length;f>e;e++){var g=a.atoms[e];d.a[e]={x:g.x,y:g.y},"C"!=g.label&&(d.a[e].l=g.label),0!=g.z&&(d.a[e].z=g.z),0!=g.charge&&(d.a[e].c=g.charge),-1!=g.mass&&(d.a[e].m=g.mass)}for(var e=0,f=a.bonds.length;f>e;e++){var h=a.bonds[e];d.b[e]={b:c(h.a1,a.atoms),e:c(h.a2,a.atoms)},1!=h.bondOrder&&(d.b[e].o=h.bondOrder),h.stereo!=b.Bond.STEREO_NONE&&(d.b[e].s=h.stereo)}return d}}(ChemDoodle.io,ChemDoodle.structures,jQuery.inArray),function(a,b,c,d,e,f){d.XYZInterpreter=function(){this.deduceCovalentBonds=!0,this.read=function(b){var d=new e.Molecule;if(null==b||0==b.length)return d;for(var g=b.split("\n"),h=parseInt(f(g[0])),i=0;h>i;i++){var j=g[i+2],k=j.split(/\s+/g);d.atoms[i]=new e.Atom(isNaN(k[0])?k[0]:c[parseInt(k[0])-1],parseFloat(k[1]),parseFloat(k[2]),parseFloat(k[3]))}return this.deduceCovalentBonds&&(new a.informatics.BondDeducer).deduceCovalentBonds(d,1),d}};var g=new d.XYZInterpreter;a.readXYZ=function(a){return g.read(a)}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.SYMBOLS,ChemDoodle.io,ChemDoodle.structures,jQuery.trim),ChemDoodle.monitor=function(a,b,c){var d={};return d.CANVAS_DRAGGING=null,d.CANVAS_OVER=null,d.ALT=!1,d.SHIFT=!1,d.META=!1,a.supports_touch()||b(c).ready(function(){b(c).mousemove(function(a){null!=d.CANVAS_DRAGGING&&d.CANVAS_DRAGGING.drag&&(d.CANVAS_DRAGGING.prehandleEvent(a),d.CANVAS_DRAGGING.drag(a))}),b(c).mouseup(function(a){null!=d.CANVAS_DRAGGING&&d.CANVAS_DRAGGING!=d.CANVAS_OVER&&d.CANVAS_DRAGGING.mouseup&&(d.CANVAS_DRAGGING.prehandleEvent(a),d.CANVAS_DRAGGING.mouseup(a)),d.CANVAS_DRAGGING=null}),b(c).keydown(function(a){d.SHIFT=a.shiftKey,d.ALT=a.altKey,d.META=a.metaKey;var b=d.CANVAS_OVER;null!=d.CANVAS_DRAGGING&&(b=d.CANVAS_DRAGGING),null!=b&&b.keydown&&(b.prehandleEvent(a),b.keydown(a))}),b(c).keypress(function(a){var b=d.CANVAS_OVER;null!=d.CANVAS_DRAGGING&&(b=d.CANVAS_DRAGGING),null!=b&&b.keypress&&(b.prehandleEvent(a),b.keypress(a))}),b(c).keyup(function(a){d.SHIFT=a.shiftKey,d.ALT=a.altKey,d.META=a.metaKey;var b=d.CANVAS_OVER;null!=d.CANVAS_DRAGGING&&(b=d.CANVAS_DRAGGING),null!=b&&b.keyup&&(b.prehandleEvent(a),b.keyup(a))})}),d}(ChemDoodle.featureDetection,jQuery,document),function(a,b,c,d,e,f,g,h,i){a._Canvas=function(){return this.molecule=null,this.emptyMessage=null,this.image=null,!0},a._Canvas.prototype.repaint=function(){var a=h.getElementById(this.id);if(this._domcanvas=a,a&&a.getContext){var b=a.getContext("2d"),c=i.devicePixelRatio?i.devicePixelRatio:1;1!=c&&(a.width=this.width*c,a.height=this.height*c,b.scale(c,c)),null==this.image?a.width=a.width:b.drawImage(this.image,0,0),this.innerRepaint?this.innerRepaint(b):null!=this.molecule&&this.molecule.atoms.length>0?(b.save(),b.translate(this.width/2,this.height/2),b.rotate(this.specs.rotateAngle),b.scale(this.specs.scale,this.specs.scale),b.translate(-this.width/2,-this.height/2),this.molecule.check(!0),this.molecule.draw(b,this.specs),b.restore()):null!=this.emptyMessage&&(b.fillStyle="#737683",b.textAlign="center",b.textBaseline="middle",b.font="18px Helvetica, Verdana, Arial, Sans-serif",b.fillText(this.emptyMessage,this.width/2,this.height/2)),this.drawChildExtras&&this.drawChildExtras(b),this._CIrepaintCanvas=this._CIrepaintCanvas||$.Callbacks(),this._CIrepaintCanvas.fireWith(this)}this.onRepaint&&this.onRepaint.call(this)},a._Canvas.prototype.CIOnRepaint=function(a){this._CIrepaintCanvas=this._CIrepaintCanvas||$.Callbacks(),this._CIrepaintCanvas.add(a)},a._Canvas.prototype.CIOnMouseMove=function(a){this._CIOnMouseMove=this._CIOnMouseMove||$.Callbacks(),this._CIOnMouseMove.add(a)},a._Canvas.prototype.resize=function(a,b){var c=e("#"+this.id);c.attr({width:a,height:b}),c.css("width",a),c.css("height",b),this.width=a,this.height=b,this instanceof ChemDoodle._Canvas3D?(this.gl.viewport(0,0,a,b),this.setupScene()):this.molecule&&(this.center(),this.molecule.check()),this.repaint()},a._Canvas.prototype.setBackgroundImage=function(a){this.image=new Image;var b=this;this.image.onload=function(){b.repaint()},this.image.src=a},a._Canvas.prototype.loadMolecule=function(a){this.molecule=a,this.center(),this instanceof ChemDoodle._Canvas3D||this.molecule.check(),this.afterLoadMolecule&&this.afterLoadMolecule(),this.repaint()},a._Canvas.prototype.center=function(){var a=this.molecule.getCenter3D(),b=new d.Atom("C",this.width/2,this.height/2,0);b.sub3D(a);for(var c=0,e=this.molecule.atoms.length;e>c;c++)this.molecule.atoms[c].add3D(b);var f=this.molecule.getDimension();this.specs.scale=1,(f.x>this.width||f.y>this.height)&&(this.specs.scale=.85*g.min(this.width/f.x,this.height/f.y))},a._Canvas.prototype.create=function(g,i,j){if(this.id=g,this.width=i,this.height=j,h.getElementById(g)){var k=e("#"+g);i?k.attr("width",i):this.width=k.attr("width"),j?k.attr("height",j):this.height=k.attr("height")}else!a.featureDetection.supports_canvas_text()&&f.msie&&f.version>="6";var l=e("#"+g);l.css("width",this.width),l.css("height",this.height),this.specs=new d.VisualSpecifications;var m=this,n=m;b.supports_touch()?(l.bind("touchstart",function(a){var b=(new Date).getTime();m.lastTouch&&1==a.originalEvent.touches.length&&b-m.lastTouch<500?m.dbltap?(m.prehandleEvent(a),m.dbltap(a)):m.dblclick?(m.prehandleEvent(a),m.dblclick(a)):m.touchstart?(m.prehandleEvent(a),m.touchstart(a)):m.mousedown&&(m.prehandleEvent(a),m.mousedown(a)):m.touchstart?(m.prehandleEvent(a),m.touchstart(a),this.hold&&clearTimeout(this.hold),this.touchhold&&(this.hold=setTimeout(function(){m.touchhold(a)
},1e3))):m.mousedown&&(m.prehandleEvent(a),m.mousedown(a)),m.lastTouch=b}),l.bind("touchmove",function(a){if(null!=this.hold&&(clearTimeout(this.hold),this.hold=null),a.originalEvent.touches.length>1&&m.multitouchmove){var b=a.originalEvent.touches.length;m.prehandleEvent(a);for(var c=new d.Point(-a.offset.left*b,-a.offset.top*b),e=0;b>e;e++)c.x+=a.originalEvent.changedTouches[e].pageX,c.y+=a.originalEvent.changedTouches[e].pageY;c.x/=b,c.y/=b,a.p=c,m.multitouchmove(a,b)}else m.touchmove?(m.prehandleEvent(a),m.touchmove(a)):m.drag&&(m.prehandleEvent(a),m.drag(a))}),l.bind("touchend",function(a){null!=this.hold&&(clearTimeout(this.hold),this.hold=null),m.touchend?(m.prehandleEvent(a),m.touchend(a)):m.mouseup&&(m.prehandleEvent(a),m.mouseup(a)),(new Date).getTime()-m.lastTouch<250&&(m.tap?(m.prehandleEvent(a),m.tap(a)):m.click&&(m.prehandleEvent(a),m.click(a)))}),l.bind("gesturestart",function(a){m.gesturestart&&(m.prehandleEvent(a),m.gesturestart(a))}),l.bind("gesturechange",function(a){m.gesturechange&&(m.prehandleEvent(a),m.gesturechange(a))}),l.bind("gestureend",function(a){m.gestureend&&(m.prehandleEvent(a),m.gestureend(a))})):(l.click(function(a){switch(a.which){case 1:m.click&&(m.prehandleEvent(a),m.click(a));break;case 2:m.middleclick&&(m.prehandleEvent(a),m.middleclick(a));break;case 3:m.rightclick&&(m.prehandleEvent(a),m.rightclick(a))}}),l.dblclick(function(a){m.dblclick&&(m.prehandleEvent(a),m.dblclick(a))}),l.mousedown(function(a){switch(a.which){case 1:c.CANVAS_DRAGGING=m,m.mousedown&&(m.prehandleEvent(a),m.mousedown(a));break;case 2:m.middlemousedown&&(m.prehandleEvent(a),m.middlemousedown(a));break;case 3:m.rightmousedown&&(m.prehandleEvent(a),m.rightmousedown(a))}}),l.mousemove(function(a){null==c.CANVAS_DRAGGING&&m.mousemove&&(m.prehandleEvent(a),m.mousemove(a)),n._CIOnMouseMove=n._CIOnMouseMove||$.Callbacks(),n._CIOnMouseMove.fireWith(n,[a])}),l.mouseout(function(a){c.CANVAS_OVER=null,m.mouseout&&(m.prehandleEvent(a),m.mouseout(a))}),l.mouseover(function(a){c.CANVAS_OVER=m,m.mouseover&&(m.prehandleEvent(a),m.mouseover(a))}),l.mouseup(function(a){switch(a.which){case 1:m.mouseup&&(m.prehandleEvent(a),m.mouseup(a));break;case 2:m.middlemouseup&&(m.prehandleEvent(a),m.middlemouseup(a));break;case 3:m.rightmouseup&&(m.prehandleEvent(a),m.rightmouseup(a))}}),l.mousewheel(function(a,b){m.mousewheel&&(m.prehandleEvent(a),m.mousewheel(a,b))})),this.subCreate&&this.subCreate()},a._Canvas.prototype.getMolecule=function(){return this.molecule},a._Canvas.prototype.prehandleEvent=function(a){a.originalEvent.changedTouches&&(a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY),a.preventDefault(),a.offset=e("#"+this.id).offset(),a.p=new d.Point(a.pageX-a.offset.left,a.pageY-a.offset.top)}}(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.monitor,ChemDoodle.structures,jQuery,jQuery.browser,Math,document,window),function(a){a._AnimatorCanvas=function(a,b,c){return a&&this.create(a,b,c),this.timeout=33,!0},a._AnimatorCanvas.prototype=new a._Canvas,a._AnimatorCanvas.prototype.startAnimation=function(){this.stopAnimation(),this.lastTime=(new Date).getTime();var a=this;this.nextFrame&&(this.handle=setInterval(function(){var b=(new Date).getTime();a.nextFrame(b-a.lastTime),a.repaint(),a.lastTime=b},this.timeout))},a._AnimatorCanvas.prototype.stopAnimation=function(){null!=this.handle&&(clearInterval(this.handle),this.handle=null)},a._AnimatorCanvas.prototype.isRunning=function(){return null!=this.handle}}(ChemDoodle),function(a){a.FileCanvas=function(a,b,c,d){return a&&this.create(a,b,c),form='<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+d+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+a+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+a+"', "+a+')"></iframe>',this.emptyMessage="Click below to load file",this.repaint(),!0},a.FileCanvas.prototype=new a._Canvas}(ChemDoodle,document),function(a){a.HyperlinkCanvas=function(a,b,c,d,e,f){return a&&this.create(a,b,c),this.urlOrFunction=d,this.color=e?e:"blue",this.size=f?f:2,this.openInNewWindow=!0,this.hoverImage=null,this.e=null,!0},a.HyperlinkCanvas.prototype=new a._Canvas,a.HyperlinkCanvas.prototype.drawChildExtras=function(a){null!=this.e&&(null==this.hoverImage?(a.strokeStyle=this.color,a.lineWidth=2*this.size,a.strokeRect(0,0,this.width,this.height)):a.drawImage(this.hoverImage,0,0))},a.HyperlinkCanvas.prototype.setHoverImage=function(a){this.hoverImage=new Image,this.hoverImage.src=a},a.HyperlinkCanvas.prototype.click=function(){this.e=null,this.repaint(),this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction},a.HyperlinkCanvas.prototype.mouseout=function(){this.e=null,this.repaint()},a.HyperlinkCanvas.prototype.mouseover=function(a){this.e=a,this.repaint()}}(ChemDoodle),function(a,b,c){a.MolGrabberCanvas=function(a,b,d){a&&this.create(a,b,d);var e=[];e.push('<br><input type="text" id="'),e.push(a),e.push('_query" size="32" value="" />'),e.push("<br><nobr>"),e.push('<select id="'),e.push(a),e.push('_select">'),e.push('<option value="chemexper">ChemExper'),e.push('<option value="chemspider">ChemSpider'),e.push('<option value="pubchem" selected>PubChem'),e.push("</select>"),e.push('<button id="'),e.push(a),e.push('_submit">Show Molecule</button>'),e.push("</nobr>");var f=this;return c("#"+a+"_submit").click(function(){f.search()}),c("#"+a+"_query").keypress(function(a){13==a.which&&f.search()}),this.emptyMessage="Enter search term below",this.repaint(),!0},a.MolGrabberCanvas.prototype=new a._Canvas,a.MolGrabberCanvas.prototype.setSearchTerm=function(a){c("#"+this.id+"_query").val(a),this.search()},a.MolGrabberCanvas.prototype.search=function(){this.emptyMessage="Searching...",this.molecule=null,this.repaint();var a=this;b.getMoleculeFromDatabase(c("#"+this.id+"_select").val(),c("#"+this.id+"_query").val(),function(b){a.loadMolecule(b)})}}(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document),function(a,b,c){var d=[],e=[1,0,0],f=[0,1,0],g=[0,0,1];a.RotatorCanvas=function(a,c,d,e){a&&this.create(a,c,d),this.rotate3D=e;var f=b.PI/15;return this.xIncrement=f,this.yIncrement=f,this.zIncrement=f,!0},a.RotatorCanvas.prototype=new a._AnimatorCanvas,a.RotatorCanvas.prototype.nextFrame=function(a){if(null==this.molecule)return void this.stopAnimation();var b=a/1e3;if(this.rotate3D){c.identity(d),c.rotate(d,this.xIncrement*b,e),c.rotate(d,this.yIncrement*b,f),c.rotate(d,this.zIncrement*b,g);for(var h=0,i=this.molecule.atoms.length;i>h;h++){var j=this.molecule.atoms[h],k=[j.x-this.width/2,j.y-this.height/2,j.z];c.multiplyVec3(d,k),j.x=k[0]+this.width/2,j.y=k[1]+this.height/2,j.z=k[2]}for(var h=0,i=this.molecule.rings.length;i>h;h++)this.molecule.rings[h].center=this.molecule.rings[h].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&this.molecule.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&this.molecule.sortBondsByZ()}else this.specs.rotateAngle+=this.zIncrement*b},a.RotatorCanvas.prototype.dblclick=function(){this.isRunning()?this.stopAnimation():this.startAnimation()}}(ChemDoodle,Math,mat4),function(a){a.SlideshowCanvas=function(a,b,c){return a&&this.create(a,b,c),this.molecules=[],this.curIndex=0,this.timeout=5e3,this.alpha=0,this.innerHandle=null,this.phase=0,!0},a.SlideshowCanvas.prototype=new a._AnimatorCanvas,a.SlideshowCanvas.prototype.drawChildExtras=function(a){a.fillStyle="rgba("+parseInt(this.specs.backgroundColor.substring(1,3),16)+", "+parseInt(this.specs.backgroundColor.substring(3,5),16)+", "+parseInt(this.specs.backgroundColor.substring(5,7),16)+", "+this.alpha+")",a.fillRect(0,0,this.width,this.height)},a.SlideshowCanvas.prototype.nextFrame=function(){if(0==this.molecules.length)return void this.stopAnimation();this.phase=0;var a=this,b=1;this.innerHandle=setInterval(function(){a.alpha=b/15,a.repaint(),15==b&&a.breakInnerHandle(),b++},33)},a.SlideshowCanvas.prototype.breakInnerHandle=function(){if(null!=this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=null),0==this.phase){this.curIndex++,this.curIndex>this.molecules.length-1&&(this.curIndex=0),this.alpha=1,this.loadMolecule(this.molecules[this.curIndex]),this.phase=1;var a=this,b=1;this.innerHandle=setInterval(function(){a.alpha=(15-b)/15,a.repaint(),15==b&&a.breakInnerHandle(),b++},33)}else 1==this.phase&&(this.alpha=0,this.repaint())},a.SlideshowCanvas.prototype.addMolecule=function(a){0==this.molecules.length&&this.loadMolecule(a),this.molecules.push(a)}}(ChemDoodle),function(a,b,c,d,e){a.TransformCanvas=function(a,b,c,d){return a&&this.create(a,b,c),this.lastPoint=null,this.rotate3D=d,this.rotationMultMod=1.3,this.lastPinchScale=1,this.lastGestureRotate=0,!0},a.TransformCanvas.prototype=new a._Canvas,a.TransformCanvas.prototype.mousedown=function(a){this.lastPoint=a.p},a.TransformCanvas.prototype.dblclick=function(){var a=new c.Point(this.width/2,this.height/2);a.sub(this.molecule.getCenter());for(var b=0,d=this.molecule.atoms.length;d>b;b++)this.molecule.atoms[b].add(a);this.molecule.check(),this.repaint()},a.TransformCanvas.prototype.drag=function(a){if(!this.lastPoint.multi)if(b.ALT){var f=new c.Point(a.p.x,a.p.y);f.sub(this.lastPoint);for(var g=0,h=this.molecule.atoms.length;h>g;g++)this.molecule.atoms[g].add(f);this.lastPoint=a.p,this.molecule.check(),this.repaint()}else if(1==this.rotate3D){var i=d.max(this.width/4,this.height/4),j=a.p.x-this.lastPoint.x,k=a.p.y-this.lastPoint.y,l=j/i*this.rotationMultMod,m=-k/i*this.rotationMultMod,n=[];e.identity(n),e.rotate(n,m,[1,0,0]),e.rotate(n,l,[0,1,0]);for(var g=0,h=this.molecule.atoms.length;h>g;g++){var o=this.molecule.atoms[g],p=[o.x-this.width/2,o.y-this.height/2,o.z];e.multiplyVec3(n,p),o.x=p[0]+this.width/2,o.y=p[1]+this.height/2,o.z=p[2]}for(var g=0,h=this.molecule.rings.length;h>g;g++)this.molecule.rings[g].center=this.molecule.rings[g].getCenter();this.lastPoint=a.p,this.specs.atoms_display&&this.specs.atoms_circles_2D&&this.molecule.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&this.molecule.sortBondsByZ(),this.repaint()}else{var q=new c.Point(this.width/2,this.height/2),r=q.angle(this.lastPoint),s=q.angle(a.p);this.specs.rotateAngle-=s-r,this.lastPoint=a.p,this.repaint()}},a.TransformCanvas.prototype.mousewheel=function(a,b){this.specs.scale+=b/10,this.specs.scale<.01&&(this.specs.scale=.01),this.repaint()},a.TransformCanvas.prototype.multitouchmove=function(a,b){if(2==b)if(this.lastPoint.multi){var d=new c.Point(a.p.x,a.p.y);d.sub(this.lastPoint);for(var e=0,f=this.molecule.atoms.length;f>e;e++)this.molecule.atoms[e].add(d);this.lastPoint=a.p,this.lastPoint.multi=!0,this.molecule.check(),this.repaint()}else this.lastPoint=a.p,this.lastPoint.multi=!0},a.TransformCanvas.prototype.gesturechange=function(a){if(a.originalEvent.scale-this.lastPinchScale!=0&&(this.specs.scale*=a.originalEvent.scale/this.lastPinchScale,this.specs.scale<.01&&(this.specs.scale=.01),this.lastPinchScale=a.originalEvent.scale),this.lastGestureRotate-a.originalEvent.rotation!=0){for(var b=(this.lastGestureRotate-a.originalEvent.rotation)/180*d.PI,e=new c.Point(this.width/2,this.height/2),f=0,g=this.molecule.atoms.length;g>f;f++){var h=e.distance(this.molecule.atoms[f]),i=e.angle(this.molecule.atoms[f])+b;this.molecule.atoms[f].x=e.x+h*d.cos(i),this.molecule.atoms[f].y=e.y-h*d.sin(i)}this.lastGestureRotate=a.originalEvent.rotation,this.molecule.check()}this.repaint()},a.TransformCanvas.prototype.gestureend=function(){this.lastPinchScale=1,this.lastGestureRotate=0}}(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,mat4),function(a){a.ViewerCanvas=function(a,b,c){return a&&this.create(a,b,c),!0},a.ViewerCanvas.prototype=new a._Canvas}(ChemDoodle),function(a){a._SpectrumCanvas=function(a,b,c){return a&&this.create(a,b,c),this.spectrum=null,this.emptyMessage="No Spectrum Loaded or Recognized",this.loadMolecule=null,this.getMolecule=null,!0},a._SpectrumCanvas.prototype=new a._Canvas,a._SpectrumCanvas.prototype.innerRepaint=function(a){null!=this.spectrum&&this.spectrum.data.length>0?this.spectrum.draw(a,this.specs,this.width,this.height):null!=this.emptyMessage&&(a.fillStyle="#737683",a.textAlign="center",a.textBaseline="middle",a.font="18px Helvetica, Verdana, Arial, Sans-serif",a.fillText(this.emptyMessage,this.width/2,this.height/2))},a._SpectrumCanvas.prototype.loadSpectrum=function(a){this.spectrum=a,this.repaint()},a._SpectrumCanvas.prototype.getSpectrum=function(){return this.spectrum},a._SpectrumCanvas.prototype.getSpectrumCoordinates=function(a,b){return spectrum.getInternalCoordinates(a,b,this.width,this.height)}}(ChemDoodle,document),function(a){a.ObserverCanvas=function(a,b,c){return a&&this.create(a,b,c),!0},a.ObserverCanvas.prototype=new a._SpectrumCanvas}(ChemDoodle),function(a,b,c){a.PerspectiveCanvas=function(a,b,c){return a&&this.create(a,b,c),this.dragRange=null,this.rescaleYAxisOnZoom=!0,this.lastPinchScale=1,!0},a.PerspectiveCanvas.prototype=new a._SpectrumCanvas,a.PerspectiveCanvas.prototype.setBoundaries=function(a,b){this.spectrum.minX=a,this.spectrum.maxX=b,this.repaint()},a.PerspectiveCanvas.prototype.mousedown=function(b){this.dragRange=new a.structures.Point(b.p.x,b.p.x)},a.PerspectiveCanvas.prototype.mouseup=function(a){if(null!=this.dragRange&&this.dragRange.x!=this.dragRange.y){if(!this.dragRange.multi){var b=this.spectrum.zoom(this.dragRange.x,a.p.x,this.width,this.rescaleYAxisOnZoom);this.rescaleYAxisOnZoom&&(this.specs.scale=b)}this.dragRange=null,this.repaint(),this.onZoomChange&&this.onZoomChange.call(this,this.spectrum.minX,this.spectrum.maxX)}},a.PerspectiveCanvas.prototype.drag=function(a){null!=this.dragRange&&(this.dragRange.multi?this.dragRange=null:b.SHIFT?(this.spectrum.translate(a.p.x-this.dragRange.x,this.width),this.dragRange.x=a.p.x,this.dragRange.y=a.p.x):this.dragRange.y=a.p.x,this.repaint())},a.PerspectiveCanvas.prototype.drawChildExtras=function(a){if(null!=this.dragRange){var b=c.min(this.dragRange.x,this.dragRange.y),d=c.max(this.dragRange.x,this.dragRange.y);a.strokeStyle="gray",a.lineStyle=1,a.beginPath(),a.moveTo(b,this.height/2);for(var e=b;d>=e;e++)5>e%10?a.lineTo(e,c.round(this.height/2)):a.moveTo(e,c.round(this.height/2));a.stroke()}},a.PerspectiveCanvas.prototype.mousewheel=function(a,b){this.specs.scale+=b/10,this.specs.scale<.01&&(this.specs.scale=.01),this.repaint()},a.PerspectiveCanvas.prototype.dblclick=function(){this.spectrum.setup(),this.specs.scale=1,this.repaint(),this.onZoomChange&&this.onZoomChange.call(this,this.spectrum.minX,this.spectrum.maxX)},a.PerspectiveCanvas.prototype.multitouchmove=function(b,c){2==c&&(null!=this.dragRange&&this.dragRange.multi?(this.spectrum.translate(b.p.x-this.dragRange.x,this.width),this.dragRange.x=b.p.x,this.dragRange.y=b.p.x,this.repaint()):(this.dragRange=new a.structures.Point(b.p.x,b.p.x),this.dragRange.multi=!0))},a.PerspectiveCanvas.prototype.gesturechange=function(a){this.specs.scale*=a.originalEvent.scale/this.lastPinchScale,this.specs.scale<.01&&(this.specs.scale=.01),this.lastPinchScale=a.originalEvent.scale,this.repaint()},a.PerspectiveCanvas.prototype.gestureend=function(){this.lastPinchScale=1}}(ChemDoodle,ChemDoodle.monitor,Math),function(a){a.OverlayCanvas=function(a,b,c){return a&&this.create(a,b,c),this.overlaySpectra=[],!0},a.OverlayCanvas.prototype=new a.PerspectiveCanvas,a.OverlayCanvas.prototype.superRepaint=a.PerspectiveCanvas.prototype.innerRepaint,a.OverlayCanvas.prototype.innerRepaint=function(a){if(this.superRepaint(a),null!=this.spectrum&&this.spectrum.data.length>0)for(var b=0,c=this.overlaySpectra.length;c>b;b++){var d=this.overlaySpectra[b];null!=d&&d.data.length>0&&(d.minX=this.spectrum.minX,d.maxX=this.spectrum.maxX,d.drawPlot(a,this.specs,this.width,this.height,this.spectrum.memory.offsetTop,this.spectrum.memory.offsetLeft,this.spectrum.memory.offsetBottom))}},a.OverlayCanvas.prototype.addSpectrum=function(a){return null==this.spectrum?(this.spectrum=a,-1):(this.overlaySpectra.push(a),this.overlaySpectra.length-1)},a.OverlayCanvas.prototype.getXMaxBound=function(){for(var a=this.spectrum.minX,b=this.spectrum.maxX,c=this.spectrum.minY,d=this.spectrum.maxY,e=0,f=this.overlaySpectra.length;f>e;e++)this.overlaySpectra[e].setup(),a=Math.min(a,this.overlaySpectra[e].minX),b=Math.max(b,this.overlaySpectra[e].maxX),c=Math.min(c,this.overlaySpectra[e].minY),d=Math.max(d,this.overlaySpectra[e].maxY);this.spectrum.minX=a,this.spectrum.maxX=b,this.spectrum.minY=c,this.spectrum.maxY=d},a.OverlayCanvas.prototype.dblclick=function(){this.spectrum.setup(),this.getXMaxBound(),this.specs.scale=1,this.onZoomChange&&this.onZoomChange.call(this,this.spectrum.minX,this.spectrum.maxX),this.repaint()},a.OverlayCanvas.prototype.mouseup=function(a){if(null!=this.dragRange&&this.dragRange.x!=this.dragRange.y){if(!this.dragRange.multi){for(var b=this.spectrum.zoom(this.dragRange.x,a.p.x,this.width,this.rescaleYAxisOnZoom),c=0,d=this.overlaySpectra.length;d>c;c++)b=Math.min(b,this.overlaySpectra[c].getScale(this.spectrum.minX,this.spectrum.maxX));this.rescaleYAxisOnZoom&&(this.specs.scale=b)}this.dragRange=null,this.repaint(),this.onZoomChange&&this.onZoomChange.call(this,this.spectrum.minX,this.spectrum.maxX)}}}(ChemDoodle),function(a,b){a.SeekerCanvas=function(a,b,c,d){return a&&this.create(a,b,c),this.seekType=d,this.p=null,!0},a.SeekerCanvas.prototype=new a._SpectrumCanvas,a.SeekerCanvas.prototype.superRepaint=a.SeekerCanvas.prototype.innerRepaint,a.SeekerCanvas.prototype.innerRepaint=function(c){if(this.superRepaint(c),null!=this.spectrum&&this.spectrum.data.length>0&&null!=this.p){var d=null,e=null;if(this.seekType==a.SeekerCanvas.SEEK_POINTER)d=this.p,e=this.spectrum.getInternalCoordinates(d.x,d.y);else if(this.seekType==a.SeekerCanvas.SEEK_PLOT||this.seekType==a.SeekerCanvas.SEEK_PEAK){if(e=this.seekType==a.SeekerCanvas.SEEK_PLOT?this.spectrum.getClosestPlotInternalCoordinates(this.p.x):this.spectrum.getClosestPeakInternalCoordinates(this.p.x),null==e)return;d={x:this.spectrum.getTransformedX(e.x,this.specs,this.width,this.spectrum.memory.offsetLeft),y:this.spectrum.getTransformedY(e.y/100,this.specs,this.height,this.spectrum.memory.offsetBottom,this.spectrum.memory.offsetTop)}}c.fillStyle="white",c.strokeStyle=this.specs.plots_color,c.lineWidth=this.specs.plots_width,c.beginPath(),c.arc(d.x,d.y,3,0,2*b.PI,!1),c.fill(),c.stroke(),c.font=this.specs.getFontString(this.specs.text_font_size,this.specs.text_font_families),c.textAlign="left",c.textBaseline="bottom";var f="x:"+e.x.toFixed(3)+", y:"+e.y.toFixed(3),g=d.x+3,h=c.measureText(f).width;g+h>this.width-2&&(g-=6+h);var i=d.y;i-this.specs.text_font_size-2<0&&(i+=this.specs.text_font_size),c.fillRect(g,i-this.specs.text_font_size,h,this.specs.text_font_size),c.fillStyle="black",c.fillText(f,g,i)}},a.SeekerCanvas.prototype.mouseout=function(){this.p=null,this.repaint()},a.SeekerCanvas.prototype.mousemove=function(a){this.p={x:a.p.x-2,y:a.p.y-3},this.repaint()},a.SeekerCanvas.prototype.touchstart=function(a){this.mousemove(a)},a.SeekerCanvas.prototype.touchmove=function(a){this.mousemove(a)},a.SeekerCanvas.prototype.touchend=function(a){this.mouseout(a)},a.SeekerCanvas.SEEK_POINTER="pointer",a.SeekerCanvas.SEEK_PLOT="plot",a.SeekerCanvas.SEEK_PEAK="peak"}(ChemDoodle,Math),function(a,b,c,d,e,f,g,h,i,j){a._Canvas3D=function(a,b,c){return a&&this.create(a,b,c),this.rotationMatrix=h.identity([]),this.translationMatrix=h.identity([]),this.lastPoint=null,this.emptyMessage="WebGL is Unavailable!",!0},a._Canvas3D.prototype=new a._Canvas,a._Canvas3D.prototype.afterLoadMolecule=function(){var a=this.molecule.getDimension();this.maxDimension=f.max(a.x,a.y),this.translationMatrix=h.translate(h.identity([]),[0,0,-this.maxDimension-10]),this.setupScene()},a._Canvas3D.prototype.setViewDistance=function(a){this.translationMatrix=h.translate(h.identity([]),[0,0,-a])},a._Canvas3D.prototype.repaint=function(){this.gl&&(this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.modelViewMatrix=h.multiply(this.translationMatrix,this.rotationMatrix,[]),this.gl.rotationMatrix=this.rotationMatrix,null!=this.molecule&&this.molecule.render(this.gl,this.specs),this.gl.flush())},a._Canvas3D.prototype.center=function(){for(var a=(g.getElementById(this.id),this.molecule.getCenter3D()),b=0,c=this.molecule.atoms.length;c>b;b++)this.molecule.atoms[b].sub3D(a);if(this.molecule.chains&&this.molecule.fromJSON)for(var b=0,c=this.molecule.chains.length;c>b;b++)for(var d=this.molecule.chains[b],e=0,f=d.length;f>e;e++){var h=d[e];h.cp1.sub3D(a),h.cp2.sub3D(a),h.cp3&&(h.cp3.sub3D(a),h.cp4.sub3D(a),h.cp5.sub3D(a))}},a._Canvas3D.prototype.subCreate=function(){try{var a=g.getElementById(this.id);this.gl=a.getContext("webgl"),this.gl||(this.gl=a.getContext("experimental-webgl"))}catch(b){}this.gl?(this.gl.viewport(0,0,this.width,this.height),this.gl.program=this.gl.createProgram(),this.gl.shader=new d.Shader,this.gl.shader.init(this.gl),this.setupScene()):(this.molecule=null,this.displayMessage())},a._Canvas.prototype.displayMessage=function(){var a=g.getElementById(this.id);if(a.getContext){var b=a.getContext("2d");null!=this.specs.backgroundColor&&(b.fillStyle=this.specs.backgroundColor,b.fillRect(0,0,this.width,this.height)),null!=this.emptyMessage&&(b.fillStyle="#737683",b.textAlign="center",b.textBaseline="middle",b.font="18px Helvetica, Verdana, Arial, Sans-serif",b.fillText(this.emptyMessage,this.width/2,this.height/2))}},a._Canvas3D.prototype.setupScene=function(){if(this.gl){var a=c.getRGB(this.specs.backgroundColor,1);if(this.gl.clearColor(a[0],a[1],a[2],1),this.gl.clearDepth(1),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.sphereBuffer=new d.Sphere(1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D),this.gl.starBuffer=new d.Star,this.gl.cylinderBuffer=new d.Cylinder(1,1,this.specs.bonds_resolution_3D),this.gl.lineBuffer=new d.Line,this.molecule&&this.molecule!=this.previousMolecule&&(this.previousMolecule=this.molecule,this.molecule.unitCellVectors&&(this.molecule.unitCell=new d.UnitCell(this.molecule.unitCellVectors)),this.molecule.chains)){this.molecule.ribbons=[],this.molecule.cartoons=[],this.molecule.tubes=[];for(var g=0,k=this.molecule.chains.length;k>g;g++){var l=this.molecule.chains[g],m=l.length>2&&e[l[2].name]&&"#BEA06E"==e[l[2].name].aminoColor;if(l.length>0&&!l[0].lineSegments){for(var n=0,o=l.length-1;o>n;n++)l[n].setup(l[n+1].cp1,m?1:this.specs.proteins_horizontalResolution);if(!m)for(var n=1,o=l.length-1;o>n;n++)b.vec3AngleFrom(l[n-1].D,l[n].D)>f.PI/2&&(l[n].guidePointsSmall.reverse(),l[n].guidePointsLarge.reverse(),j.scale(l[n].D,-1));for(var n=1,o=l.length-3;o>n;n++)l[n].computeLineSegments(l[n-1],l[n+1],l[n+2],!m,m?this.specs.nucleics_verticalResolution:this.specs.proteins_verticalResolution);l.pop(),l.pop(),l.pop(),l.shift()}var p=c.hsl2rgb(1==k?.5:g/k,1,.5),q="rgb("+p[0]+","+p[1]+","+p[2]+")";if(l.chainColor=q,m){var r=new d.Tube(l,this.specs.nucleics_tubeThickness,this.specs.nucleics_tubeResolution_3D);r.chainColor=q,this.molecule.tubes.push(r)}else{var s={front:new d.Ribbon(l,this.specs.proteins_ribbonThickness,!1),back:new d.Ribbon(l,-this.specs.proteins_ribbonThickness,!1)};s.front.chainColor=q,s.back.chainColor=q;for(var n=0,o=s.front.segments.length;o>n;n++)s.front.segments[n].chainColor=q;for(var n=0,o=s.back.segments.length;o>n;n++)s.back.segments[n].chainColor=q;this.molecule.ribbons.push(s);var t={front:new d.Ribbon(l,this.specs.proteins_ribbonThickness,!0),back:new d.Ribbon(l,-this.specs.proteins_ribbonThickness,!0)};t.front.chainColor=q,t.back.chainColor=q;for(var n=0,o=t.front.segments.length;o>n;n++)t.front.segments[n].chainColor=q;for(var n=0,o=t.back.segments.length;o>n;n++)t.back.segments[n].chainColor=q;for(var n=0,o=t.front.cartoonSegments.length;o>n;n++)t.front.cartoonSegments[n].chainColor=q;for(var n=0,o=t.back.cartoonSegments.length;o>n;n++)t.back.cartoonSegments[n].chainColor=q;this.molecule.cartoons.push(t)}}}this.gl.lighting=new d.Light(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D),this.gl.lighting.lightScene(this.gl),this.gl.material=new d.Material(this.gl);var u=this.width/this.height;this.specs.projectionWidthHeightRatio_3D&&(u=this.specs.projectionWidthHeightRatio_3D),this.gl.projectionMatrix=this.specs.projectionPerspective_3D?h.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,u,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):h.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/u,this.specs.projectionOrthoWidth_3D/2/u,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D);var v=this.gl.getUniformLocation(this.gl.program,"u_projection_matrix");this.gl.uniformMatrix4fv(v,!1,this.gl.projectionMatrix);var w=this.gl.getUniformLocation(this.gl.program,"u_model_view_matrix"),x=this.gl.getUniformLocation(this.gl.program,"u_normal_matrix");this.gl.setMatrixUniforms=function(a){this.uniformMatrix4fv(w,!1,a);var b=i.transpose(h.toInverseMat3(a,[]));this.uniformMatrix3fv(x,!1,b)}}},a._Canvas3D.prototype.mousedown=function(a){this.lastPoint=a.p},a._Canvas3D.prototype.rightmousedown=function(a){this.lastPoint=a.p},a._Canvas3D.prototype.drag=function(b){if(a.monitor.ALT){var c=new d.Point(b.p.x,b.p.y);c.sub(this.lastPoint),h.translate(this.translationMatrix,[c.x/20,-c.y/20,0]),this.lastPoint=b.p,this.repaint()}else{var e=b.p.x-this.lastPoint.x,g=b.p.y-this.lastPoint.y,i=h.rotate(h.identity([]),e*f.PI/180,[0,1,0]);h.rotate(i,g*f.PI/180,[1,0,0]),this.rotationMatrix=h.multiply(i,this.rotationMatrix),this.lastPoint=b.p,this.repaint()}},a._Canvas3D.prototype.mousewheel=function(a,b){var c=b*this.maxDimension/8;this.specs.projectionPerspective_3D?h.translate(this.translationMatrix,[0,0,c]):(this.specs.projectionOrthoWidth_3D-=c,this.setupScene()),this.repaint()}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math,document,mat4,mat3,vec3,window),function(a,b,c){a.MolGrabberCanvas3D=function(a,b,d){a&&this.create(a,b,d);var e=[];e.push('<br><input type="text" id="'),e.push(a),e.push('_query" size="32" value="" />'),e.push("<br><nobr>"),e.push('<select id="'),e.push(a),e.push('_select">'),e.push('<option value="pubchem" selected>PubChem'),e.push("</select>"),e.push('<button id="'),e.push(a),e.push('_submit">Show Molecule</button>'),e.push("</nobr>");var f=this;return c("#"+a+"_submit").click(function(){f.search()}),c("#"+a+"_query").keypress(function(a){13==a.which&&f.search()}),!0},a.MolGrabberCanvas3D.prototype=new a._Canvas3D,a.MolGrabberCanvas3D.prototype.setSearchTerm=function(a){c("#"+this.id+"_query").val(a),this.search()},a.MolGrabberCanvas3D.prototype.search=function(){var a=this;b.getMoleculeFromDatabase(c("#"+this.id+"_select").val(),c("#"+this.id+"_query").val(),function(b){a.loadMolecule(b)},3)}}(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document),function(a,b){a.MovieCanvas3D=function(a,b,c){return a&&this.create(a,b,c),this.timeout=50,this.molecules=[],this.frameNumber=0,this.playMode=2,this.reverse=!1,!0},a.MovieCanvas3D.PLAY_ONCE=0,a.MovieCanvas3D.PLAY_LOOP=1,a.MovieCanvas3D.PLAY_SPRING=2,a.MovieCanvas3D.prototype=new a._Canvas3D,a.MovieCanvas3D.prototype.startAnimation=a._AnimatorCanvas.prototype.startAnimation,a.MovieCanvas3D.prototype.stopAnimation=a._AnimatorCanvas.prototype.stopAnimation,a.MovieCanvas3D.prototype.isRunning=a._AnimatorCanvas.prototype.isRunning,a.MovieCanvas3D.prototype.dblclick=a.RotatorCanvas.prototype.dblclick,a.MovieCanvas3D.prototype.nextFrame=function(){this.molecule=this.molecules[this.frameNumber],2==this.playMode&&this.reverse?(this.frameNumber--,this.frameNumber<0&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.molecules.length&&(2==this.playMode?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0,0==this.playMode&&this.stopAnimation())))},a.MovieCanvas3D.prototype.center=function(){var a=this.molecule.getCenter3D(),c=new b.Atom;c.sub3D(a);for(var d=0,e=this.molecules.length;e>d;d++)for(var f=this.molecules[d],g=0,h=f.atoms.length;h>g;g++)f.atoms[g].add3D(c)}}(ChemDoodle,ChemDoodle.structures),function(a,b,c){var d=[],e=[1,0,0],f=[0,1,0],g=[0,0,1];a.RotatorCanvas3D=function(a,c,d){a&&this.create(a,c,d),this.timeout=33;var e=b.PI/15;return this.xIncrement=e,this.yIncrement=e,this.zIncrement=e,!0},a.RotatorCanvas3D.prototype=new a._Canvas3D,a.RotatorCanvas3D.prototype.startAnimation=a._AnimatorCanvas.prototype.startAnimation,a.RotatorCanvas3D.prototype.stopAnimation=a._AnimatorCanvas.prototype.stopAnimation,a.RotatorCanvas3D.prototype.isRunning=a._AnimatorCanvas.prototype.isRunning,a.RotatorCanvas3D.prototype.dblclick=a.RotatorCanvas.prototype.dblclick,a.RotatorCanvas3D.prototype.mousedown=null,a.RotatorCanvas3D.prototype.rightmousedown=null,a.RotatorCanvas3D.prototype.drag=null,a.RotatorCanvas3D.prototype.mousewheel=null,a.RotatorCanvas3D.prototype.nextFrame=function(a){if(null==this.molecule)return void this.stopAnimation();c.identity(d);var b=a/1e3;c.rotate(d,this.xIncrement*b,e),c.rotate(d,this.yIncrement*b,f),c.rotate(d,this.zIncrement*b,g),c.multiply(this.rotationMatrix,d)}}(ChemDoodle,Math,mat4),function(a){a.TransformCanvas3D=function(a,b,c){return a&&this.create(a,b,c),!0},a.TransformCanvas3D.prototype=new a._Canvas3D}(ChemDoodle),function(a){a.ViewerCanvas3D=function(a,b,c){return a&&this.create(a,b,c),!0},a.ViewerCanvas3D.prototype=new a._Canvas3D,a.ViewerCanvas3D.prototype.mousedown=null,a.ViewerCanvas3D.prototype.rightmousedown=null,a.ViewerCanvas3D.prototype.drag=null,a.ViewerCanvas3D.prototype.mousewheel=null}(ChemDoodle),function(a,b,c){function d(a,b,c,d){this.element=a,this.x=b,this.y=c,this.dimension=d}a.PeriodicTableCanvas=function(a,b){return this.padding=5,a&&this.create(a,18*b+2*this.padding,10*b+2*this.padding),this.loadMolecule=null,this.getMolecule=null,this.cellDimension=b?b:20,this.setupTable(),this.repaint(),!0},a.PeriodicTableCanvas.prototype=new a._Canvas,a.PeriodicTableCanvas.prototype.getHoveredElement=function(){return null!=this.hovered?this.hovered.element:null},a.PeriodicTableCanvas.prototype.innerRepaint=function(a){for(var b=0,c=this.cells.length;c>b;b++)this.drawCell(a,this.specs,this.cells[b]);null!=this.hovered&&this.drawCell(a,this.specs,this.hovered),null!=this.selected&&this.drawCell(a,this.specs,this.selected)},a.PeriodicTableCanvas.prototype.setupTable=function(){this.cells=[];for(var b=y=this.padding,c=0,e=0,f=a.SYMBOLS.length;f>e;e++){18==c&&(c=0,y+=this.cellDimension,b=this.padding);var g=a.ELEMENT[a.SYMBOLS[e]];2==g.atomicNumber?(b+=16*this.cellDimension,c+=16):(5==g.atomicNumber||13==g.atomicNumber)&&(b+=10*this.cellDimension,c+=10),(g.atomicNumber<58||g.atomicNumber>71&&g.atomicNumber<90||g.atomicNumber>103)&&g.atomicNumber<113&&(this.cells.push(new d(g,b,y,this.cellDimension)),b+=this.cellDimension,c++)}y+=2*this.cellDimension,b=3*this.cellDimension+this.padding;for(var e=57;104>e;e++){var g=a.ELEMENT[a.SYMBOLS[e]];90==g.atomicNumber&&(y+=this.cellDimension,b=3*this.cellDimension+this.padding),(g.atomicNumber>=58&&g.atomicNumber<=71||g.atomicNumber>=90&&g.atomicNumber<=103)&&(this.cells.push(new d(g,b,y,this.cellDimension)),b+=this.cellDimension)}},a.PeriodicTableCanvas.prototype.drawCell=function(a,c,d){var e=a.createRadialGradient(d.x+d.dimension/3,d.y+d.dimension/3,1.5*d.dimension,d.x+d.dimension/3,d.y+d.dimension/3,d.dimension/10);e.addColorStop(0,"#000000"),e.addColorStop(.7,d.element.jmolColor),e.addColorStop(1,"#FFFFFF"),a.fillStyle=e,b.contextRoundRect(a,d.x,d.y,d.dimension,d.dimension,d.dimension/8),(d==this.hovered||d==this.selected)&&(a.lineWidth=2,a.strokeStyle="#c10000",a.stroke(),a.fillStyle="white"),a.fill(),a.font=c.getFontString(c.text_font_size,c.text_font_families),a.fillStyle=c.text_color,a.textAlign="center",a.textBaseline="middle",a.fillText(d.element.symbol,d.x+d.dimension/2,d.y+d.dimension/2)
},a.PeriodicTableCanvas.prototype.click=function(){null!=this.hovered&&(this.selected=this.hovered,this.repaint())},a.PeriodicTableCanvas.prototype.mousemove=function(a){var b=a.p.x,d=a.p.y;this.hovered=null;for(var e=0,f=this.cells.length;f>e;e++){var g=this.cells[e];if(c.isBetween(b,g.x,g.x+g.dimension)&&c.isBetween(d,g.y,g.y+g.dimension)){this.hovered=g;break}}this.repaint()},a.PeriodicTableCanvas.prototype.mouseout=function(){this.hovered=null,this.repaint()}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,document),function(a,b){a._Layout=function(){return!0},a._Layout.prototype.layout=function(){this.innerLayout&&this.innerLayout()},a._Layout.prototype.create=function(a){this.name=a,this.specs=new b.VisualSpecifications}}(ChemDoodle,ChemDoodle.structures),function(a,b,c){a.SimpleReactionLayout=function(a){return this.reactants=[],this.products=[],this.textAbove=null,this.textBelow=null,this.arrow="&rarr;",this.plus="+",this.create(a),!0},a.SimpleReactionLayout.prototype=new a._Layout,a.SimpleReactionLayout.prototype.addReactant=function(a){this.reactants.push(a)},a.SimpleReactionLayout.prototype.addProduct=function(a){this.products.push(a)},a.SimpleReactionLayout.prototype.innerLayout=function(){var d='<span style="font-size:25px;">';c.writeln("<table><tr>");for(var e=0,f=this.reactants.length;f>e;e++){e>0&&c.writeln("<td>"+d+this.plus+"</span></td>"),c.writeln("<td>");var g=this.reactants[e].getDimension(),h=new a.ViewerCanvas(this.name+"_reactant"+e,g.x+60,g.y+60);null==this.specs.backgroundColor&&b("#"+this.name+"_reactant"+e).css("border","0px"),h.specs=this.specs,h.loadMolecule(this.reactants[e]),c.writeln("</td>")}c.writeln("<td>"),c.writeln("<table>"),c.writeln("<tr><td>"),c.writeln(null!=this.textAbove?"<center>"+this.textAbove+"</center>":"&nbsp;"),c.writeln("</td></tr>"),c.writeln("<tr><td><center>"+d+this.arrow+"</span></center></td></tr>"),c.writeln("<tr><td>"),c.writeln(null!=this.textBelow?"<center>"+this.textBelow+"</center>":"&nbsp;"),c.writeln("</td></tr>"),c.writeln("</table>"),c.writeln("</td>");for(var e=0,f=this.products.length;f>e;e++){e>0&&c.writeln("<td>"+d+this.plus+"</td>"),c.writeln("<td>");var g=this.products[e].getDimension(),h=new a.ViewerCanvas(this.name+"_product"+e,g.x+60,g.y+60);null==this.specs.backgroundColor&&b("#"+this.name+"_product"+e).css("border","0px"),h.specs=this.specs,h.loadMolecule(this.products[e]),c.writeln("</td>")}c.writeln("</tr></table>")}}(ChemDoodle,jQuery,document),function(a,b,c){a.png={},a.png.create=function(a){c.open(b.getElementById(a.id).toDataURL("image/png"))}}(ChemDoodle.io,document,window),function(a,b){a.file={},a.file.content=function(a,c){b.get(a,"",c)}}(ChemDoodle.io,jQuery);