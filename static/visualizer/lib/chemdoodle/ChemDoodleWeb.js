var ChemDoodle=function(){return{structures:{},iChemLabs:{},informatics:{},io:{},getVersion:function(){return"4.6.1"}}}();!function(a,b,c,d,e){b.SERVER_URL="http://ichemlabs.cloud.chemdoodle.com/ICL_servlets/WebHQ1",b.inRelay=!1,b.asynchronous=!0,b.INFO={userAgent:navigator.userAgent,v_cwc:a.getVersion(),v_jQuery:e.version,v_jQuery_ui:e.ui?e.ui.version:"N/A"},b.contactServer=function(a,c,d,f){this.inRelay?alert("Already connecting to the server, please wait for the first request to finish."):(b.inRelay=!0,e.ajax({dataType:"text",type:"POST",data:JSON.stringify({call:a,content:c,info:b.INFO}),url:this.SERVER_URL,success:function(a){b.inRelay=!1,o=JSON.parse(a),o.message&&alert(o.message),null!=d&&o.content&&!o.stop&&d(o.content),o.stop&&null!=f&&f()},error:function(){b.inRelay=!1,alert("Server connectivity failed. Please try again or update this browser to the latest version. (XHR2 not supported)"),null!=f&&f()},beforeSend:function(a){a.withCredentials=!0},async:b.asynchronous}))},b.optimize=function(a,b,d,e){this.contactServer("optimize",{mol:c.toJSONDummy(a),dimension:b},function(e){if(e=c.fromJSONDummy(e.mol),2==b){for(var f=0,g=e.atoms.length;g>f;f++)a.atoms[f].x=e.atoms[f].x,a.atoms[f].y=e.atoms[f].y;d()}else if(3==b){for(f=0,g=e.atoms.length;g>f;f++)e.atoms[f].x/=20,e.atoms[f].y/=20,e.atoms[f].z/=20;d(e)}},e)},b.readSMILES=function(a,b,d){this.contactServer("readSMILES",{smiles:a},function(a){b(c.fromJSONDummy(a.mol))},d)},b.writeSMILES=function(a,b,d){this.contactServer("writeSMILES",{mol:c.toJSONDummy(a)},function(a){b(a.smiles)},d)},b.saveFile=function(a,b,d,e){this.contactServer("saveFile",{mol:c.toJSONDummy(a),ext:b},function(a){d(a.link)},e)},b.getMoleculeFromDatabase=function(a,b,d,e,f){this.contactServer("getMoleculeFromDatabase",{database:a,dimension:e?e:2,query:b},function(a){if(3==e)for(var b=0,f=a.mol.a.length;f>b;b++)a.mol.a[b].x/=20,a.mol.a[b].y/=-20,a.mol.a[b].z/=20;d(c.fromJSONDummy(a.mol))},f)},b.getMoleculeFromContent=function(a,b,c,d){this.contactServer("getMoleculeFromContent",{content:a,format:b},function(a){for(var b=!1,d=0,e=a.mol.a.length;e>d;d++)if(0!=a.mol.a[d].z){b=!0;break}if(b)for(d=0,e=a.mol.a.length;e>d;d++)a.mol.a[d].x/=20,a.mol.a[d].y/=20,a.mol.a[d].z/=20;c(ChemDoodle.io.fromJSONDummy(a.mol))},d)},b.calculate=function(a,b,d,e){this.contactServer("calculate",{mol:c.toJSONDummy(a),descriptors:b},function(a){d(a)},e)},b.simulate1HNMR=function(b,d,e){this.contactServer("simulateNMR",{mol:c.toJSONDummy(b),nucleus:"H",isotope:1},function(b){d(a.readJCAMP(b.jcamp))},e)},b.simulate13CNMR=function(b,d,e){this.contactServer("simulateNMR",{mol:c.toJSONDummy(b),nucleus:"C",isotope:13},function(b){d(a.readJCAMP(b.jcamp))},e)},b.simulateMassParentPeak=function(b,d,e){this.contactServer("simulateMassParentPeak",{mol:c.toJSONDummy(b)},function(b){d(a.readJCAMP(b.jcamp))},e)},b.getOptimizedPDBStructure=function(a,b,e,f){this.contactServer("getOptimizedPDBStructure",{id:a,withAtoms:b},function(a){var b=null,b=a.mol?c.fromJSONDummy(a.mol):new d.Molecule;b.chains=c.fromJSONChains(a.ribbons),b.fromJSON=!0,e(b)},f)},b.getAd=function(a,b){this.contactServer("getAd",{},function(b){a(b.image_url,b.target_url)},b)},b.kekulize=function(a,b,d){this.contactServer("kekulize",{mol:c.toJSONDummy(a)},function(a){b(c.fromJSONDummy(a.mol))},d)},b.isGraphIsomorphism=function(a,b,d,e){this.contactServer("isGraphIsomorphism",{arrow:c.toJSONDummy(a),target:c.toJSONDummy(b)},function(a){d(a.value)},e)},b.isSubgraphIsomorphism=function(a,b,d,e){this.contactServer("isSubgraphIsomorphism",{arrow:c.toJSONDummy(a),target:c.toJSONDummy(b)},function(a){d(a.value)},e)},b.readIUPACName=function(a,b,d){this.contactServer("readIUPACName",{iupac:a},function(a){b(c.fromJSONDummy(a.mol))},d)},b.generateImage=function(a,b,d,e){this.contactServer("generateImage",{mol:c.toJSONDummy(a),ext:b},function(a){d(a.link)},e)},b.getZeoliteFromIZA=function(a,b,c,d,e,f){this.contactServer("getZeoliteFromIZA",{query:a},function(a){b(ChemDoodle.readCIF(a.cif,c,d,e))},f)}}(ChemDoodle,ChemDoodle.iChemLabs,ChemDoodle.io,ChemDoodle.structures,jQuery),ChemDoodle.extensions=function(a,b,c){return{stringStartsWith:function(a,b){return a.match("^"+b)==b},vec3AngleFrom:function(a,d){var e=b.length(a),f=b.length(d),e=b.dot(a,d)/e/f;return c.acos(e)},contextHashTo:function(b,c,d,e,f,g,h){for(var i=0,j=new a.Point(c,d).distance(new a.Point(e,f)),k=!1,l=c,m=d,c=e-c,d=f-d;j>i;){if(k){if(i+h>j){b.moveTo(e,f);break}var n=h/j,l=l+n*c,m=m+n*d;b.moveTo(l,m),i+=h}else{if(i+g>j){b.lineTo(e,f);break}n=g/j,l+=n*c,m+=n*d,b.lineTo(l,m),i+=g}k=!k}},contextRoundRect:function(a,b,c,d,e,f){a.beginPath(),a.moveTo(b+f,c),a.lineTo(b+d-f,c),a.quadraticCurveTo(b+d,c,b+d,c+f),a.lineTo(b+d,c+e-f),a.quadraticCurveTo(b+d,c+e,b+d-f,c+e),a.lineTo(b+f,c+e),a.quadraticCurveTo(b,c+e,b,c+e-f),a.lineTo(b,c+f),a.quadraticCurveTo(b,c,b+f,c),a.closePath()},contextEllipse:function(a,b,c,d,e){var f=.5522848*(d/2),g=.5522848*(e/2),h=b+d,i=c+e,d=b+d/2,e=c+e/2;a.beginPath(),a.moveTo(b,e),a.bezierCurveTo(b,e-g,d-f,c,d,c),a.bezierCurveTo(d+f,c,h,e-g,h,e),a.bezierCurveTo(h,e+g,d+f,i,d,i),a.bezierCurveTo(d-f,i,b,e+g,b,e),a.closePath()}}}(ChemDoodle.structures,vec3,Math),ChemDoodle.math=function(a,b,c){var d={},e={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return d.angleBetweenLargest=function(a){if(0==a.length)return{angle:0,largest:2*c.PI};if(1==a.length)return{angle:a[0]+c.PI,largest:2*c.PI};for(var b=0,d=0,e=0,f=a.length-1;f>e;e++){var g=a[e+1]-a[e];g>b&&(b=g,d=(a[e+1]+a[e])/2)}return e=a[0]+2*c.PI-a[a.length-1],e>b&&(d=a[0]-e/2,b=e,0>d&&(d+=2*c.PI)),{angle:d,largest:b}},d.isBetween=function(a,b,c){return a>=b&&c>=a},d.getRGB=function(b,c){var d=[0,0,0];if(null!=e[b.toLowerCase()]&&(b=e[b.toLowerCase()]),"#"==b.charAt(0))return 4==b.length&&(b="#"+b.charAt(1)+b.charAt(1)+b.charAt(2)+b.charAt(2)+b.charAt(3)+b.charAt(3)),[parseInt(b.substring(1,3),16)/255*c,parseInt(b.substring(3,5),16)/255*c,parseInt(b.substring(5,7),16)/255*c];if(a.stringStartsWith(b,"rgb")){var f=b.replace(/rgb\(|\)/g,"").split(",");return 3!=f.length?d:[parseInt(f[0])/255*c,parseInt(f[1])/255*c,parseInt(f[2])/255*c]}return d},d.distanceFromPointToLineInclusive=function(a,e,f){var g=e.distance(f),f=e.angle(f),f=c.PI/2-f;return new b.Point(a.x-e.x,a.y-e.x),new b.Point,f=e.angle(a)+f,a=e.distance(a),pcopRot=new b.Point(a*c.cos(f),-a*c.sin(f)),d.isBetween(-pcopRot.y,0,g)?c.abs(pcopRot.x):-1},d.hsl2rgb=function(a,b,c){if(0==b)c=b=a=c;else var d=function(a,b,c){return 0>c&&(c+=1),c>1&&(c-=1),1/6>c?a+6*(b-a)*c:.5>c?b:2/3>c?a+6*(b-a)*(2/3-c):a},e=.5>c?c*(1+b):c+b-c*b,f=2*c-e,c=d(f,e,a+1/3),b=d(f,e,a),a=d(f,e,a-1/3);return[255*c,255*b,255*a]},d}(ChemDoodle.extensions,ChemDoodle.structures,Math),ChemDoodle.featureDetection=function(a,b,c,d){var e={supports_canvas:function(){return!!c.createElement("canvas").getContext},supports_canvas_text:function(){return e.supports_canvas()?"function"==typeof c.createElement("canvas").getContext("2d").fillText:!1},supports_webgl:function(){var a=c.createElement("canvas");try{if(a.getContext("webgl")||a.getContext("experimental-webgl"))return!0}catch(b){}return!1},supports_xhr2:function(){return b.support.cors},supports_touch:function(){return"ontouchstart"in d},supports_gesture:function(){return"ongesturestart"in d}};return e}(ChemDoodle.iChemLabs,jQuery,document,window),ChemDoodle.SYMBOLS="H,He,Li,Be,B,C,N,O,F,Ne,Na,Mg,Al,Si,P,S,Cl,Ar,K,Ca,Sc,Ti,V,Cr,Mn,Fe,Co,Ni,Cu,Zn,Ga,Ge,As,Se,Br,Kr,Rb,Sr,Y,Zr,Nb,Mo,Tc,Ru,Rh,Pd,Ag,Cd,In,Sn,Sb,Te,I,Xe,Cs,Ba,La,Ce,Pr,Nd,Pm,Sm,Eu,Gd,Tb,Dy,Ho,Er,Tm,Yb,Lu,Hf,Ta,W,Re,Os,Ir,Pt,Au,Hg,Tl,Pb,Bi,Po,At,Rn,Fr,Ra,Ac,Th,Pa,U,Np,Pu,Am,Cm,Bk,Cf,Es,Fm,Md,No,Lr,Rf,Db,Sg,Bh,Hs,Mt,Ds,Rg,Cn,Uut,Uuq,Uup,Uuh,Uus,Uuo".split(","),ChemDoodle.ELEMENT=function(a){function b(a,b,c){return this.symbol=a,this.name=b,this.atomicNumber=c,!0}var c=[];c.H=new b("H","Hydrogen",1),c.He=new b("He","Helium",2),c.Li=new b("Li","Lithium",3),c.Be=new b("Be","Beryllium",4),c.B=new b("B","Boron",5),c.C=new b("C","Carbon",6),c.N=new b("N","Nitrogen",7),c.O=new b("O","Oxygen",8),c.F=new b("F","Fluorine",9),c.Ne=new b("Ne","Neon",10),c.Na=new b("Na","Sodium",11),c.Mg=new b("Mg","Magnesium",12),c.Al=new b("Al","Aluminum",13),c.Si=new b("Si","Silicon",14),c.P=new b("P","Phosphorus",15),c.S=new b("S","Sulfur",16),c.Cl=new b("Cl","Chlorine",17),c.Ar=new b("Ar","Argon",18),c.K=new b("K","Potassium",19),c.Ca=new b("Ca","Calcium",20),c.Sc=new b("Sc","Scandium",21),c.Ti=new b("Ti","Titanium",22),c.V=new b("V","Vanadium",23),c.Cr=new b("Cr","Chromium",24),c.Mn=new b("Mn","Manganese",25),c.Fe=new b("Fe","Iron",26),c.Co=new b("Co","Cobalt",27),c.Ni=new b("Ni","Nickel",28),c.Cu=new b("Cu","Copper",29),c.Zn=new b("Zn","Zinc",30),c.Ga=new b("Ga","Gallium",31),c.Ge=new b("Ge","Germanium",32),c.As=new b("As","Arsenic",33),c.Se=new b("Se","Selenium",34),c.Br=new b("Br","Bromine",35),c.Kr=new b("Kr","Krypton",36),c.Rb=new b("Rb","Rubidium",37),c.Sr=new b("Sr","Strontium",38),c.Y=new b("Y","Yttrium",39),c.Zr=new b("Zr","Zirconium",40),c.Nb=new b("Nb","Niobium",41),c.Mo=new b("Mo","Molybdenum",42),c.Tc=new b("Tc","Technetium",43),c.Ru=new b("Ru","Ruthenium",44),c.Rh=new b("Rh","Rhodium",45),c.Pd=new b("Pd","Palladium",46),c.Ag=new b("Ag","Silver",47),c.Cd=new b("Cd","Cadmium",48),c.In=new b("In","Indium",49),c.Sn=new b("Sn","Tin",50),c.Sb=new b("Sb","Antimony",51),c.Te=new b("Te","Tellurium",52),c.I=new b("I","Iodine",53),c.Xe=new b("Xe","Xenon",54),c.Cs=new b("Cs","Cesium",55),c.Ba=new b("Ba","Barium",56),c.La=new b("La","Lanthanum",57),c.Ce=new b("Ce","Cerium",58),c.Pr=new b("Pr","Praseodymium",59),c.Nd=new b("Nd","Neodymium",60),c.Pm=new b("Pm","Promethium",61),c.Sm=new b("Sm","Samarium",62),c.Eu=new b("Eu","Europium",63),c.Gd=new b("Gd","Gadolinium",64),c.Tb=new b("Tb","Terbium",65),c.Dy=new b("Dy","Dysprosium",66),c.Ho=new b("Ho","Holmium",67),c.Er=new b("Er","Erbium",68),c.Tm=new b("Tm","Thulium",69),c.Yb=new b("Yb","Ytterbium",70),c.Lu=new b("Lu","Lutetium",71),c.Hf=new b("Hf","Hafnium",72),c.Ta=new b("Ta","Tantalum",73),c.W=new b("W","Tungsten",74),c.Re=new b("Re","Rhenium",75),c.Os=new b("Os","Osmium",76),c.Ir=new b("Ir","Iridium",77),c.Pt=new b("Pt","Platinum",78),c.Au=new b("Au","Gold",79),c.Hg=new b("Hg","Mercury",80),c.Tl=new b("Tl","Thallium",81),c.Pb=new b("Pb","Lead",82),c.Bi=new b("Bi","Bismuth",83),c.Po=new b("Po","Polonium",84),c.At=new b("At","Astatine",85),c.Rn=new b("Rn","Radon",86),c.Fr=new b("Fr","Francium",87),c.Ra=new b("Ra","Radium",88),c.Ac=new b("Ac","Actinium",89),c.Th=new b("Th","Thorium",90),c.Pa=new b("Pa","Protactinium",91),c.U=new b("U","Uranium",92),c.Np=new b("Np","Neptunium",93),c.Pu=new b("Pu","Plutonium",94),c.Am=new b("Am","Americium",95),c.Cm=new b("Cm","Curium",96),c.Bk=new b("Bk","Berkelium",97),c.Cf=new b("Cf","Californium",98),c.Es=new b("Es","Einsteinium",99),c.Fm=new b("Fm","Fermium",100),c.Md=new b("Md","Mendelevium",101),c.No=new b("No","Nobelium",102),c.Lr=new b("Lr","Lawrencium",103),c.Rf=new b("Rf","Rutherfordium",104),c.Db=new b("Db","Dubnium",105),c.Sg=new b("Sg","Seaborgium",106),c.Bh=new b("Bh","Bohrium",107),c.Hs=new b("Hs","Hassium",108),c.Mt=new b("Mt","Meitnerium",109),c.Ds=new b("Ds","Darmstadtium",110),c.Rg=new b("Rg","Roentgenium",111),c.Cn=new b("Cn","Copernicium",112),c.Uut=new b("Uut","Ununtrium",113),c.Uuq=new b("Uuq","Ununquadium",114),c.Uup=new b("Uup","Ununpentium",115),c.Uuh=new b("Uuh","Ununhexium",116),c.Uus=new b("Uus","Ununseptium",117),c.Uuo=new b("Uuo","Ununoctium",118),c.H.jmolColor="#FFFFFF",c.He.jmolColor="#D9FFFF",c.Li.jmolColor="#CC80FF",c.Be.jmolColor="#C2FF00",c.B.jmolColor="#FFB5B5",c.C.jmolColor="#909090",c.N.jmolColor="#3050F8",c.O.jmolColor="#FF0D0D",c.F.jmolColor="#90E050",c.Ne.jmolColor="#B3E3F5",c.Na.jmolColor="#AB5CF2",c.Mg.jmolColor="#8AFF00",c.Al.jmolColor="#BFA6A6",c.Si.jmolColor="#F0C8A0",c.P.jmolColor="#FF8000",c.S.jmolColor="#FFFF30",c.Cl.jmolColor="#1FF01F",c.Ar.jmolColor="#80D1E3",c.K.jmolColor="#8F40D4",c.Ca.jmolColor="#3DFF00",c.Sc.jmolColor="#E6E6E6",c.Ti.jmolColor="#BFC2C7",c.V.jmolColor="#A6A6AB",c.Cr.jmolColor="#8A99C7",c.Mn.jmolColor="#9C7AC7",c.Fe.jmolColor="#E06633",c.Co.jmolColor="#F090A0",c.Ni.jmolColor="#50D050",c.Cu.jmolColor="#C88033",c.Zn.jmolColor="#7D80B0",c.Ga.jmolColor="#C28F8F",c.Ge.jmolColor="#668F8F",c.As.jmolColor="#BD80E3",c.Se.jmolColor="#FFA100",c.Br.jmolColor="#A62929",c.Kr.jmolColor="#5CB8D1",c.Rb.jmolColor="#702EB0",c.Sr.jmolColor="#00FF00",c.Y.jmolColor="#94FFFF",c.Zr.jmolColor="#94E0E0",c.Nb.jmolColor="#73C2C9",c.Mo.jmolColor="#54B5B5",c.Tc.jmolColor="#3B9E9E",c.Ru.jmolColor="#248F8F",c.Rh.jmolColor="#0A7D8C",c.Pd.jmolColor="#006985",c.Ag.jmolColor="#C0C0C0",c.Cd.jmolColor="#FFD98F",c.In.jmolColor="#A67573",c.Sn.jmolColor="#668080",c.Sb.jmolColor="#9E63B5",c.Te.jmolColor="#D47A00",c.I.jmolColor="#940094",c.Xe.jmolColor="#429EB0",c.Cs.jmolColor="#57178F",c.Ba.jmolColor="#00C900",c.La.jmolColor="#70D4FF",c.Ce.jmolColor="#FFFFC7",c.Pr.jmolColor="#D9FFC7",c.Nd.jmolColor="#C7FFC7",c.Pm.jmolColor="#A3FFC7",c.Sm.jmolColor="#8FFFC7",c.Eu.jmolColor="#61FFC7",c.Gd.jmolColor="#45FFC7",c.Tb.jmolColor="#30FFC7",c.Dy.jmolColor="#1FFFC7",c.Ho.jmolColor="#00FF9C",c.Er.jmolColor="#00E675",c.Tm.jmolColor="#00D452",c.Yb.jmolColor="#00BF38",c.Lu.jmolColor="#00AB24",c.Hf.jmolColor="#4DC2FF",c.Ta.jmolColor="#4DA6FF",c.W.jmolColor="#2194D6",c.Re.jmolColor="#267DAB",c.Os.jmolColor="#266696",c.Ir.jmolColor="#175487",c.Pt.jmolColor="#D0D0E0",c.Au.jmolColor="#FFD123",c.Hg.jmolColor="#B8B8D0",c.Tl.jmolColor="#A6544D",c.Pb.jmolColor="#575961",c.Bi.jmolColor="#9E4FB5",c.Po.jmolColor="#AB5C00",c.At.jmolColor="#754F45",c.Rn.jmolColor="#428296",c.Fr.jmolColor="#420066",c.Ra.jmolColor="#007D00",c.Ac.jmolColor="#70ABFA",c.Th.jmolColor="#00BAFF",c.Pa.jmolColor="#00A1FF",c.U.jmolColor="#008FFF",c.Np.jmolColor="#0080FF",c.Pu.jmolColor="#006BFF",c.Am.jmolColor="#545CF2",c.Cm.jmolColor="#785CE3",c.Bk.jmolColor="#8A4FE3",c.Cf.jmolColor="#A136D4",c.Es.jmolColor="#B31FD4",c.Fm.jmolColor="#B31FBA",c.Md.jmolColor="#B30DA6",c.No.jmolColor="#BD0D87",c.Lr.jmolColor="#C70066",c.Rf.jmolColor="#CC0059",c.Db.jmolColor="#D1004F",c.Sg.jmolColor="#D90045",c.Bh.jmolColor="#E00038",c.Hs.jmolColor="#E6002E",c.Mt.jmolColor="#EB0026",c.Ds.jmolColor="#000000",c.Rg.jmolColor="#000000",c.Cn.jmolColor="#000000",c.Uut.jmolColor="#000000",c.Uuq.jmolColor="#000000",c.Uup.jmolColor="#000000",c.Uuh.jmolColor="#000000",c.Uus.jmolColor="#000000",c.Uuo.jmolColor="#000000";for(var d=0,e=a.length;e>d;d++)c[a[d]].pymolColor=c[a[d]].jmolColor;return c.H.pymolColor="#E6E6E6",c.C.pymolColor="#33FF33",c.N.pymolColor="#3333FF",c.O.pymolColor="#FF4D4D",c.F.pymolColor="#B3FFFF",c.S.pymolColor="#E6C640",c.H.covalentRadius=.31,c.He.covalentRadius=.28,c.Li.covalentRadius=1.28,c.Be.covalentRadius=.96,c.B.covalentRadius=.84,c.C.covalentRadius=.76,c.N.covalentRadius=.71,c.O.covalentRadius=.66,c.F.covalentRadius=.57,c.Ne.covalentRadius=.58,c.Na.covalentRadius=1.66,c.Mg.covalentRadius=1.41,c.Al.covalentRadius=1.21,c.Si.covalentRadius=1.11,c.P.covalentRadius=1.07,c.S.covalentRadius=1.05,c.Cl.covalentRadius=1.02,c.Ar.covalentRadius=1.06,c.K.covalentRadius=2.03,c.Ca.covalentRadius=1.76,c.Sc.covalentRadius=1.7,c.Ti.covalentRadius=1.6,c.V.covalentRadius=1.53,c.Cr.covalentRadius=1.39,c.Mn.covalentRadius=1.39,c.Fe.covalentRadius=1.32,c.Co.covalentRadius=1.26,c.Ni.covalentRadius=1.24,c.Cu.covalentRadius=1.32,c.Zn.covalentRadius=1.22,c.Ga.covalentRadius=1.22,c.Ge.covalentRadius=1.2,c.As.covalentRadius=1.19,c.Se.covalentRadius=1.2,c.Br.covalentRadius=1.2,c.Kr.covalentRadius=1.16,c.Rb.covalentRadius=2.2,c.Sr.covalentRadius=1.95,c.Y.covalentRadius=1.9,c.Zr.covalentRadius=1.75,c.Nb.covalentRadius=1.64,c.Mo.covalentRadius=1.54,c.Tc.covalentRadius=1.47,c.Ru.covalentRadius=1.46,c.Rh.covalentRadius=1.42,c.Pd.covalentRadius=1.39,c.Ag.covalentRadius=1.45,c.Cd.covalentRadius=1.44,c.In.covalentRadius=1.42,c.Sn.covalentRadius=1.39,c.Sb.covalentRadius=1.39,c.Te.covalentRadius=1.38,c.I.covalentRadius=1.39,c.Xe.covalentRadius=1.4,c.Cs.covalentRadius=2.44,c.Ba.covalentRadius=2.15,c.La.covalentRadius=2.07,c.Ce.covalentRadius=2.04,c.Pr.covalentRadius=2.03,c.Nd.covalentRadius=2.01,c.Pm.covalentRadius=1.99,c.Sm.covalentRadius=1.98,c.Eu.covalentRadius=1.98,c.Gd.covalentRadius=1.96,c.Tb.covalentRadius=1.94,c.Dy.covalentRadius=1.92,c.Ho.covalentRadius=1.92,c.Er.covalentRadius=1.89,c.Tm.covalentRadius=1.9,c.Yb.covalentRadius=1.87,c.Lu.covalentRadius=1.87,c.Hf.covalentRadius=1.75,c.Ta.covalentRadius=1.7,c.W.covalentRadius=1.62,c.Re.covalentRadius=1.51,c.Os.covalentRadius=1.44,c.Ir.covalentRadius=1.41,c.Pt.covalentRadius=1.36,c.Au.covalentRadius=1.36,c.Hg.covalentRadius=1.32,c.Tl.covalentRadius=1.45,c.Pb.covalentRadius=1.46,c.Bi.covalentRadius=1.48,c.Po.covalentRadius=1.4,c.At.covalentRadius=1.5,c.Rn.covalentRadius=1.5,c.Fr.covalentRadius=2.6,c.Ra.covalentRadius=2.21,c.Ac.covalentRadius=2.15,c.Th.covalentRadius=2.06,c.Pa.covalentRadius=2,c.U.covalentRadius=1.96,c.Np.covalentRadius=1.9,c.Pu.covalentRadius=1.87,c.Am.covalentRadius=1.8,c.Cm.covalentRadius=1.69,c.Bk.covalentRadius=0,c.Cf.covalentRadius=0,c.Es.covalentRadius=0,c.Fm.covalentRadius=0,c.Md.covalentRadius=0,c.No.covalentRadius=0,c.Lr.covalentRadius=0,c.Rf.covalentRadius=0,c.Db.covalentRadius=0,c.Sg.covalentRadius=0,c.Bh.covalentRadius=0,c.Hs.covalentRadius=0,c.Mt.covalentRadius=0,c.Ds.covalentRadius=0,c.Rg.covalentRadius=0,c.Cn.covalentRadius=0,c.Uut.covalentRadius=0,c.Uuq.covalentRadius=0,c.Uup.covalentRadius=0,c.Uuh.covalentRadius=0,c.Uus.covalentRadius=0,c.Uuo.covalentRadius=0,c.H.vdWRadius=1.2,c.He.vdWRadius=1.4,c.Li.vdWRadius=1.82,c.Be.vdWRadius=0,c.B.vdWRadius=0,c.C.vdWRadius=1.7,c.N.vdWRadius=1.55,c.O.vdWRadius=1.52,c.F.vdWRadius=1.47,c.Ne.vdWRadius=1.54,c.Na.vdWRadius=2.27,c.Mg.vdWRadius=1.73,c.Al.vdWRadius=0,c.Si.vdWRadius=2.1,c.P.vdWRadius=1.8,c.S.vdWRadius=1.8,c.Cl.vdWRadius=1.75,c.Ar.vdWRadius=1.88,c.K.vdWRadius=2.75,c.Ca.vdWRadius=0,c.Sc.vdWRadius=0,c.Ti.vdWRadius=0,c.V.vdWRadius=0,c.Cr.vdWRadius=0,c.Mn.vdWRadius=0,c.Fe.vdWRadius=0,c.Co.vdWRadius=0,c.Ni.vdWRadius=1.63,c.Cu.vdWRadius=1.4,c.Zn.vdWRadius=1.39,c.Ga.vdWRadius=1.87,c.Ge.vdWRadius=0,c.As.vdWRadius=1.85,c.Se.vdWRadius=1.9,c.Br.vdWRadius=1.85,c.Kr.vdWRadius=2.02,c.Rb.vdWRadius=0,c.Sr.vdWRadius=0,c.Y.vdWRadius=0,c.Zr.vdWRadius=0,c.Nb.vdWRadius=0,c.Mo.vdWRadius=0,c.Tc.vdWRadius=0,c.Ru.vdWRadius=0,c.Rh.vdWRadius=0,c.Pd.vdWRadius=1.63,c.Ag.vdWRadius=1.72,c.Cd.vdWRadius=1.58,c.In.vdWRadius=1.93,c.Sn.vdWRadius=2.17,c.Sb.vdWRadius=0,c.Te.vdWRadius=2.06,c.I.vdWRadius=1.98,c.Xe.vdWRadius=2.16,c.Cs.vdWRadius=0,c.Ba.vdWRadius=0,c.La.vdWRadius=0,c.Ce.vdWRadius=0,c.Pr.vdWRadius=0,c.Nd.vdWRadius=0,c.Pm.vdWRadius=0,c.Sm.vdWRadius=0,c.Eu.vdWRadius=0,c.Gd.vdWRadius=0,c.Tb.vdWRadius=0,c.Dy.vdWRadius=0,c.Ho.vdWRadius=0,c.Er.vdWRadius=0,c.Tm.vdWRadius=0,c.Yb.vdWRadius=0,c.Lu.vdWRadius=0,c.Hf.vdWRadius=0,c.Ta.vdWRadius=0,c.W.vdWRadius=0,c.Re.vdWRadius=0,c.Os.vdWRadius=0,c.Ir.vdWRadius=0,c.Pt.vdWRadius=1.75,c.Au.vdWRadius=1.66,c.Hg.vdWRadius=1.55,c.Tl.vdWRadius=1.96,c.Pb.vdWRadius=2.02,c.Bi.vdWRadius=0,c.Po.vdWRadius=0,c.At.vdWRadius=0,c.Rn.vdWRadius=0,c.Fr.vdWRadius=0,c.Ra.vdWRadius=0,c.Ac.vdWRadius=0,c.Th.vdWRadius=0,c.Pa.vdWRadius=0,c.U.vdWRadius=1.86,c.Np.vdWRadius=0,c.Pu.vdWRadius=0,c.Am.vdWRadius=0,c.Cm.vdWRadius=0,c.Bk.vdWRadius=0,c.Cf.vdWRadius=0,c.Es.vdWRadius=0,c.Fm.vdWRadius=0,c.Md.vdWRadius=0,c.No.vdWRadius=0,c.Lr.vdWRadius=0,c.Rf.vdWRadius=0,c.Db.vdWRadius=0,c.Sg.vdWRadius=0,c.Bh.vdWRadius=0,c.Hs.vdWRadius=0,c.Mt.vdWRadius=0,c.Ds.vdWRadius=0,c.Rg.vdWRadius=0,c.Cn.vdWRadius=0,c.Uut.vdWRadius=0,c.Uuq.vdWRadius=0,c.Uup.vdWRadius=0,c.Uuh.vdWRadius=0,c.Uus.vdWRadius=0,c.Uuo.vdWRadius=0,c.H.valency=1,c.He.valency=0,c.Li.valency=1,c.Be.valency=2,c.B.valency=3,c.C.valency=4,c.N.valency=3,c.O.valency=2,c.F.valency=1,c.Ne.valency=0,c.Na.valency=1,c.Mg.valency=0,c.Al.valency=0,c.Si.valency=4,c.P.valency=3,c.S.valency=2,c.Cl.valency=1,c.Ar.valency=0,c.K.valency=0,c.Ca.valency=0,c.Sc.valency=0,c.Ti.valency=1,c.V.valency=1,c.Cr.valency=2,c.Mn.valency=3,c.Fe.valency=2,c.Co.valency=1,c.Ni.valency=1,c.Cu.valency=0,c.Zn.valency=0,c.Ga.valency=0,c.Ge.valency=4,c.As.valency=3,c.Se.valency=2,c.Br.valency=1,c.Kr.valency=0,c.Rb.valency=0,c.Sr.valency=0,c.Y.valency=0,c.Zr.valency=0,c.Nb.valency=1,c.Mo.valency=2,c.Tc.valency=3,c.Ru.valency=2,c.Rh.valency=1,c.Pd.valency=0,c.Ag.valency=0,c.Cd.valency=0,c.In.valency=0,c.Sn.valency=4,c.Sb.valency=3,c.Te.valency=2,c.I.valency=1,c.Xe.valency=0,c.Cs.valency=0,c.Ba.valency=0,c.La.valency=0,c.Ce.valency=0,c.Pr.valency=0,c.Nd.valency=0,c.Pm.valency=0,c.Sm.valency=0,c.Eu.valency=0,c.Gd.valency=0,c.Tb.valency=0,c.Dy.valency=0,c.Ho.valency=0,c.Er.valency=0,c.Tm.valency=0,c.Yb.valency=0,c.Lu.valency=0,c.Hf.valency=0,c.Ta.valency=1,c.W.valency=2,c.Re.valency=3,c.Os.valency=2,c.Ir.valency=3,c.Pt.valency=0,c.Au.valency=1,c.Hg.valency=0,c.Tl.valency=0,c.Pb.valency=4,c.Bi.valency=3,c.Po.valency=2,c.At.valency=1,c.Rn.valency=0,c.Fr.valency=0,c.Ra.valency=0,c.Ac.valency=0,c.Th.valency=0,c.Pa.valency=0,c.U.valency=0,c.Np.valency=0,c.Pu.valency=0,c.Am.valency=0,c.Cm.valency=0,c.Bk.valency=0,c.Cf.valency=0,c.Es.valency=0,c.Fm.valency=0,c.Md.valency=0,c.No.valency=0,c.Lr.valency=0,c.Rf.valency=0,c.Db.valency=0,c.Sg.valency=0,c.Bh.valency=0,c.Hs.valency=0,c.Mt.valency=0,c.Ds.valency=0,c.Rg.valency=0,c.Cn.valency=0,c.Uut.valency=0,c.Uuq.valency=0,c.Uup.valency=0,c.Uuh.valency=0,c.Uus.valency=0,c.Uuo.valency=0,c.H.mass=1,c.He.mass=4,c.Li.mass=7,c.Be.mass=9,c.B.mass=11,c.C.mass=12,c.N.mass=14,c.O.mass=16,c.F.mass=19,c.Ne.mass=20,c.Na.mass=23,c.Mg.mass=24,c.Al.mass=27,c.Si.mass=28,c.P.mass=31,c.S.mass=32,c.Cl.mass=35,c.Ar.mass=40,c.K.mass=39,c.Ca.mass=40,c.Sc.mass=45,c.Ti.mass=48,c.V.mass=51,c.Cr.mass=52,c.Mn.mass=55,c.Fe.mass=56,c.Co.mass=59,c.Ni.mass=58,c.Cu.mass=63,c.Zn.mass=64,c.Ga.mass=69,c.Ge.mass=74,c.As.mass=75,c.Se.mass=80,c.Br.mass=79,c.Kr.mass=84,c.Rb.mass=85,c.Sr.mass=88,c.Y.mass=89,c.Zr.mass=90,c.Nb.mass=93,c.Mo.mass=98,c.Tc.mass=0,c.Ru.mass=102,c.Rh.mass=103,c.Pd.mass=106,c.Ag.mass=107,c.Cd.mass=114,c.In.mass=115,c.Sn.mass=120,c.Sb.mass=121,c.Te.mass=130,c.I.mass=127,c.Xe.mass=132,c.Cs.mass=133,c.Ba.mass=138,c.La.mass=139,c.Ce.mass=140,c.Pr.mass=141,c.Nd.mass=142,c.Pm.mass=0,c.Sm.mass=152,c.Eu.mass=153,c.Gd.mass=158,c.Tb.mass=159,c.Dy.mass=164,c.Ho.mass=165,c.Er.mass=166,c.Tm.mass=169,c.Yb.mass=174,c.Lu.mass=175,c.Hf.mass=180,c.Ta.mass=181,c.W.mass=184,c.Re.mass=187,c.Os.mass=192,c.Ir.mass=193,c.Pt.mass=195,c.Au.mass=197,c.Hg.mass=202,c.Tl.mass=205,c.Pb.mass=208,c.Bi.mass=209,c.Po.mass=0,c.At.mass=0,c.Rn.mass=0,c.Fr.mass=0,c.Ra.mass=0,c.Ac.mass=0,c.Th.mass=232,c.Pa.mass=231,c.U.mass=238,c.Np.mass=0,c.Pu.mass=0,c.Am.mass=0,c.Cm.mass=0,c.Bk.mass=0,c.Cf.mass=0,c.Es.mass=0,c.Fm.mass=0,c.Md.mass=0,c.No.mass=0,c.Lr.mass=0,c.Rf.mass=0,c.Db.mass=0,c.Sg.mass=0,c.Bh.mass=0,c.Hs.mass=0,c.Mt.mass=0,c.Ds.mass=0,c.Rg.mass=0,c.Cn.mass=0,c.Uut.mass=0,c.Uuq.mass=0,c.Uup.mass=0,c.Uuh.mass=0,c.Uus.mass=0,c.Uuo.mass=0,c}(ChemDoodle.SYMBOLS),ChemDoodle.RESIDUE=function(){function a(a,b){return this.symbol=a,this.name=b,!0}var b=[];return b.Ala=new a("Ala","Alanine"),b.Arg=new a("Arg","Arginine"),b.Asn=new a("Asn","Asparagine"),b.Asp=new a("Asp","Aspartic Acid"),b.Cys=new a("Cys","Cysteine"),b.Gln=new a("Gln","Glutamine"),b.Glu=new a("Glu","Glutamic Acid"),b.Gly=new a("Gly","Glycine"),b.His=new a("His","Histidine"),b.Ile=new a("Ile","Isoleucine"),b.Leu=new a("Leu","Leucine"),b.Lys=new a("Lys","Lysine"),b.Met=new a("Met","Methionine"),b.Phe=new a("Phe","Phenylalanine"),b.Pro=new a("Pro","Proline"),b.Ser=new a("Ser","Serine"),b.Thr=new a("Thr","Threonine"),b.Trp=new a("Trp","Tryptophan"),b.Tyr=new a("Tyr","Tyrosine"),b.Val=new a("Val","Valine"),b.Asx=new a("Asx","Asparagine/Aspartic Acid"),b.Glx=new a("Glx","Glutamine/Glutamic Acid"),b["*"]=new a("*","Other"),b.A=new a("A","Adenine"),b.G=new a("G","Guanine"),b.I=new a("I",""),b.C=new a("C","Cytosine"),b.T=new a("T","Thymine"),b.U=new a("U","Uracil"),b.Ala.polar=!1,b.Arg.polar=!0,b.Asn.polar=!0,b.Asp.polar=!0,b.Cys.polar=!0,b.Gln.polar=!0,b.Glu.polar=!0,b.Gly.polar=!1,b.His.polar=!0,b.Ile.polar=!1,b.Leu.polar=!1,b.Lys.polar=!0,b.Met.polar=!1,b.Phe.polar=!1,b.Pro.polar=!1,b.Ser.polar=!0,b.Thr.polar=!0,b.Trp.polar=!0,b.Tyr.polar=!0,b.Val.polar=!1,b.Asx.polar=!0,b.Glx.polar=!0,b.Ala.aminoColor="#C8C8C8",b.Arg.aminoColor="#145AFF",b.Asn.aminoColor="#00DCDC",b.Asp.aminoColor="#E60A0A",b.Cys.aminoColor="#E6E600",b.Gln.aminoColor="#00DCDC",b.Glu.aminoColor="#E60A0A",b.Gly.aminoColor="#EBEBEB",b.His.aminoColor="#8282D2",b.Ile.aminoColor="#0F820F",b.Leu.aminoColor="#0F820F",b.Lys.aminoColor="#145AFF",b.Met.aminoColor="#E6E600",b.Phe.aminoColor="#3232AA",b.Pro.aminoColor="#DC9682",b.Ser.aminoColor="#FA9600",b.Thr.aminoColor="#FA9600",b.Trp.aminoColor="#B45AB4",b.Tyr.aminoColor="#3232AA",b.Val.aminoColor="#0F820F",b.Asx.aminoColor="#FF69B4",b.Glx.aminoColor="#FF69B4",b["*"].aminoColor="#BEA06E",b.A.aminoColor="#BEA06E",b.G.aminoColor="#BEA06E",b.I.aminoColor="#BEA06E",b.C.aminoColor="#BEA06E",b.T.aminoColor="#BEA06E",b.U.aminoColor="#BEA06E",b.Ala.shapelyColor="#8CFF8C",b.Arg.shapelyColor="#00007C",b.Asn.shapelyColor="#FF7C70",b.Asp.shapelyColor="#A00042",b.Cys.shapelyColor="#FFFF70",b.Gln.shapelyColor="#FF4C4C",b.Glu.shapelyColor="#660000",b.Gly.shapelyColor="#FFFFFF",b.His.shapelyColor="#7070FF",b.Ile.shapelyColor="#004C00",b.Leu.shapelyColor="#455E45",b.Lys.shapelyColor="#4747B8",b.Met.shapelyColor="#B8A042",b.Phe.shapelyColor="#534C52",b.Pro.shapelyColor="#525252",b.Ser.shapelyColor="#FF7042",b.Thr.shapelyColor="#B84C00",b.Trp.shapelyColor="#4F4600",b.Tyr.shapelyColor="#8C704C",b.Val.shapelyColor="#FF8CFF",b.Asx.shapelyColor="#FF00FF",b.Glx.shapelyColor="#FF00FF",b["*"].shapelyColor="#FF00FF",b.A.shapelyColor="#A0A0FF",b.G.shapelyColor="#FF7070",b.I.shapelyColor="#80FFFF",b.C.shapelyColor="#FF8C4B",b.T.shapelyColor="#A0FFA0",b.U.shapelyColor="#FF8080",b}(),function(a){a.Queue=function(){var a=[],b=0;this.getSize=function(){return a.length-b},this.isEmpty=function(){return 0==a.length},this.enqueue=function(b){a.push(b)},this.dequeue=function(){var c=void 0;return a.length&&(c=a[b],2*++b>=a.length&&(a=a.slice(b),b=0)),c},this.getOldestElement=function(){var c=void 0;return a.length&&(c=a[b]),c}}}(ChemDoodle.structures),function(a,b){a.Point=function(a,c){return this.x=a?a:0,this.y=c?c:0,this.sub=function(a){this.x-=a.x,this.y-=a.y},this.add=function(a){this.x+=a.x,this.y+=a.y},this.distance=function(a){var c=a.x-this.x,a=a.y-this.y;return b.sqrt(c*c+a*a)},this.angleForStupidCanvasArcs=function(a){for(var c=a.x-this.x,a=a.y-this.y,d=0,d=0==c?0==a?0:a>0?b.PI/2:3*b.PI/2:0==a?c>0?0:b.PI:0>c?b.atan(a/c)+b.PI:0>a?b.atan(a/c)+2*b.PI:b.atan(a/c);0>d;)d+=2*b.PI;return d%=2*b.PI},this.angle=function(a){for(var c=a.x-this.x,a=this.y-a.y,d=0,d=0==c?0==a?0:a>0?b.PI/2:3*b.PI/2:0==a?c>0?0:b.PI:0>c?b.atan(a/c)+b.PI:0>a?b.atan(a/c)+2*b.PI:b.atan(a/c);0>d;)d+=2*b.PI;return d%=2*b.PI},!0}}(ChemDoodle.structures,Math),function(a,b,c,d,e){c.Atom=function(c,f,g,h){return this.x=f?f:0,this.y=g?g:0,this.z=h?h:0,this.numLonePair=this.charge=0,this.mass=-1,this.angleOfLeastInterference=this.bondNumber=this.coordinationNumber=0,this.isHidden=!1,this.label=c?c.replace(/\s/g,""):"C",this.altLabel=null,a[this.label]||(this.label="C"),this.isSelected=this.isHover=this.isLone=!1,this.add3D=function(a){this.x=this.x+a.x,this.y=this.y+a.y,this.z=this.z+a.z},this.sub3D=function(a){this.x=this.x-a.x,this.y=this.y-a.y,this.z=this.z-a.z},this.distance3D=function(a){var b=a.x-this.x,c=a.y-this.y,a=a.z-this.z;return d.sqrt(b*b+c*c+a*a)},this.draw=function(c,e){this.specs&&(e=this.specs);var f=e.getFontString(e.atoms_font_size_2D,e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D);if(c.font=f,c.fillStyle=e.atoms_color,e.atoms_useJMOLColors?c.fillStyle=a[this.label].jmolColor:e.atoms_usePYMOLColors&&(c.fillStyle=a[this.label].pymolColor),this.isLone&&!e.atoms_displayAllCarbonLabels_2D||e.atoms_circles_2D)c.beginPath(),c.arc(this.x,this.y,e.atoms_circleDiameter_2D/2,0,2*d.PI,!1),c.fill(),e.atoms_circleBorderWidth_2D>0&&(c.lineWidth=e.atoms_circleBorderWidth_2D,c.strokeStyle="black",c.stroke(this.x,this.y,0,2*d.PI,e.atoms_circleDiameter_2D/2));else if(this.isLabelVisible(e)){if(c.textAlign="center",c.textBaseline="middle",void 0!=this.altLabel)c.fillText(this.altLabel,this.x,this.y);else{if(c.fillText(this.label,this.x,this.y),-1!=this.mass){var g=c.measureText(this.label).width,h=e.getFontString(.7*e.atoms_font_size_2D,e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D),i=c.font;c.font=h,h=c.measureText(this.mass).width,c.fillText(this.mass,this.x-h-.5,this.y-.3*e.atoms_font_size_2D),c.font=i}if(i=this.getImplicitHydrogenCount(),e.atoms_implicitHydrogens_2D&&i>0){var g=c.measureText(this.label).width,j=c.measureText("H").width;if(i>1){var k=g/2+j/2,l=0,h=e.getFontString(.8*e.atoms_font_size_2D,e.atoms_font_families_2D,e.atoms_font_bold_2D,e.atoms_font_italic_2D);c.font=h;var m=c.measureText(i).width;1==this.bondNumber?this.angleOfLeastInterference>d.PI/2&&this.angleOfLeastInterference<3*d.PI/2&&(k=-g/2-m-j/2):this.angleOfLeastInterference<=d.PI/4||(this.angleOfLeastInterference<3*d.PI/4?(k=0,l=.9*-e.atoms_font_size_2D):this.angleOfLeastInterference<=5*d.PI/4?k=-g/2-m-j/2:this.angleOfLeastInterference<7*d.PI/4&&(k=0,l=.9*e.atoms_font_size_2D)),c.font=f,c.fillText("H",this.x+k,this.y+l),c.font=h,c.fillText(i,this.x+k+j/2+m/2,this.y+l+.3*e.atoms_font_size_2D)
}else k=g/2+j/2,l=0,1==this.bondNumber?this.angleOfLeastInterference>d.PI/2&&this.angleOfLeastInterference<3*d.PI/2&&(k=-g/2-j/2):this.angleOfLeastInterference<=d.PI/4||(this.angleOfLeastInterference<3*d.PI/4?(k=0,l=.9*-e.atoms_font_size_2D):this.angleOfLeastInterference<=5*d.PI/4?k=-g/2-j/2:this.angleOfLeastInterference<7*d.PI/4&&(k=0,l=.9*e.atoms_font_size_2D)),c.fillText("H",this.x+k,this.y+l)}}0!=this.charge&&(f=this.charge.toFixed(0),f="1"==f?"+":"-1"==f?"–":b.stringStartsWith(f,"-")?f.substring(1)+"–":f+"+",h=this.angleOfLeastInterference,g=e.atoms_font_size_2D,this.isLabelVisible(e)&&i>0&&(h+=d.PI/4),c.textAlign="center",c.textBaseline="middle",c.fillText(f,this.x+g*d.cos(h),this.y-g*d.sin(h))),this.numLonePair>0&&(c.fillStyle="black",2==this.bondNumber&&d.abs(this.largestAngle-d.PI)<d.PI/60?(this.drawLonePairs(c,e,d.floor(this.numLonePair/2),this.angleOfLeastInterference,this.largestAngle),this.drawLonePairs(c,e,d.floor(this.numLonePair/2)+this.numLonePair%2,this.angleOfLeastInterference+d.PI,this.largestAngle)):this.drawLonePairs(c,e,this.numLonePair,this.angleOfLeastInterference,this.largestAngle))}},this.drawLonePairs=function(a,b,c,e,f){for(var g=f/(c+(0==this.bondNumber?0:1)),f=e-f/2+g,h=0;c>h;h++){var e=f+h*g,i=this.x+Math.cos(e)*b.atoms_lonePairDistance_2D,j=this.y-Math.sin(e)*b.atoms_lonePairDistance_2D,k=e+Math.PI/2,e=Math.cos(k)*b.atoms_lonePairSpread_2D/2,k=-Math.sin(k)*b.atoms_lonePairSpread_2D/2;a.beginPath(),a.arc(i+e,j+k,b.atoms_lonePairDiameter_2D,0,2*d.PI,!1),a.fill(),a.beginPath(),a.arc(i-e,j-k,b.atoms_lonePairDiameter_2D,0,2*d.PI,!1),a.fill()}},this.drawDecorations=function(a){(this.isHover||this.isSelected)&&(a.strokeStyle=this.isHover?"#885110":"#0060B2",a.lineWidth=1.2,a.beginPath(),a.arc(this.x,this.y,this.isHover?7:15,0,2*d.PI,!1),a.stroke())},this.render=function(b,c){this.specs&&(c=this.specs);var d=e.translate(b.modelViewMatrix,[this.x,this.y,this.z],[]),f=c.atoms_useVDWDiameters_3D?a[this.label].vdWRadius*c.atoms_vdwMultiplier_3D:c.atoms_sphereDiameter_3D/2;0==f&&(f=1),e.scale(d,[f,f,f]),f=c.atoms_color,c.atoms_useJMOLColors?f=a[this.label].jmolColor:c.atoms_usePYMOLColors&&(f=a[this.label].pymolColor),b.material.setDiffuseColor(f),b.setMatrixUniforms(d),b.drawElements(b.TRIANGLES,(this.renderAsStar?b.starBuffer:b.sphereBuffer).vertexIndexBuffer.numItems,b.UNSIGNED_SHORT,0)},this.isLabelVisible=function(a){return a.atoms_displayAllCarbonLabels_2D||"C"!=this.label||this.altLabel||-1!=this.mass||0!=this.charge||0!=this.numLonePair||this.isHidden&&a.atoms_showHiddenCarbons_2D||a.atoms_displayTerminalCarbonLabels_2D&&1==this.bondNumber},this.getImplicitHydrogenCount=function(){if("H"==this.label||null==a[this.label])return 0;var b=a[this.label].valency,c=b-this.coordinationNumber;return this.charge>0?(b=4-b,c=this.charge<=b?c+this.charge:4-this.coordinationNumber-this.charge+b):c+=this.charge,0>c?0:c},!0},c.Atom.prototype=new c.Point(0,0)}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,Math,mat4),function(a,b,c,d,e,f){c.Bond=function(g,h,i){return this.a1=g,this.a2=h,this.bondOrder=i?i:1,this.stereo=c.Bond.STEREO_NONE,this.isHover=!1,this.ring=null,this.getCenter=function(){return new c.Point((this.a1.x+this.a2.x)/2,(this.a1.y+this.a2.y)/2)},this.getLength=function(){return this.a1.distance(this.a2)},this.getLength3D=function(){return this.a1.distance3D(this.a2)},this.contains=function(a){return a==this.a1||a==this.a2},this.getNeighbor=function(a){return a==this.a1?this.a2:a==this.a2?this.a1:null},this.draw=function(e,f){this.specs&&(f=this.specs);var g=this.a1.x,h=this.a2.x,i=this.a1.y,j=this.a2.y,k=h-g,l=j-i;if(f.atoms_display&&!f.atoms_circles_2D&&this.a1.isLabelVisible(f)&&(g+=k*f.bonds_atomLabelBuffer_2D,i+=l*f.bonds_atomLabelBuffer_2D),f.atoms_display&&!f.atoms_circles_2D&&this.a2.isLabelVisible(f)&&(h-=k*f.bonds_atomLabelBuffer_2D,j-=l*f.bonds_atomLabelBuffer_2D),f.bonds_clearOverlaps_2D){var m=g+.15*k,n=i+.15*l,o=h-.15*k,p=j-.15*l;e.strokeStyle=f.backgroundColor,e.lineWidth=f.bonds_width_2D+2*f.bonds_overlapClearWidth_2D,e.lineCap="round",e.beginPath(),e.moveTo(m,n),e.lineTo(o,p),e.closePath(),e.stroke()}switch(e.strokeStyle=f.bonds_color,e.fillStyle=f.bonds_color,e.lineWidth=f.bonds_width_2D,e.lineCap=f.bonds_ends_2D,(f.bonds_useJMOLColors||f.bonds_usePYMOLColors)&&(m=e.createLinearGradient(g,i,h,j),n=a[this.a1.label].jmolColor,o=a[this.a2.label].jmolColor,f.atoms_usePYMOLColors&&(n=a[this.a1.label].pymolColor,o=a[this.a2.label].pymolColor),m.addColorStop(0,n),f.bonds_colorGradient||(m.addColorStop(.5,n),m.addColorStop(.51,o)),m.addColorStop(1,o),e.strokeStyle=m,e.fillStyle=m),this.bondOrder){case.5:e.beginPath(),e.moveTo(g,i),b.contextHashTo(e,g,i,h,j,f.bonds_hashSpacing_2D,f.bonds_hashSpacing_2D),e.stroke();break;case 1:if(this.stereo==c.Bond.STEREO_PROTRUDING||this.stereo==c.Bond.STEREO_RECESSED){var q=f.bonds_width_2D/2,l=this.a1.distance(this.a2)*f.bonds_wedgeThickness_2D/2,m=this.a1.angle(this.a2)+d.PI/2,n=d.cos(m),m=d.sin(m),k=g-n*q,o=i+m*q,p=g+n*q,q=i-m*q,r=h+n*l,s=j-m*l,n=h-n*l,m=j+m*l;e.beginPath(),e.moveTo(k,o),e.lineTo(p,q),e.lineTo(r,s),e.lineTo(n,m),e.closePath(),this.stereo==c.Bond.STEREO_PROTRUDING?e.fill():(e.save(),e.clip(),e.lineWidth=2*l,e.lineCap="butt",e.beginPath(),e.moveTo(g,i),b.contextHashTo(e,g,i,h,j,f.bonds_hashWidth_2D,f.bonds_hashSpacing_2D),e.stroke(),e.restore())}else{if(this.stereo==c.Bond.STEREO_AMBIGUOUS){for(e.beginPath(),e.moveTo(g,i),j=d.floor(d.sqrt(k*k+l*l)/f.bonds_wavyLength_2D),m=this.a1.angle(this.a2)+d.PI/2,n=d.cos(m),m=d.sin(m),h=k/j,l/=j,r=0;j>r;r++)g+=h,i+=l,k=f.bonds_wavyLength_2D*n+g-.5*h,p=f.bonds_wavyLength_2D*-m+i-.5*l,o=f.bonds_wavyLength_2D*-n+g-.5*h,q=f.bonds_wavyLength_2D*m+i-.5*l,0==r%2?e.quadraticCurveTo(k,p,g,i):e.quadraticCurveTo(o,q,g,i);e.stroke();break}e.beginPath(),e.moveTo(g,i),e.lineTo(h,j),e.stroke()}break;case 1.5:e.beginPath(),e.moveTo(g,i),e.lineTo(h,j),e.stroke();break;case 2:this.stereo==c.Bond.STEREO_AMBIGUOUS?(l=this.a1.distance(this.a2)*f.bonds_saturationWidth_2D/2,m=this.a1.angle(this.a2)+d.PI/2,k=g-d.cos(m)*l,o=i+d.sin(m)*l,p=g+d.cos(m)*l,q=i-d.sin(m)*l,r=h+d.cos(m)*l,s=j-d.sin(m)*l,n=h-d.cos(m)*l,m=j+d.sin(m)*l,e.beginPath(),e.moveTo(k,o),e.lineTo(r,s),e.moveTo(p,q),e.lineTo(n,m),e.stroke()):f.bonds_symmetrical_2D||null==this.ring&&("C"!=this.a1.label||"C"!=this.a2.label)?(l=this.a1.distance(this.a2)*f.bonds_saturationWidth_2D/2,m=this.a1.angle(this.a2)+d.PI/2,k=g-d.cos(m)*l,o=i+d.sin(m)*l,p=g+d.cos(m)*l,q=i-d.sin(m)*l,r=h+d.cos(m)*l,s=j-d.sin(m)*l,n=h-d.cos(m)*l,m=j+d.sin(m)*l,e.beginPath(),e.moveTo(k,o),e.lineTo(n,m),e.moveTo(p,q),e.lineTo(r,s),e.stroke()):(e.beginPath(),e.moveTo(g,i),e.lineTo(h,j),n=0,o=this.a1.distance(this.a2),k=this.a1.angle(this.a2),m=k+d.PI/2,l=o*f.bonds_saturationWidth_2D,p=f.bonds_saturationAngle_2D,p<d.PI/2&&(n=-(l/d.tan(p))),d.abs(n)<o/2&&(p=g-d.cos(k)*n,g=h+d.cos(k)*n,h=i+d.sin(k)*n,i=j-d.sin(k)*n,k=p-d.cos(m)*l,o=h+d.sin(m)*l,p+=d.cos(m)*l,q=h-d.sin(m)*l,r=g-d.cos(m)*l,s=i+d.sin(m)*l,n=g+d.cos(m)*l,m=i-d.sin(m)*l,null==this.ring||this.ring.center.angle(this.a1)>this.ring.center.angle(this.a2)&&!(this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)>d.PI)||this.ring.center.angle(this.a1)-this.ring.center.angle(this.a2)<-d.PI?(e.moveTo(k,o),e.lineTo(r,s)):(e.moveTo(p,q),e.lineTo(n,m)),e.stroke()));break;case 3:l=this.a1.distance(this.a2)*f.bonds_saturationWidth_2D,m=this.a1.angle(this.a2)+d.PI/2,k=g-d.cos(m)*l,o=i+d.sin(m)*l,p=g+d.cos(m)*l,q=i-d.sin(m)*l,r=h+d.cos(m)*l,s=j-d.sin(m)*l,n=h-d.cos(m)*l,m=j+d.sin(m)*l,e.beginPath(),e.moveTo(k,o),e.lineTo(n,m),e.moveTo(p,q),e.lineTo(r,s),e.moveTo(g,i),e.lineTo(h,j),e.stroke()}},this.drawDecorations=function(a){if(this.isHover||this.isSelected){var b=2*d.PI,c=(this.a1.angleForStupidCanvasArcs(this.a2)+d.PI/2)%b;a.strokeStyle=this.isHover?"#885110":"#0060B2",a.lineWidth=1.2,a.beginPath();var e=(c+d.PI)%b,e=e%(2*d.PI);a.arc(this.a1.x,this.a1.y,7,c,e,!1),a.stroke(),a.beginPath(),c+=d.PI,e=(c+d.PI)%b,a.arc(this.a2.x,this.a2.y,7,c,e,!1),a.stroke()}},this.render=function(c,g){this.specs&&(g=this.specs);var h=(g.bonds_renderAsLines_3D?1.1:1.001)*this.a1.distance3D(this.a2)/(g.bonds_useJMOLColors||g.bonds_usePYMOLColors?2:1);if(0==h)return!1;var h=[g.bonds_cylinderDiameter_3D/2,h,g.bonds_cylinderDiameter_3D/2],i=e.translate(c.modelViewMatrix,[this.a1.x,this.a1.y,this.a1.z],[]),j=null,k=[this.a2.x-this.a1.x,this.a2.y-this.a1.y,this.a2.z-this.a1.z];(g.bonds_useJMOLColors||g.bonds_usePYMOLColors)&&(f.scale(k,.5),j=e.translate(c.modelViewMatrix,[this.a2.x,this.a2.y,this.a2.z],[]));var l=[0],m=null;if(g.bonds_showBondOrders_3D){switch(this.bondOrder){case 2:l=[-g.bonds_cylinderDiameter_3D,g.bonds_cylinderDiameter_3D];break;case 3:l=[-1.2*g.bonds_cylinderDiameter_3D,0,1.2*g.bonds_cylinderDiameter_3D]}if(1<l.length){var m=[0,0,1],n=e.inverse(c.rotationMatrix,[]);e.multiplyVec3(n,m),m=f.cross(k,m,[]),f.normalize(m)}}var o=[0,1,0],n=0,p=null;for(this.a1.x==this.a2.x&&this.a1.z==this.a2.z?(p=[0,0,1],this.a2.y<this.a1.y&&(n=d.PI)):(n=b.vec3AngleFrom(o,k),p=f.cross(o,k,[])),k=0,o=l.length;o>k;k++){var q=e.set(i,[]);0!=l[k]&&e.translate(q,f.scale(m,l[k],[])),0!=n&&e.rotate(q,n,p),e.scale(q,h);var r=g.bonds_color;g.bonds_useJMOLColors?r=a[this.a1.label].jmolColor:g.bonds_usePYMOLColors&&(r=a[this.a1.label].pymolColor),c.material.setDiffuseColor(r),c.setMatrixUniforms(q),g.bonds_renderAsLines_3D?c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems):c.drawArrays(c.TRIANGLE_STRIP,0,c.cylinderBuffer.vertexPositionBuffer.numItems),(g.bonds_useJMOLColors||g.bonds_usePYMOLColors)&&(e.set(j,q),0!=l[k]&&e.translate(q,f.scale(m,l[k],[])),e.rotate(q,n+d.PI,p),e.scale(q,h),c.material.setDiffuseColor(g.bonds_usePYMOLColors?a[this.a2.label].pymolColor:a[this.a2.label].jmolColor),c.setMatrixUniforms(q),g.bonds_renderAsLines_3D?c.drawArrays(c.LINES,0,c.lineBuffer.vertexPositionBuffer.numItems):c.drawArrays(c.TRIANGLE_STRIP,0,c.cylinderBuffer.vertexPositionBuffer.numItems))}},!0},c.Bond.STEREO_NONE="none",c.Bond.STEREO_PROTRUDING="protruding",c.Bond.STEREO_RECESSED="recessed",c.Bond.STEREO_AMBIGUOUS="ambiguous"}(ChemDoodle.ELEMENT,ChemDoodle.extensions,ChemDoodle.structures,Math,mat4,vec3),function(a,b){a.Ring=function(){return this.atoms=[],this.bonds=[],this.center=null,this.setupBonds=function(){for(var a=0,b=this.bonds.length;b>a;a++)this.bonds[a].ring=this;this.center=this.getCenter()},this.getCenter=function(){for(var c=minY=1/0,d=maxY=-1/0,e=0,f=this.atoms.length;f>e;e++)c=b.min(this.atoms[e].x,c),minY=b.min(this.atoms[e].y,minY),d=b.max(this.atoms[e].x,d),maxY=b.max(this.atoms[e].y,maxY);return new a.Point((d+c)/2,(maxY+minY)/2)},!0}}(ChemDoodle.structures,Math),function(a,b,c,d,e){c.Molecule=function(){return this.atoms=[],this.bonds=[],this.rings=[],this.findRings=!0,this.draw=function(a,b){if(this.specs&&(b=this.specs),b.bonds_display)for(var c=0,d=this.bonds.length;d>c;c++)this.bonds[c].draw(a,b);if(b.atoms_display)for(c=0,d=this.atoms.length;d>c;c++)this.atoms[c].draw(a,b)},this.render=function(a,b){this.specs&&(b=this.specs);var e=0<this.atoms.length&&void 0!=this.atoms[0].hetatm;if(e){if(b.macro_displayBonds){0<this.bonds.length&&(b.bonds_renderAsLines_3D&&!this.residueSpecs||this.residueSpecs&&this.residueSpecs.bonds_renderAsLines_3D?(a.lineWidth(this.residueSpecs?this.residueSpecs.bonds_width_2D:b.bonds_width_2D),a.lineBuffer.bindBuffers(a)):a.cylinderBuffer.bindBuffers(a),a.material.setTempColors(b.bonds_materialAmbientColor_3D,null,b.bonds_materialSpecularColor_3D,b.bonds_materialShininess_3D));for(var f=0,g=this.bonds.length;g>f;f++){var h=this.bonds[f];!h.a1.hetatm&&(-1==b.macro_atomToLigandDistance||void 0!=h.a1.closestDistance&&b.macro_atomToLigandDistance>=h.a1.closestDistance&&b.macro_atomToLigandDistance>=h.a2.closestDistance)&&h.render(a,this.residueSpecs?this.residueSpecs:b)}}if(b.macro_displayAtoms)for(0<this.atoms.length&&(a.sphereBuffer.bindBuffers(a),a.material.setTempColors(b.atoms_materialAmbientColor_3D,null,b.atoms_materialSpecularColor_3D,b.atoms_materialShininess_3D)),f=0,g=this.atoms.length;g>f;f++){var i=this.atoms[f];!i.hetatm&&(-1==b.macro_atomToLigandDistance||void 0!=i.closestDistance&&b.macro_atomToLigandDistance>=i.closestDistance)&&i.render(a,this.residueSpecs?this.residueSpecs:b)}}if(b.bonds_display)for(0<this.bonds.length&&(b.bonds_renderAsLines_3D?(a.lineWidth(b.bonds_width_2D),a.lineBuffer.bindBuffers(a)):a.cylinderBuffer.bindBuffers(a),a.material.setTempColors(b.bonds_materialAmbientColor_3D,null,b.bonds_materialSpecularColor_3D,b.bonds_materialShininess_3D)),f=0,g=this.bonds.length;g>f;f++)h=this.bonds[f],(!e||h.a1.hetatm)&&h.render(a,b);if(b.atoms_display){for(f=0,g=this.atoms.length;g>f;f++)i=this.atoms[f],i.bondNumber=0,i.renderAsStar=!1;for(f=0,g=this.bonds.length;g>f;f++)h=this.bonds[f],h.a1.bondNumber++,h.a2.bondNumber++;for(0<this.atoms.length&&(a.sphereBuffer.bindBuffers(a),a.material.setTempColors(b.atoms_materialAmbientColor_3D,null,b.atoms_materialSpecularColor_3D,b.atoms_materialShininess_3D)),h=[],f=0,g=this.atoms.length;g>f;f++)i=this.atoms[f],(!e||i.hetatm&&(b.macro_showWater||!i.isWater))&&(b.atoms_nonBondedAsStars_3D&&0==i.bondNumber?(i.renderAsStar=!0,h.push(i)):i.render(a,b));if(0<h.length)for(a.starBuffer.bindBuffers(a),f=0,g=h.length;g>f;f++)h[f].render(a,b)}if(this.chains){if(a.setMatrixUniforms(a.modelViewMatrix),b.proteins_displayRibbon)for(a.material.setTempColors(b.proteins_materialAmbientColor_3D,null,b.proteins_materialSpecularColor_3D,b.proteins_materialShininess_3D),e=0,i=this.ribbons.length;i>e;e++)if(b.proteins_useShapelyColors||b.proteins_useAminoColors||b.proteins_usePolarityColors){for(h=b.proteins_ribbonCartoonize?this.cartoons[e]:this.ribbons[e],h.front.bindBuffers(a),f=0,g=h.front.segments.length;g>f;f++)h.front.segments[f].render(a,b);for(h.back.bindBuffers(a),f=0,g=h.back.segments.length;g>f;f++)h.back.segments[f].render(a,b)}else if(b.proteins_ribbonCartoonize){for(h=this.cartoons[e],h.front.bindBuffers(a),f=0,g=h.front.cartoonSegments.length;g>f;f++)h.front.cartoonSegments[f].render(a,b);for(h.back.bindBuffers(a),f=0,g=h.back.cartoonSegments.length;g>f;f++)h.back.cartoonSegments[f].render(a,b)}else h=this.ribbons[e],h.front.render(a,b),h.back.render(a,b);if(b.proteins_displayBackbone){if(!this.alphaCarbonTrace)for(this.alphaCarbonTrace={nodes:[],edges:[]},e=0,i=this.chains.length;i>e;e++){var j=this.chains[e];if(!(2<j.length&&d[j[2].name]&&"#BEA06E"==d[j[2].name].aminoColor)&&0<j.length)for(f=1,g=j.length-2;g>f;f++)h=j[f].cp1,h.chainColor=j.chainColor,this.alphaCarbonTrace.nodes.push(h),h=new c.Bond(j[f].cp1,j[f+1].cp1),h.residueName=j[f].name,h.chainColor=j.chainColor,this.alphaCarbonTrace.edges.push(h),f==j.length-3&&(h=j[f+1].cp1,h.chainColor=j.chainColor,this.alphaCarbonTrace.nodes.push(h))}if(0<this.alphaCarbonTrace.nodes.length){for(e=new c.VisualSpecifications,e.atoms_display=!0,e.bonds_display=!0,e.atoms_sphereDiameter_3D=b.proteins_backboneThickness,e.bonds_cylinderDiameter_3D=b.proteins_backboneThickness,e.bonds_useJMOLColors=!1,e.atoms_color=b.proteins_backboneColor,e.bonds_color=b.proteins_backboneColor,e.atoms_useVDWDiameters_3D=!1,a.material.setTempColors(b.proteins_materialAmbientColor_3D,null,b.proteins_materialSpecularColor_3D,b.proteins_materialShininess_3D),a.material.setDiffuseColor(b.proteins_backboneColor),f=0,g=this.alphaCarbonTrace.nodes.length;g>f;f++)h=this.alphaCarbonTrace.nodes[f],b.macro_colorByChain&&(e.atoms_color=h.chainColor),a.sphereBuffer.bindBuffers(a),h.render(a,e);for(f=0,g=this.alphaCarbonTrace.edges.length;g>f;f++)i=this.alphaCarbonTrace.edges[f],h=null,j=d[i.residueName]?d[i.residueName]:d["*"],b.macro_colorByChain?h=i.chainColor:b.proteins_useShapelyColors?h=j.shapelyColor:b.proteins_useAminoColors?h=j.aminoColor:b.proteins_usePolarityColors&&(h=j.polar?"#C10000":"#FFFFFF"),null!=h&&(e.bonds_color=h),a.cylinderBuffer.bindBuffers(a),i.render(a,e)}}if(b.nucleics_display)for(a.material.setTempColors(b.nucleics_materialAmbientColor_3D,null,b.nucleics_materialSpecularColor_3D,b.nucleics_materialShininess_3D),e=0,i=this.tubes.length;i>e;e++)a.setMatrixUniforms(a.modelViewMatrix),h=this.tubes[e],h.render(a,b)}b.crystals_displayUnitCell&&this.unitCell&&(a.setMatrixUniforms(a.modelViewMatrix),this.unitCell.bindBuffers(a),a.material.setDiffuseColor(b.crystals_unitCellColor),a.lineWidth(b.crystals_unitCellLineWidth),a.drawElements(a.LINES,this.unitCell.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)),this.surface&&b.surfaces_display&&(a.setMatrixUniforms(a.modelViewMatrix),this.surface.bindBuffers(a),a.material.setTempColors(b.surfaces_materialAmbientColor_3D,b.surfaces_color,b.surfaces_materialSpecularColor_3D,b.surfaces_materialShininess_3D),"Dot"==b.surfaces_style?a.drawArrays(a.POINTS,0,this.surface.vertexPositionBuffer.numItems):a.drawElements(a.TRIANGLES,this.surface.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0))},this.getCenter3D=function(){if(1==this.atoms.length)return new c.Atom("C",this.atoms[0].x,this.atoms[0].y,this.atoms[0].z);var a=minY=minZ=1/0,b=maxY=maxZ=-1/0;if(this.chains)for(var d=0,f=this.chains.length;f>d;d++)for(var g=this.chains[d],h=0,i=g.length;i>h;h++){var j=g[h],a=e.min(j.cp1.x,a);minY=e.min(j.cp1.y,minY),minZ=e.min(j.cp1.z,minZ),b=e.max(j.cp1.x,b),maxY=e.max(j.cp1.y,maxY),maxZ=e.max(j.cp1.z,maxZ),a=e.min(j.cp2.x,a),minY=e.min(j.cp2.y,minY),minZ=e.min(j.cp2.z,minZ),b=e.max(j.cp2.x,b),maxY=e.max(j.cp2.y,maxY),maxZ=e.max(j.cp2.z,maxZ)}for(d=0,f=this.atoms.length;f>d;d++)a=e.min(this.atoms[d].x,a),minY=e.min(this.atoms[d].y,minY),minZ=e.min(this.atoms[d].z,minZ),b=e.max(this.atoms[d].x,b),maxY=e.max(this.atoms[d].y,maxY),maxZ=e.max(this.atoms[d].z,maxZ);return new c.Atom("C",(b+a)/2,(maxY+minY)/2,(maxZ+minZ)/2)},this.getCenter=function(){if(1==this.atoms.length)return new c.Point(this.atoms[0].x,this.atoms[0].y);for(var a=minY=1/0,b=maxY=-1/0,d=0,f=this.atoms.length;f>d;d++)a=e.min(this.atoms[d].x,a),minY=e.min(this.atoms[d].y,minY),b=e.max(this.atoms[d].x,b),maxY=e.max(this.atoms[d].y,maxY);return new c.Point((b+a)/2,(maxY+minY)/2)},this.getDimension=function(){if(1==this.atoms.length)return new c.Point(0,0);var a=minY=1/0,b=maxY=-1/0;if(this.chains){for(var d=0,f=this.chains.length;f>d;d++)for(var g=this.chains[d],h=0,i=g.length;i>h;h++){var j=g[h],a=e.min(j.cp1.x,a);minY=e.min(j.cp1.y,minY),b=e.max(j.cp1.x,b),maxY=e.max(j.cp1.y,maxY),a=e.min(j.cp2.x,a),minY=e.min(j.cp2.y,minY),b=e.max(j.cp2.x,b),maxY=e.max(j.cp2.y,maxY)}a-=30,minY-=30,minZ-=30,b+=30,maxY+=30,maxZ+=30}for(d=0,f=this.atoms.length;f>d;d++)a=e.min(this.atoms[d].x,a),minY=e.min(this.atoms[d].y,minY),b=e.max(this.atoms[d].x,b),maxY=e.max(this.atoms[d].y,maxY);return new c.Point(b-a,maxY-minY)},this.check=function(){if(this.findRings){this.rings=new a.informatics.SSSRFinder(this).rings;for(var b=0,c=this.bonds.length;c>b;b++)this.bonds[b].ring=null;for(b=0,c=this.rings.length;c>b;b++)this.rings[b].setupBonds()}for(b=0,c=this.atoms.length;c>b;b++)if(this.atoms[b].isLone=!1,"C"==this.atoms[b].label){for(var d=0,e=0,f=this.bonds.length;f>e;e++)(this.bonds[e].a1==this.atoms[b]||this.bonds[e].a2==this.atoms[b])&&d++;0==d&&(this.atoms[b].isLone=!0)}for(d=!1,b=0,c=this.atoms.length;c>b;b++)0!=this.atoms[b].z&&(d=!0);d&&(this.sortAtomsByZ(),this.sortBondsByZ()),this.setupMetaData()},this.getAngles=function(a){for(var b=[],c=0,d=this.bonds.length;d>c;c++)this.bonds[c].contains(a)&&b.push(a.angle(this.bonds[c].getNeighbor(a)));return b.sort(),b},this.getCoordinationNumber=function(a){for(var b=0,c=0,d=a.length;d>c;c++)b+=a[c].bondOrder;return b},this.getBonds=function(a){for(var b=[],c=0,d=this.bonds.length;d>c;c++)this.bonds[c].contains(a)&&b.push(this.bonds[c]);return b},this.sortAtomsByZ=function(){for(var a=1,b=this.atoms.length;b>a;a++)for(var c=a;c>0&&this.atoms[c].z<this.atoms[c-1].z;){var d=this.atoms[c];this.atoms[c]=this.atoms[c-1],this.atoms[c-1]=d,c--}},this.sortBondsByZ=function(){for(var a=1,b=this.bonds.length;b>a;a++)for(var c=a;c>0&&this.bonds[c].a1.z+this.bonds[c].a2.z<this.bonds[c-1].a1.z+this.bonds[c-1].a2.z;){var d=this.bonds[c];this.bonds[c]=this.bonds[c-1],this.bonds[c-1]=d,c--}},this.setupMetaData=function(){for(var b=0,c=this.atoms.length;c>b;b++){var d=this.atoms[b],f=this.getBonds(d),g=this.getAngles(d);d.isHidden=2==f.length&&e.abs(e.abs(g[1]-g[0])-e.PI)<e.PI/30&&f[0].bondOrder==f[1].bondOrder,g=a.math.angleBetweenLargest(g),d.angleOfLeastInterference=g.angle%(2*e.PI),d.largestAngle=g.largest,d.coordinationNumber=this.getCoordinationNumber(f),d.bondNumber=f.length}},this.scaleToAverageBondLength=function(a){var b=this.getAverageBondLength();if(0!=b)for(var a=a/b,b=0,c=this.atoms.length;c>b;b++)this.atoms[b].x*=a,this.atoms[b].y*=a},this.getAverageBondLength=function(){if(0==this.bonds.length)return 0;for(var a=0,b=0,c=this.bonds.length;c>b;b++)a+=this.bonds[b].getLength();return a/=this.bonds.length},!0}}(ChemDoodle,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math),function(a,b,c,d){var e=c.multiply([-1/6,.5,-.5,1/6,.5,-1,.5,0,-.5,0,.5,0,1/6,2/3,1/6,0],[.006,0,0,0,.006,.02,0,0,.001,.01,.1,0,0,0,0,1],[]);a.Residue=function(f){this.Ns=9,this.resSeq=f,this.setup=function(b){var c=[b.x-this.cp1.x,b.y-this.cp1.y,b.z-this.cp1.z],e=d.cross(c,[this.cp2.x-this.cp1.x,this.cp2.y-this.cp1.y,this.cp2.z-this.cp1.z],[]);for(this.D=d.cross(e,c,[]),d.normalize(e),d.normalize(this.D),this.guidePointsSmall=[],this.guidePointsLarge=[],b=[(b.x+this.cp1.x)/2,(b.y+this.cp1.y)/2,(b.z+this.cp1.z)/2],this.helix&&(d.scale(e,1.5),d.add(b,e)),this.guidePointsSmall[0]=new a.Atom("",b[0]-this.D[0]/2,b[1]-this.D[1]/2,b[2]-this.D[2]/2),e=1;e<this.Ns;e++)this.guidePointsSmall[e]=new a.Atom("",this.guidePointsSmall[0].x+this.D[0]*e/this.Ns,this.guidePointsSmall[0].y+this.D[1]*e/this.Ns,this.guidePointsSmall[0].z+this.D[2]*e/this.Ns);for(d.scale(this.D,4),this.guidePointsLarge[0]=new a.Atom("",b[0]-this.D[0]/2,b[1]-this.D[1]/2,b[2]-this.D[2]/2),e=1;e<this.Ns;e++)this.guidePointsLarge[e]=new a.Atom("",this.guidePointsLarge[0].x+this.D[0]*e/this.Ns,this.guidePointsLarge[0].y+this.D[1]*e/this.Ns,this.guidePointsLarge[0].z+this.D[2]*e/this.Ns)},this.getGuidePointSet=function(a){return 0==a?this.helix||this.sheet?this.guidePointsLarge:this.guidePointsSmall:1==a?this.guidePointsSmall:2==a?this.guidePointsLarge:void 0},this.computeLineSegments=function(a,b,c,d){this.split=b.helix!=this.helix||b.sheet!=this.sheet,this.lineSegments=this.innerCompute(0,a,b,c,!1),d&&(this.lineSegmentsCartoon=this.innerCompute(b.helix||b.sheet?2:1,a,b,c,!0))},this.innerCompute=function(f,g,h,i,j){for(var k=[],l=this.getGuidePointSet(f),g=g.getGuidePointSet(f),h=h.getGuidePointSet(f),m=i.getGuidePointSet(f),n=0,o=this.guidePointsLarge.length;o>n;n++){for(var p=c.multiply([g[n].x,g[n].y,g[n].z,1,l[n].x,l[n].y,l[n].z,1,h[n].x,h[n].y,h[n].z,1,m[n].x,m[n].y,m[n].z,1],e,[]),q=[],r=0;10>r;r++){for(f=3;f>0;f--)for(i=0;4>i;i++)p[4*f+i]+=p[4*(f-1)+i];q[r]=new a.Atom("",p[12]/p[15],p[13]/p[15],p[14]/p[15])}k[n]=q}if(j&&this.arrow)for(f=0;10>f;f++)for(j=1.5-1.3*f/10,l=b.floor(this.Ns/2),g=k[l],i=0,h=k.length;h>i;i++)i!=l&&(m=g[f],n=k[i][f],o=[n.x-m.x,n.y-m.y,n.z-m.z],d.scale(o,j),n.x=m.x+o[0],n.y=m.y+o[1],n.z=m.z+o[2]);return k}}}(ChemDoodle.structures,Math,mat4,vec3),function(a,b,c,d,e){b.Spectrum=function(){this.data=[],this.metadata=[],this.dataDisplay=[],this.yUnit=this.xUnit=this.title=null,this.continuous=!0,this.integrationSensitivity=.01;var f=0,g=!1;return this.draw=function(c,h,i,j){var k=5,l=0,m=0;c.fillStyle=h.text_color,c.textAlign="center",c.textBaseline="alphabetic",c.font=h.getFontString(h.text_font_size,h.text_font_families),this.xUnit&&(m+=h.text_font_size,c.fillText(this.xUnit,i/2,j-2)),this.yUnit&&h.plots_showYAxis&&(l+=h.text_font_size,c.save(),c.translate(h.text_font_size,j/2),c.rotate(-e.PI/2),c.fillText(this.yUnit,0,0),c.restore()),null!=this.title&&(k+=h.text_font_size,c.fillText(this.title,i/2,h.text_font_size)),m+=5+h.text_font_size,h.plots_showYAxis&&(l+=5+c.measureText("1000").width),h.plots_showGrid&&(c.strokeStyle=h.plots_gridColor,c.lineWidth=h.plots_gridLineWidth,c.strokeRect(l,k,i-l,j-m-k)),c.textAlign="center",c.textBaseline="top";for(var n=this.maxX-this.minX,o=n/100,p=.001;o>p||n/p>25;)p*=10;for(var q=0,r=h.plots_flipXAxis?i:0,n=e.round(this.minX/p)*p;n<=this.maxX;n+=p/2){if(o=this.getTransformedX(n,h,i,l),o>l)if(c.strokeStyle="black",c.lineWidth=1,0==q%2){c.beginPath(),c.moveTo(o,j-m),c.lineTo(o,j-m+2),c.stroke();for(var s=n.toFixed(5);"0"==s.charAt(s.length-1);)s=s.substring(0,s.length-1);"."==s.charAt(s.length-1)&&(s=s.substring(0,s.length-1));var t=c.measureText(s).width;h.plots_flipXAxis&&(t*=-1);var u=o-t/2;(h.plots_flipXAxis?r>u:u>r)&&(c.fillText(s,o,j-m+2),r=o+t/2),h.plots_showGrid&&(c.strokeStyle=h.plots_gridColor,c.lineWidth=h.plots_gridLineWidth,c.beginPath(),c.moveTo(o,j-m),c.lineTo(o,k),c.stroke())}else c.beginPath(),c.moveTo(o,j-m),c.lineTo(o,j-m+2),c.stroke();q++}if(h.plots_showYAxis||h.plots_showGrid)for(o=1/h.scale,c.textAlign="right",c.textBaseline="middle",n=0;10>=n;n++)if(s=o/10*n,p=k+(j-m-k)*(1-s*h.scale),h.plots_showGrid&&(c.strokeStyle=h.plots_gridColor,c.lineWidth=h.plots_gridLineWidth,c.beginPath(),c.moveTo(l,p),c.lineTo(i,p),c.stroke()),h.plots_showYAxis){if(c.strokeStyle="black",c.lineWidth=1,c.beginPath(),c.moveTo(l,p),c.lineTo(l-3,p),c.stroke(),s*=100,q=e.max(0,3-e.floor(s).toString().length),s=s.toFixed(q),q>0)for(;"0"==s.charAt(s.length-1);)s=s.substring(0,s.length-1);"."==s.charAt(s.length-1)&&(s=s.substring(0,s.length-1)),c.fillText(s,l-3,p)}if(c.strokeStyle="black",c.lineWidth=1,c.beginPath(),c.moveTo(i,j-m),c.lineTo(l,j-m),h.plots_showYAxis&&c.lineTo(l,k),c.stroke(),0<this.dataDisplay.length)for(c.textAlign="left",c.textBaseline="top",n=o=0,s=this.dataDisplay.length;s>n;n++)if(this.dataDisplay[n].value)c.fillText([this.dataDisplay[n].display,": ",this.dataDisplay[n].value].join(""),l+10,k+10+o*(h.text_font_size+5)),o++;else if(this.dataDisplay[n].tag)for(p=0,q=this.metadata.length;q>p;p++)if(a.stringStartsWith(this.metadata[p],this.dataDisplay[n].tag)){q=this.metadata[p],this.dataDisplay[n].display&&(q=d.inArray("=",this.metadata[p]),q=[this.dataDisplay[n].display,": ",q>-1?this.metadata[p].substring(q+2):this.metadata[p]].join("")),c.fillText(q,l+10,k+10+o*(h.text_font_size+5)),o++;break}if(c.strokeStyle=h.plots_color,c.lineWidth=h.plots_width,q=[],c.beginPath(),this.continuous){for(r=!1,n=0,s=this.data.length;s>n;n++)if(o=this.getTransformedX(this.data[n].x,h,i,l),o>=l&&i>o)p=this.getTransformedY(this.data[n].y,h,j,m,k),h.plots_showIntegration&&e.abs(this.data[n].y)>this.integrationSensitivity&&q.push(new b.Point(this.data[n].x,this.data[n].y)),r||(c.moveTo(o,p),r=!0),c.lineTo(o,p);else if(r)break}else for(n=0,s=this.data.length;s>n;n++)o=this.getTransformedX(this.data[n].x,h,i,l),o>=l&&i>o&&(c.moveTo(o,j-m),c.lineTo(o,this.getTransformedY(this.data[n].y,h,j,m,k)));if(c.stroke(),h.plots_showIntegration&&1<q.length){if(c.strokeStyle=h.plots_integrationColor,c.lineWidth=h.plots_integrationLineWidth,c.beginPath(),n=q[1].x>q[0].x,this.flipXAxis&&!n||!this.flipXAxis&&n){for(n=q.length-2;n>=0;n--)q[n].y+=q[n+1].y;r=q[0].y}else{for(n=1,s=q.length;s>n;n++)q[n].y+=q[n-1].y;r=q[q.length-1].y}for(n=0,s=q.length;s>n;n++)o=this.getTransformedX(q[n].x,h,i,l),p=this.getTransformedY(q[n].y/h.scale/r,h,j,m,k),0==n?c.moveTo(o,p):c.lineTo(o,p);c.stroke()}f=l,g=h.plots_flipXAxis},this.getTransformedY=function(a,b,c,d,e){return e+(c-d-e)*(1-a*b.scale)},this.getTransformedX=function(a,b,c,d){return a=d+(a-this.minX)/(this.maxX-this.minX)*(c-d),b.plots_flipXAxis&&(a=c+d-a),a},this.getInverseTransformedX=function(a,b,c){return g&&(a=b+c-a),(a-c)*(this.maxX-this.minX)/(b-c)+this.minX},this.setup=function(){for(var a=Number.MAX_VALUE,b=Number.MIN_VALUE,c=Number.MIN_VALUE,d=0,f=this.data.length;f>d;d++)a=e.min(a,this.data[d].x),b=e.max(b,this.data[d].x),c=e.max(c,this.data[d].y);for(this.continuous?(this.minX=a,this.maxX=b):(this.minX=a-1,this.maxX=b+1),d=0,f=this.data.length;f>d;d++)this.data[d].y/=c},this.zoom=function(a,b,d,g){if(a=this.getInverseTransformedX(a,d,f),b=this.getInverseTransformedX(b,d,f),this.minX=e.min(a,b),this.maxX=e.max(a,b),g){for(g=Number.MIN_VALUE,b=0,d=this.data.length;d>b;b++)c.isBetween(this.data[b].x,this.minX,this.maxX)&&(g=e.max(g,this.data[b].y));return 1/g}},this.translate=function(a,b){var c=a/(b-f)*(this.maxX-this.minX)*(g?1:-1);this.minX+=c,this.maxX+=c},this.alertMetadata=function(){alert(this.metadata.join("\n"))},!0}}(ChemDoodle.extensions,ChemDoodle.structures,ChemDoodle.math,jQuery,Math),function(a){a._Mesh=function(){return!0},a._Mesh.prototype.storeData=function(a,b,c){this.positionData=a,this.normalData=b,this.indexData=c},a._Mesh.prototype.setupBuffers=function(a){if(this.vertexPositionBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.positionData),a.STATIC_DRAW),this.vertexPositionBuffer.itemSize=3,this.vertexPositionBuffer.numItems=this.positionData.length/3,this.vertexNormalBuffer=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,this.vertexNormalBuffer),a.bufferData(a.ARRAY_BUFFER,new Float32Array(this.normalData),a.STATIC_DRAW),this.vertexNormalBuffer.itemSize=3,this.vertexNormalBuffer.numItems=this.normalData.length/3,this.indexData&&(this.vertexIndexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.indexData),a.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=this.indexData.length),this.partitions)for(var b=0,c=this.partitions.length;c>b;b++){var d=this.partitions[b],e=this.generateBuffers(a,d.positionData,d.normalData,d.indexData);d.vertexPositionBuffer=e[0],d.vertexNormalBuffer=e[1],d.vertexIndexBuffer=e[2]}},a._Mesh.prototype.generateBuffers=function(a,b,c,d){var e=a.createBuffer();return a.bindBuffer(a.ARRAY_BUFFER,e),a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW),e.itemSize=3,e.numItems=b.length/3,b=a.createBuffer(),a.bindBuffer(a.ARRAY_BUFFER,b),a.bufferData(a.ARRAY_BUFFER,new Float32Array(c),a.STATIC_DRAW),b.itemSize=3,b.numItems=c.length/3,c=null,d&&(c=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,c),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),a.STATIC_DRAW),c.itemSize=1,c.numItems=d.length),[e,b,c]},a._Mesh.prototype.bindBuffers=function(a){this.vertexPositionBuffer||this.setupBuffers(a),a.bindBuffer(a.ARRAY_BUFFER,this.vertexPositionBuffer),a.vertexAttribPointer(a.shader.vertexPositionAttribute,this.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,this.vertexNormalBuffer),a.vertexAttribPointer(a.shader.vertexNormalAttribute,this.vertexNormalBuffer.itemSize,a.FLOAT,!1,0,0),this.vertexIndexBuffer&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer)}}(ChemDoodle.structures,Math),function(a,b){a.Cylinder=function(a,c,d){for(var e=[],f=[],g=0;d>g;g++){var h=2*g*b.PI/d,i=b.cos(h),h=b.sin(h);f.push(i,0,h),e.push(a*i,0,a*h),f.push(i,0,h),e.push(a*i,c,a*h)}return f.push(1,0,0),e.push(a,0,0),f.push(1,0,0),e.push(a,c,0),this.storeData(e,f),!0},a.Cylinder.prototype=new a._Mesh}(ChemDoodle.structures,Math),function(a,b){a.Sphere=function(a,c,d){for(var e=[],f=[],g=0;c>=g;g++)for(var h=g*b.PI/c,i=b.sin(h),j=b.cos(h),h=0;d>=h;h++){var k=2*h*b.PI/d,l=b.sin(k),k=b.cos(k)*i,m=j,l=l*i;f.push(k,m,l),e.push(a*k,a*m,a*l)}for(a=[],d+=1,g=0;c>g;g++)for(h=0;d>h;h++)i=g*d+h%d,j=i+d,a.push(i),a.push(j),a.push(i+1),d-1>h&&(a.push(j),a.push(j+1),a.push(i+1));return this.storeData(e,f,a),!0},a.Sphere.prototype=new a._Mesh}(ChemDoodle.structures,Math),function(a,b,c,d){function e(b,c,d,e){this.name=c,this.entire=b,this.pi=e,this.getColor=function(c){return c.macro_colorByChain?this.chainColor:this.name?this.getResidueColor(a[this.name]?this.name:"*",c):this.helix?b.front?c.proteins_ribbonCartoonHelixPrimaryColor:c.proteins_ribbonCartoonHelixSecondaryColor:this.sheet?c.proteins_ribbonCartoonSheetColor:b.front?c.proteins_primaryColor:c.proteins_secondaryColor},this.getResidueColor=function(b,c){var d=a[b];
return c.proteins_useShapelyColors?d.shapelyColor:c.proteins_useAminoColors?d.aminoColor:c.proteins_usePolarityColors&&d.polar?"#C10000":"#FFFFFF"},this.render=function(a,b){null!=this.entire.partitions&&this.pi!=this.entire.partitions.lastRender&&(f(a,this.entire.partitions[this.pi]),this.entire.partitions.lastRender=this.pi),this.vertexIndexBuffer||(this.vertexIndexBuffer=a.createBuffer(),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),a.bufferData(a.ELEMENT_ARRAY_BUFFER,new Uint16Array(d),a.STATIC_DRAW),this.vertexIndexBuffer.itemSize=1,this.vertexIndexBuffer.numItems=d.length),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,this.vertexIndexBuffer),a.material.setDiffuseColor(this.getColor(b)),a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)}}var f=function(a,b){a.bindBuffer(a.ARRAY_BUFFER,b.vertexPositionBuffer),a.vertexAttribPointer(a.shader.vertexPositionAttribute,b.vertexPositionBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ARRAY_BUFFER,b.vertexNormalBuffer),a.vertexAttribPointer(a.shader.vertexNormalAttribute,b.vertexNormalBuffer.itemSize,a.FLOAT,!1,0,0),a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,b.vertexIndexBuffer)};b.Ribbon=function(a,b,g){var h=a[0].lineSegments.length,i=a[0].lineSegments[0].length;this.partitions=[],this.partitions.lastRender=0;var j=null;this.front=b>0;for(var k=0,l=a.length-1;l>k;k++){(null==j||65e3<j.positionData.length)&&(0<this.partitions.length&&k--,j={count:0,positionData:[],normalData:[],indexData:[]},this.partitions.push(j));var m=a[k];j.count++;for(var n=0;h>n;n++)for(var o=g?m.lineSegmentsCartoon[n]:m.lineSegments[n],p=0==n,q=!1,r=0;i>r;r++){var s=o[r],t=k,u=r+1;k==a.length-2&&r==i-1?u--:r==i-1&&(t++,u=0);var u=g?a[t].lineSegmentsCartoon[n][u]:a[t].lineSegments[n][u],t=!1,v=n+1;n==h-1&&(v-=2,t=!0);var v=g?m.lineSegmentsCartoon[v][r]:m.lineSegments[v][r],u=[u.x-s.x,u.y-s.y,u.z-s.z],v=[v.x-s.x,v.y-s.y,v.z-s.z],w=d.cross(u,v,[]);0==r&&(d.normalize(u),d.scale(u,-1),j.normalData.push(u[0],u[1],u[2]),j.positionData.push(s.x,s.y,s.z)),p||q?(d.normalize(v),d.scale(v,-1),j.normalData.push(v[0],v[1],v[2]),j.positionData.push(s.x,s.y,s.z),p&&r==i-1&&(p=!1,r=-1)):(d.normalize(w),(t&&!this.front||!t&&this.front)&&d.scale(w,-1),j.normalData.push(w[0],w[1],w[2]),d.scale(w,c.abs(b)),j.positionData.push(s.x+w[0],s.y+w[1],s.z+w[2]),n==h-1&&r==i-1&&(q=!0,r=-1)),(-1==r||r==i-1)&&(d.normalize(u),j.normalData.push(u[0],u[1],u[2]),j.positionData.push(s.x,s.y,s.z))}}for(h+=2,i+=2,g&&(this.cartoonSegments=[]),this.segments=[],b=0,m=this.partitions.length;m>b;b++){for(j=this.partitions[b],p=null,g&&(p=[]),k=0,l=j.count-1;l>k;k++){for(o=k,n=0;b>n;n++)o+=this.partitions[n].count-1;for(n=a[o],k>0&&g&&n.split&&(r=new e(this,null,p,b),n.helix&&(r.helix=!0),n.sheet&&(r.sheet=!0),this.cartoonSegments.push(r),p=[]),q=k*h*i,s=[],n=0,t=h-1;t>n;n++)for(u=q+n*i,r=0;i>r;r++){if(v=1,k==j.count-1?v=0:r==i-1&&(v=h*i-r),v=[u+r,u+i+r,u+i+r+v,u+r,u+r+v,u+i+r+v],r!=i-1)for(w=0;6>w;w++)s.push(v[w]);for(r==i-2&&k<j.count-2&&(w=h*i-r,v[2]+=w,v[4]+=w,v[5]+=w),w=0;6>w;w++)j.indexData.push(v[w]);if(g)for(w=0;6>w;w++)p.push(v[w])}this.segments.push(new e(this,a[o+1].name,s,b))}if(g){for(r=new e(this,null,p,b),o=j.count-1,n=0;b>n;n++)o+=this.partitions[n].count-1;n=a[o],n.helix&&(r.helix=!0),n.sheet&&(r.sheet=!0),this.cartoonSegments.push(r)}}return this.storeData(this.partitions[0].positionData,this.partitions[0].normalData,this.partitions[0].indexData),1==this.partitions.length&&(this.partitions=null),this.render=function(a,b){this.bindBuffers(a);var c=b.macro_colorByChain?this.chainColor:null;if(c||(c=this.front?b.proteins_primaryColor:b.proteins_secondaryColor),a.material.setDiffuseColor(c),a.drawElements(a.TRIANGLES,this.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0),this.partitions)for(var c=1,d=this.partitions.length;d>c;c++){var e=this.partitions[c];f(a,e),a.drawElements(a.TRIANGLES,e.vertexIndexBuffer.numItems,a.UNSIGNED_SHORT,0)}},!0},b.Ribbon.prototype=new b._Mesh}(ChemDoodle.RESIDUE,ChemDoodle.structures,Math,vec3),function(a,b,c){b.Light=function(b,d,e){return this.diffuseRGB=a.getRGB(b,1),this.specularRGB=a.getRGB(d,1),this.direction=e,this.lightScene=function(a){a.uniform3f(a.getUniformLocation(a.program,"u_light.diffuse_color"),this.diffuseRGB[0],this.diffuseRGB[1],this.diffuseRGB[2]),a.uniform3f(a.getUniformLocation(a.program,"u_light.specular_color"),this.specularRGB[0],this.specularRGB[1],this.specularRGB[2]);var b=c.create(this.direction);c.normalize(b),c.negate(b),a.uniform3f(a.getUniformLocation(a.program,"u_light.direction"),b[0],b[1],b[2]);var d=[0,0,0],b=[d[0]+b[0],d[1]+b[1],d[2]+b[2]],d=c.length(b);0==d?b=[0,0,1]:c.scale(1/d),a.uniform3f(a.getUniformLocation(a.program,"u_light.half_vector"),b[0],b[1],b[2])},!0}}(ChemDoodle.math,ChemDoodle.structures,vec3),function(a){a.Line=function(){return this.storeData([0,0,0,0,1,0],[0,0,0,0,0,0]),!0},a.Line.prototype=new a._Mesh}(ChemDoodle.structures),function(a,b){b.Material=function(b){var c=b.getUniformLocation(b.program,"u_material.ambient_color"),d=b.getUniformLocation(b.program,"u_material.diffuse_color"),e=b.getUniformLocation(b.program,"u_material.specular_color"),f=b.getUniformLocation(b.program,"u_material.shininess"),g=b.getUniformLocation(b.program,"u_material.alpha");return this.setTempColors=function(h,i,j,k){this.aCache&&this.aCache==h||(this.aCache=h,h=a.getRGB(h,1),b.uniform3f(c,h[0],h[1],h[2])),null==i||this.dCache&&this.dCache==i||(this.dCache=i,h=a.getRGB(i,1),b.uniform3f(d,h[0],h[1],h[2])),this.sCache&&this.sCache==j||(this.sCache=j,h=a.getRGB(j,1),b.uniform3f(e,h[0],h[1],h[2])),this.snCache&&this.snCache==k||(this.snCache=k,b.uniform1f(f,k)),this.alCache=1,b.uniform1f(g,1)},this.setDiffuseColor=function(c){this.dCache&&this.dCache==c||(this.dCache=c,c=a.getRGB(c,1),b.uniform3f(d,c[0],c[1],c[2]))},this.setAlpha=function(a){this.alCache&&this.alCache==a||(this.alCache=a,b.uniform1f(g,a))},!0}}(ChemDoodle.math,ChemDoodle.structures),function(a,b,c){a.MolecularSurface=function(d,e,f,g,h){function i(a,b,c,d){var e=a.index;if(a.contained)for(var e=-1,f=1/0,g=0,h=b.length;h>g;g++)for(var i=b[g],j=0,k=i.length;k>j;j++){var l=i[j];if(!l.contained&&l.index!=c&&l.index!=d){var m=l.distance3D(a);f>m&&(e=l.index,f=m)}}return e}for(var j=[],k=[],l=[],m=[],n=0;e>=n;n++)for(var o=n*c.PI/e,p=c.sin(o),q=c.cos(o),o=0;f>=o;o++){var r=2*o*c.PI/f;m.push(c.cos(r)*p,q,c.sin(r)*p)}for(p=[],n=0,o=d.atoms.length;o>n;n++){for(var q=[],s=d.atoms[n],t=b[s.label][h]+g,u=[],r=0,v=d.atoms.length;v>r;r++)if(r!=n){var w=d.atoms[r];w.index=r,s.distance3D(w)<t+b[w.label][h]+g&&u.push(w)}for(r=0,v=m.length;v>r;r+=3){for(var x=new a.Atom("C",s.x+t*m[r],s.y+t*m[r+1],s.z+t*m[r+2]),y=0,z=u.length;z>y;y++)if(w=u[y],x.distance3D(w)<b[w.label][h]+g){x.contained=!0;break}q.push(x)}p.push(q)}for(d=[],f++,n=0;e>n;n++)for(o=0;f>o;o++)h=n*f+o%f,g=h+f,d.push(h),d.push(g),d.push(h+1),f-1>o&&(d.push(g),d.push(g+1),d.push(h+1));for(n=y=0,o=p.length;o>n;n++){for(q=p[n],r=0,v=q.length;v>r;r++)x=q[r],x.contained||(x.index=y,y++,j.push(x.x,x.y,x.z),k.push(m[3*r],m[3*r+1],m[3*r+2]));for(r=0,v=d.length;v>r;r+=3)h=q[d[r]],g=q[d[r+1]],x=q[d[r+2]],!h.contained&&!g.contained&&!x.contained&&l.push(h.index,g.index,x.index)}for(m=[],n=0,o=p.length;o>n;n++)for(q=p[n],r=0,v=d.length;v>r;r+=3){for(h=q[d[r]],g=q[d[r+1]],x=q[d[r+2]],u=[],y=0,z=p.length;z>y;y++)y!=n&&u.push(p[y]);if(!(h.contained&&g.contained&&x.contained||!(h.contained||g.contained||x.contained))&&(e=i(h,u,-1,-1),f=i(g,u,e,-1),u=i(x,u,e,f),-1!=e&&-1!=f&&-1!=u)){for(g=!1,y=0,z=m.length;z>y;y+=3)if(h=m[y],x=m[y+1],s=m[y+2],t=f==h||f==x||f==s,w=u==h||u==x||u==s,(e==h||e==x||e==s)&&t&&w){g=!0;break}g||m.push(e,f,u)}}return l=l.concat(m),this.storeData(j,k,l),!0},a.MolecularSurface.prototype=new a._Mesh}(ChemDoodle.structures,ChemDoodle.ELEMENT,Math),function(a,b){a.Shader=function(){return this.init=function(a){var b=this.getShader(a,"vertex-shader");null==b&&(b=this.loadDefaultVertexShader(a));var c=this.getShader(a,"fragment-shader");null==c&&(c=this.loadDefaultFragmentShader(a)),a.attachShader(a.program,b),a.attachShader(a.program,c),a.linkProgram(a.program),a.getProgramParameter(a.program,a.LINK_STATUS)||alert("Could not initialize shaders: "+a.getProgramInfoLog(program)),a.useProgram(a.program),this.vertexPositionAttribute=a.getAttribLocation(a.program,"a_vertex_position"),a.enableVertexAttribArray(this.vertexPositionAttribute),this.vertexNormalAttribute=a.getAttribLocation(a.program,"a_vertex_normal"),a.enableVertexAttribArray(this.vertexNormalAttribute)},this.getShader=function(a,c){var d=b.getElementById(c);if(!d)return null;for(var e=[],f=d.firstChild;f;)3==f.nodeType&&e.push(f.textContent),f=f.nextSibling;if("x-shader/x-fragment"==d.type)f=a.createShader(a.FRAGMENT_SHADER);else{if("x-shader/x-vertex"!=d.type)return null;f=a.createShader(a.VERTEX_SHADER)}return a.shaderSource(f,e.join("")),a.compileShader(f),a.getShaderParameter(f,a.COMPILE_STATUS)?f:(alert(d.type+" "+a.getShaderInfoLog(f)),null)},this.loadDefaultVertexShader=function(a){var b=[];b.push("struct Light"),b.push("{"),b.push("vec3 diffuse_color;"),b.push("vec3 specular_color;"),b.push("vec3 direction;"),b.push("vec3 half_vector;"),b.push("};"),b.push("struct Material"),b.push("{"),b.push("vec3 ambient_color;"),b.push("vec3 diffuse_color;"),b.push("vec3 specular_color;"),b.push("float shininess;"),b.push("float alpha;"),b.push("};"),b.push("attribute vec3 a_vertex_position;"),b.push("attribute vec3 a_vertex_normal;"),b.push("uniform Light u_light;"),b.push("uniform Material u_material;"),b.push("uniform mat4 u_model_view_matrix;"),b.push("uniform mat4 u_projection_matrix;"),b.push("uniform mat3 u_normal_matrix;"),b.push("varying vec4 v_diffuse;"),b.push("varying vec4 v_ambient;"),b.push("varying vec3 v_normal;"),b.push("varying vec3 v_light_direction;"),b.push("void main(void)"),b.push("{"),b.push("if(length(a_vertex_normal)==0.0){"),b.push("v_normal = a_vertex_normal;"),b.push("}else{"),b.push("v_normal = normalize(u_normal_matrix * a_vertex_normal);"),b.push("}"),b.push("vec4 diffuse = vec4(u_light.diffuse_color, 1.0);"),b.push("v_light_direction = u_light.direction;"),b.push("v_ambient = vec4(u_material.ambient_color, 1.0);"),b.push("v_diffuse = vec4(u_material.diffuse_color, 1.0) * diffuse;"),b.push("gl_Position = u_projection_matrix * u_model_view_matrix * vec4(a_vertex_position, 1.0);"),b.push("}");var c=a.createShader(a.VERTEX_SHADER);return a.shaderSource(c,b.join("")),a.compileShader(c),a.getShaderParameter(c,a.COMPILE_STATUS)?c:(alert("Vertex shader failed to compile: "+a.getShaderInfoLog(c)),null)},this.loadDefaultFragmentShader=function(a){var b=[];b.push("precision mediump float;\n"),b.push("struct Light"),b.push("{"),b.push("vec3 diffuse_color;"),b.push("vec3 specular_color;"),b.push("vec3 direction;"),b.push("vec3 half_vector;"),b.push("};"),b.push("struct Material"),b.push("{"),b.push("vec3 ambient_color;"),b.push("vec3 diffuse_color;"),b.push("vec3 specular_color;"),b.push("float shininess;"),b.push("float alpha;"),b.push("};"),b.push("uniform Light u_light;"),b.push("uniform Material u_material;"),b.push("varying vec4 v_diffuse;"),b.push("varying vec4 v_ambient;"),b.push("varying vec3 v_normal;"),b.push("varying vec3 v_light_direction;"),b.push("void main(void)"),b.push("{"),b.push("if(length(v_normal)==0.0){"),b.push("gl_FragColor = vec4(v_diffuse.rgba);"),b.push("}else{"),b.push("float nDotL = max(dot(v_normal, v_light_direction), 0.0);"),b.push("vec4 color = vec4(v_diffuse.rgb*nDotL, v_diffuse.a);"),b.push("float nDotHV = max(dot(v_normal, u_light.half_vector), 0.0);"),b.push("vec4 specular = vec4(u_material.specular_color * u_light.specular_color, 1.0);"),b.push("color+=vec4(specular.rgb * pow(nDotHV, u_material.shininess), specular.a);"),b.push("gl_FragColor = color+v_ambient;"),b.push("gl_FragColor.a*=u_material.alpha;"),b.push("}"),b.push("}");var c=a.createShader(a.FRAGMENT_SHADER);return a.shaderSource(c,b.join("")),a.compileShader(c),a.getShaderParameter(c,a.COMPILE_STATUS)?c:(alert("Fragment shader failed to compile: "+a.getShaderInfoLog(c)),null)},!0}}(ChemDoodle.structures,document),function(a,b){a.Shape=function(c,d){for(var e=c.length,f=[],g=[],h=new a.Point,i=0,j=e;j>i;i++){var k=i+1;i==j-1&&(k=0);for(var l=c[i],k=c[k],m=b.cross([0,0,1],[k.x-l.x,k.y-l.y,0]),n=0;2>n;n++)f.push(l.x,l.y,d/2),f.push(l.x,l.y,-d/2),f.push(k.x,k.y,d/2),f.push(k.x,k.y,-d/2);for(n=0;4>n;n++)g.push(m[0],m[1],m[2]);g.push(0,0,1),g.push(0,0,-1),g.push(0,0,1),g.push(0,0,-1),h.add(l)}for(h.x/=e,h.y/=e,g.push(0,0,1),f.push(h.x,h.y,d/2),g.push(0,0,-1),f.push(h.x,h.y,-d/2),h=[],l=8*e,i=0,j=e;j>i;i++)e=8*i,h.push(e),h.push(e+1),h.push(e+3),h.push(e),h.push(e+2),h.push(e+3),h.push(e+4),h.push(e+6),h.push(l),h.push(e+5),h.push(e+7),h.push(l+1);return this.storeData(f,g,h),!0},a.Shape.prototype=new a._Mesh}(ChemDoodle.structures,vec3),function(a,b,c){a.Star=function(){for(var a=[.8944,.4472,0,.2764,.4472,.8506,.2764,.4472,-.8506,-.7236,.4472,.5257,-.7236,.4472,-.5257,-.3416,.4472,0,-.1056,.4472,.3249,-.1056,.4472,-.3249,.2764,.4472,.2008,.2764,.4472,-.2008,-.8944,-.4472,0,-.2764,-.4472,.8506,-.2764,-.4472,-.8506,.7236,-.4472,.5257,.7236,-.4472,-.5257,.3416,-.4472,0,.1056,-.4472,.3249,.1056,-.4472,-.3249,-.2764,-.4472,.2008,-.2764,-.4472,-.2008,-.5527,.1058,0,-.1708,.1058,.5527,-.1708,.1058,-.5527,.4471,.1058,.3249,.4471,.1058,-.3249,.5527,-.1058,0,.1708,-.1058,.5527,.1708,-.1058,-.5527,-.4471,-.1058,.3249,-.4471,-.1058,-.3249,0,1,0,0,-1,0],b=[0,9,8,2,7,9,4,5,7,3,6,5,1,8,6,0,8,23,30,6,8,3,21,6,11,26,21,13,23,26,2,9,24,30,8,9,1,23,8,13,25,23,14,24,25,4,7,22,30,9,7,0,24,9,14,27,24,12,22,27,3,5,20,30,7,5,2,22,7,12,29,22,10,20,29,1,6,21,30,5,6,4,20,5,10,28,20,11,21,28,10,19,18,12,17,19,14,15,17,13,16,15,11,18,16,31,19,17,14,17,27,2,27,22,4,22,29,10,29,19,31,18,19,12,19,29,4,29,20,3,20,28,11,28,18,31,16,18,10,18,28,3,28,21,1,21,26,13,26,16,31,15,16,11,16,26,1,26,23,0,23,25,14,25,15,31,17,15,13,15,25,0,25,24,2,24,27,12,27,17],d=[],e=[],f=[],g=0,h=b.length;h>g;g+=3){var i=3*b[g],j=3*b[g+1],k=3*b[g+2],i=[a[i],a[i+1],a[i+2]],j=[a[j],a[j+1],a[j+2]],k=[a[k],a[k+1],a[k+2]],l=c.cross([k[0]-j[0],k[1]-j[1],k[2]-j[2]],[i[0]-j[0],i[1]-j[1],i[2]-j[2]],[]);c.normalize(l),d.push(i[0],i[1],i[2],j[0],j[1],j[2],k[0],k[1],k[2]),e.push(l[0],l[1],l[2],l[0],l[1],l[2],l[0],l[1],l[2]),f.push(g,g+1,g+2)}return this.storeData(d,e,f),!0},a.Star.prototype=new a._Mesh}(ChemDoodle.structures,Math,vec3),function(a,b,c,d,e,f){var g=function(a,b,c){var f=d.sqrt(b[1]*b[1]+b[2]*b[2]),g=[1,0,0,0,0,b[2]/f,-b[1]/f,0,0,b[1]/f,b[2]/f,0,0,0,0,1],h=[1,0,0,0,0,b[2]/f,b[1]/f,0,0,-b[1]/f,b[2]/f,0,0,0,0,1],i=[f,0,-b[0],0,0,1,0,0,b[0],0,f,0,0,0,0,1],b=[f,0,b[0],0,0,1,0,0,-b[0],0,f,0,0,0,0,1],c=[d.cos(c),-d.sin(c),0,0,d.sin(c),d.cos(c),0,0,0,0,1,0,0,0,0,1],j=e.multiply(g,e.multiply(i,e.multiply(c,e.multiply(b,h,[]))));this.rotate=function(){return e.multiplyVec3(j,a)}};c.Tube=function(h,i,j){var k=h[0].lineSegments[0].length,l=[],m=[];this.ends=[],this.ends.push(h[0].lineSegments[0][0]),this.ends.push(h[h.length-2].lineSegments[0][0]);for(var n=[1,0,0],o=0,p=h.length-1;p>o;o++)for(var q=h[o],r=1/0,s=new c.Atom("",h[o+1].cp1.x,h[o+1].cp1.y,h[o+1].cp1.z),t=0;k>t;t++){var u=q.lineSegments[0][t],v=null,v=t==k-1?o==h.length-2?q.lineSegments[0][t-1]:h[o+1].lineSegments[0][0]:q.lineSegments[0][t+1],v=[v.x-u.x,v.y-u.y,v.z-u.z];f.normalize(v),o==h.length-2&&t==k-1&&f.scale(v,-1);var w=vec3.cross(v,n,[]);f.normalize(w),f.scale(w,i/2);for(var w=new g(w,v,2*Math.PI/j),v=0,x=j;x>v;v++){var y=w.rotate();v==d.floor(j/4)&&(n=[y[0],y[1],y[2]]),m.push(y[0],y[1],y[2]),l.push(u.x+y[0],u.y+y[1],u.z+y[2])}null!=s&&(v=u.distance3D(s),r>v&&(r=v,h[o+1].pPoint=u))}for(n=[],o=0,p=h.length-2;p>o;o++)for(q=o*k*j,t=0,r=k;r>t;t++)for(s=q+t*j,v=0;j>v;v++)v==j-1&&(nextRes=o==h.length-2?0:-v),u=s+v,n.push(u),n.push(u+j),n.push(u+j+1),n.push(u),n.push(u+1),n.push(u+j+1);for(this.storeData(l,m,n),j=[new c.Point(2,0)],o=0;60>o;o++)k=o/60*d.PI,j.push(new c.Point(2*d.cos(k),-2*d.sin(k)));j.push(new c.Point(-2,0),new c.Point(-2,4),new c.Point(2,4));var z=new c.Shape(j,1);return this.render=function(g,j){this.bindBuffers(g),g.material.setDiffuseColor(j.macro_colorByChain?this.chainColor:j.nucleics_tubeColor),g.drawElements(g.TRIANGLES,this.vertexIndexBuffer.numItems,g.UNSIGNED_SHORT,0),g.sphereBuffer.bindBuffers(g);for(var k=0;2>k;k++){var l=this.ends[k],l=e.translate(g.modelViewMatrix,[l.x,l.y,l.z],[]),m=i/2;e.scale(l,[m,m,m]),g.setMatrixUniforms(l),g.drawElements(g.TRIANGLES,g.sphereBuffer.vertexIndexBuffer.numItems,g.UNSIGNED_SHORT,0)}for(g.cylinderBuffer.bindBuffers(g),k=1,m=h.length-1;m>k;k++){var n=h[k],o=n.pPoint,p=new c.Atom("",n.cp2.x,n.cp2.y,n.cp2.z),l=1.001*o.distance3D(p),n=[i/4,l,i/4],l=e.translate(g.modelViewMatrix,[o.x,o.y,o.z],[]),q=[0,1,0],r=0,s=null,t=[p.x-o.x,p.y-o.y,p.z-o.z];o.x==p.x&&o.z==p.z?(s=[0,0,1],o.y<o.y&&(r=d.PI)):(r=a.vec3AngleFrom(q,t),s=f.cross(q,t,[])),0!=r&&e.rotate(l,r,s),e.scale(l,n),g.setMatrixUniforms(l),g.drawArrays(g.TRIANGLE_STRIP,0,g.cylinderBuffer.vertexPositionBuffer.numItems)}for(z.bindBuffers(g),!j.nucleics_useShapelyColors&&!j.macro_colorByChain&&g.material.setDiffuseColor(j.nucleics_baseColor),k=1,m=h.length-1;m>k;k++)n=h[k],p=n.cp2,l=e.translate(g.modelViewMatrix,[p.x,p.y,p.z],[]),q=[0,1,0],r=0,o=n.cp3,t=[o.x-p.x,o.y-p.y,o.z-p.z],p.x==o.x&&p.z==o.z?(s=[0,0,1],p.y<p.y&&(r=d.PI)):(r=a.vec3AngleFrom(q,t),s=f.cross(q,t,[])),0!=r&&e.rotate(l,r,s),p=[1,0,0],r=e.rotate(e.identity([]),r,s),e.multiplyVec3(r,p),r=n.cp4,o=n.cp5,r.y==o.y&&r.z==o.z||(r=[o.x-r.x,o.y-r.y,o.z-r.z],o=a.vec3AngleFrom(p,r),0>f.dot(t,f.cross(p,r))&&(o*=-1),e.rotateY(l,o)),j.nucleics_useShapelyColors&&!j.macro_colorByChain&&g.material.setDiffuseColor(b[n.name]?b[n.name].shapelyColor:b["*"].shapelyColor),g.setMatrixUniforms(l),g.drawElements(g.TRIANGLES,z.vertexIndexBuffer.numItems,g.UNSIGNED_SHORT,0)},!0},c.Tube.prototype=new c._Mesh}(ChemDoodle.extensions,ChemDoodle.RESIDUE,ChemDoodle.structures,Math,mat4,vec3),function(a){a.UnitCell=function(a){var b=[],c=[],d=function(a,d,e,f){for(b.push(a[0],a[1],a[2]),b.push(d[0],d[1],d[2]),b.push(e[0],e[1],e[2]),b.push(f[0],f[1],f[2]),a=0;4>a;a++)c.push(0,0,0)};for(d(a.o,a.x,a.xy,a.y),d(a.o,a.y,a.yz,a.z),d(a.o,a.z,a.xz,a.x),d(a.yz,a.y,a.xy,a.xyz),d(a.xyz,a.xz,a.z,a.yz),d(a.xy,a.x,a.xz,a.xyz),a=[],d=0;6>d;d++){var e=4*d;a.push(e,e+1,e+1,e+2,e+2,e+3,e+3,e)}return this.storeData(b,c,a),!0},a.UnitCell.prototype=new a._Mesh}(ChemDoodle.structures,vec3),function(a,b,c){a.Plate=function(a){for(this.lanes=Array(a),i=0,ii=a;ii>i;i++)this.lanes[i]=[];return this.sort=function(){for(i=0,ii=this.lanes.length;ii>i;i++)this.lanes[i].sort(function(a,b){return a-b})},this.draw=function(a){var d=a.canvas.width,e=a.canvas.height;for(this.origin=9*e/10,this.front=e/10,this.laneLength=this.origin-this.front,a.strokeStyle="#000000",a.beginPath(),a.moveTo(0,this.front),b.contextHashTo(a,0,this.front,d,this.front,3,3),a.closePath(),a.stroke(),a.beginPath(),a.moveTo(0,this.origin),a.lineTo(d,this.origin),a.closePath(),a.stroke(),i=0,ii=this.lanes.length;ii>i;i++)for(e=(i+1)*d/(ii+1),a.beginPath(),a.moveTo(e,this.origin),a.lineTo(e,this.origin+3),a.closePath(),a.stroke(),s=0,ss=this.lanes[i].length;ss>s;s++){var f=this.origin-this.laneLength*this.lanes[i][s].rf;switch(this.lanes[i][s].type){case"compact":a.beginPath(),a.arc(e,f,3,0,2*c.PI,!1),a.closePath();break;case"expanded":a.beginPath(),a.arc(e,f,7,0,2*c.PI,!1),a.closePath();break;case"widened":b.contextOval(a,e-18,f-10,36,10);break;case"cresent":a.beginPath(),a.arc(e,f,9,0,c.PI,!0),a.closePath()}switch(this.lanes[i][s].style){case"solid":a.fillStyle="#000000",a.fill();break;case"transparent":a.stroke()}}},!0},a.Plate.Spot=function(a,b,c){this.type=a,this.rf=b,this.style=c?c:"solid"}}(ChemDoodle.structures,ChemDoodle.extensions,Math),function(a,b,c){a.default_backgroundColor="#FFFFFF",a.default_scale=1,a.default_rotateAngle=0,a.default_bondLength_2D=20,a.default_angstromsPerBondLength=1.25,a.default_lightDirection_3D=[-.1,-.1,-1],a.default_lightDiffuseColor_3D="#FFFFFF",a.default_lightSpecularColor_3D="#FFFFFF",a.default_projectionPerspective_3D=!0,a.default_projectionPerspectiveVerticalFieldOfView_3D=45,a.default_projectionOrthoWidth_3D=40,a.default_projectionWidthHeightRatio_3D=null,a.default_projectionFrontCulling_3D=.1,a.default_projectionBackCulling_3D=1e4,a.default_atoms_display=!0,a.default_atoms_color="#000000",a.default_atoms_font_size_2D=12,a.default_atoms_font_families_2D=["Helvetica","Arial","Dialog"],a.default_atoms_font_bold_2D=!1,a.default_atoms_font_italic_2D=!1,a.default_atoms_circles_2D=!1,a.default_atoms_circleDiameter_2D=10,a.default_atoms_circleBorderWidth_2D=1,a.default_atoms_lonePairDistance_2D=8,a.default_atoms_lonePairSpread_2D=4,a.default_atoms_lonePairDiameter_2D=1,a.default_atoms_useJMOLColors=!1,a.default_atoms_usePYMOLColors=!1,a.default_atoms_resolution_3D=60,a.default_atoms_sphereDiameter_3D=.8,a.default_atoms_useVDWDiameters_3D=!1,a.default_atoms_vdwMultiplier_3D=1,a.default_atoms_materialAmbientColor_3D="#000000",a.default_atoms_materialSpecularColor_3D="#555555",a.default_atoms_materialShininess_3D=32,a.default_atoms_implicitHydrogens_2D=!0,a.default_atoms_displayTerminalCarbonLabels_2D=!1,a.default_atoms_showHiddenCarbons_2D=!0,a.default_atoms_displayAllCarbonLabels_2D=!1,a.default_atoms_nonBondedAsStars_3D=!1,a.default_bonds_display=!0,a.default_bonds_color="#000000",a.default_bonds_width_2D=1,a.default_bonds_saturationWidth_2D=.2,a.default_bonds_ends_2D="round",a.default_bonds_useJMOLColors=!1,a.default_bonds_usePYMOLColors=!1,a.default_bonds_colorGradient=!1,a.default_bonds_saturationAngle_2D=c.PI/3,a.default_bonds_symmetrical_2D=!1,a.default_bonds_clearOverlaps_2D=!1,a.default_bonds_overlapClearWidth_2D=.5,a.default_bonds_atomLabelBuffer_2D=.25,a.default_bonds_wedgeThickness_2D=.22,a.default_bonds_hashWidth_2D=1,a.default_bonds_hashSpacing_2D=2.5,a.default_bonds_showBondOrders_3D=!1,a.default_bonds_resolution_3D=60,a.default_bonds_renderAsLines_3D=!1,a.default_bonds_cylinderDiameter_3D=.3,a.default_bonds_materialAmbientColor_3D="#222222",a.default_bonds_materialSpecularColor_3D="#555555",a.default_bonds_materialShininess_3D=32,a.default_proteins_displayRibbon=!0,a.default_proteins_displayBackbone=!1,a.default_proteins_backboneThickness=1.5,a.default_proteins_backboneColor="#CCCCCC",a.default_proteins_ribbonCartoonize=!1,a.default_proteins_useShapelyColors=!1,a.default_proteins_useAminoColors=!1,a.default_proteins_usePolarityColors=!1,a.default_proteins_primaryColor="#FF0D0D",a.default_proteins_secondaryColor="#FFFF30",a.default_proteins_ribbonCartoonHelixPrimaryColor="#00E740",a.default_proteins_ribbonCartoonHelixSecondaryColor="#9905FF",a.default_proteins_ribbonCartoonSheetColor="#E8BB99",a.default_proteins_ribbonThickness=.2,a.default_proteins_materialAmbientColor_3D="#222222",a.default_proteins_materialSpecularColor_3D="#555555",a.default_proteins_materialShininess_3D=32,a.default_nucleics_display=!0,a.default_nucleics_tubeColor="#CCCCCC",a.default_nucleics_baseColor="#C10000",a.default_nucleics_useShapelyColors=!0,a.default_nucleics_tubeThickness=1.5,a.default_nucleics_tubeResolution_3D=60,a.default_nucleics_materialAmbientColor_3D="#222222",a.default_nucleics_materialSpecularColor_3D="#555555",a.default_nucleics_materialShininess_3D=32,a.default_macro_displayAtoms=!1,a.default_macro_displayBonds=!1,a.default_macro_atomToLigandDistance=-1,a.default_macro_showWater=!1,a.default_macro_colorByChain=!1,a.default_surfaces_display=!0,a.default_surfaces_style="Dot",a.default_surfaces_color="#E9B862",a.default_surfaces_materialAmbientColor_3D="#000000",a.default_surfaces_materialSpecularColor_3D="#000000",a.default_surfaces_materialShininess_3D=32,a.default_crystals_displayUnitCell=!0,a.default_crystals_unitCellColor="green",a.default_crystals_unitCellLineWidth=1,a.default_plots_color="#000000",a.default_plots_width=1,a.default_plots_showIntegration=!1,a.default_plots_integrationColor="#c10000",a.default_plots_integrationLineWidth=1,a.default_plots_showGrid=!1,a.default_plots_gridColor="gray",a.default_plots_gridLineWidth=.5,a.default_plots_showYAxis=!0,a.default_plots_flipXAxis=!1,a.default_text_font_size=12,a.default_text_font_families=["Helvetica","Arial","Dialog"],a.default_text_color="#000000",b.VisualSpecifications=function(){this.backgroundColor=a.default_backgroundColor,this.scale=a.default_scale,this.rotateAngle=a.default_rotateAngle,this.bondLength=a.default_bondLength_2D,this.angstromsPerBondLength=a.default_angstromsPerBondLength,this.lightDirection_3D=a.default_lightDirection_3D,this.lightDiffuseColor_3D=a.default_lightDiffuseColor_3D,this.lightSpecularColor_3D=a.default_lightSpecularColor_3D,this.projectionPerspective_3D=a.default_projectionPerspective_3D,this.projectionPerspectiveVerticalFieldOfView_3D=a.default_projectionPerspectiveVerticalFieldOfView_3D,this.projectionOrthoWidth_3D=a.default_projectionOrthoWidth_3D,this.projectionWidthHeightRatio_3D=a.default_projectionWidthHeightRatio_3D,this.projectionFrontCulling_3D=a.default_projectionFrontCulling_3D,this.projectionBackCulling_3D=a.default_projectionBackCulling_3D,this.atoms_display=a.default_atoms_display,this.atoms_color=a.default_atoms_color,this.atoms_font_size_2D=a.default_atoms_font_size_2D,this.atoms_font_families_2D=[];for(var b=0,c=a.default_atoms_font_families_2D.length;c>b;b++)this.atoms_font_families_2D[b]=a.default_atoms_font_families_2D[b];for(this.atoms_font_bold_2D=a.default_atoms_font_bold_2D,this.atoms_font_italic_2D=a.default_atoms_font_italic_2D,this.atoms_circles_2D=a.default_atoms_circles_2D,this.atoms_circleDiameter_2D=a.default_atoms_circleDiameter_2D,this.atoms_circleBorderWidth_2D=a.default_atoms_circleBorderWidth_2D,this.atoms_lonePairDistance_2D=a.default_atoms_lonePairDistance_2D,this.atoms_lonePairSpread_2D=a.default_atoms_lonePairSpread_2D,this.atoms_lonePairDiameter_2D=a.default_atoms_lonePairDiameter_2D,this.atoms_useJMOLColors=a.default_atoms_useJMOLColors,this.atoms_usePYMOLColors=a.default_atoms_usePYMOLColors,this.atoms_resolution_3D=a.default_atoms_resolution_3D,this.atoms_sphereDiameter_3D=a.default_atoms_sphereDiameter_3D,this.atoms_useVDWDiameters_3D=a.default_atoms_useVDWDiameters_3D,this.atoms_vdwMultiplier_3D=a.default_atoms_vdwMultiplier_3D,this.atoms_materialAmbientColor_3D=a.default_atoms_materialAmbientColor_3D,this.atoms_materialSpecularColor_3D=a.default_atoms_materialSpecularColor_3D,this.atoms_materialShininess_3D=a.default_atoms_materialShininess_3D,this.atoms_implicitHydrogens_2D=a.default_atoms_implicitHydrogens_2D,this.atoms_displayTerminalCarbonLabels_2D=a.default_atoms_displayTerminalCarbonLabels_2D,this.atoms_showHiddenCarbons_2D=a.default_atoms_showHiddenCarbons_2D,this.atoms_displayAllCarbonLabels_2D=a.default_atoms_displayAllCarbonLabels_2D,this.atoms_nonBondedAsStars_3D=a.default_atoms_nonBondedAsStars_3D,this.bonds_display=a.default_bonds_display,this.bonds_color=a.default_bonds_color,this.bonds_width_2D=a.default_bonds_width_2D,this.bonds_saturationWidth_2D=a.default_bonds_saturationWidth_2D,this.bonds_ends_2D=a.default_bonds_ends_2D,this.bonds_useJMOLColors=a.default_bonds_useJMOLColors,this.bonds_usePYMOLColors=a.default_bonds_usePYMOLColors,this.bonds_colorGradient=a.default_bonds_colorGradient,this.bonds_saturationAngle_2D=a.default_bonds_saturationAngle_2D,this.bonds_symmetrical_2D=a.default_bonds_symmetrical_2D,this.bonds_clearOverlaps_2D=a.default_bonds_clearOverlaps_2D,this.bonds_overlapClearWidth_2D=a.default_bonds_overlapClearWidth_2D,this.bonds_atomLabelBuffer_2D=a.default_bonds_atomLabelBuffer_2D,this.bonds_wedgeThickness_2D=a.default_bonds_wedgeThickness_2D,this.bonds_hashWidth_2D=a.default_bonds_hashWidth_2D,this.bonds_hashSpacing_2D=a.default_bonds_hashSpacing_2D,this.bonds_showBondOrders_3D=a.default_bonds_showBondOrders_3D,this.bonds_resolution_3D=a.default_bonds_resolution_3D,this.bonds_renderAsLines_3D=a.default_bonds_renderAsLines_3D,this.bonds_cylinderDiameter_3D=a.default_bonds_cylinderDiameter_3D,this.bonds_materialAmbientColor_3D=a.default_bonds_materialAmbientColor_3D,this.bonds_materialSpecularColor_3D=a.default_bonds_materialSpecularColor_3D,this.bonds_materialShininess_3D=a.default_bonds_materialShininess_3D,this.proteins_displayRibbon=a.default_proteins_displayRibbon,this.proteins_displayBackbone=a.default_proteins_displayBackbone,this.proteins_backboneThickness=a.default_proteins_backboneThickness,this.proteins_backboneColor=a.default_proteins_backboneColor,this.proteins_ribbonCartoonize=a.default_proteins_ribbonCartoonize,this.proteins_useShapelyColors=a.default_proteins_useShapelyColors,this.proteins_useAminoColors=a.default_proteins_useAminoColors,this.proteins_usePolarityColors=a.default_proteins_usePolarityColors,this.proteins_primaryColor=a.default_proteins_primaryColor,this.proteins_secondaryColor=a.default_proteins_secondaryColor,this.proteins_ribbonCartoonHelixPrimaryColor=a.default_proteins_ribbonCartoonHelixPrimaryColor,this.proteins_ribbonCartoonHelixSecondaryColor=a.default_proteins_ribbonCartoonHelixSecondaryColor,this.proteins_ribbonCartoonSheetColor=a.default_proteins_ribbonCartoonSheetColor,this.proteins_ribbonThickness=a.default_proteins_ribbonThickness,this.proteins_materialAmbientColor_3D=a.default_proteins_materialAmbientColor_3D,this.proteins_materialSpecularColor_3D=a.default_proteins_materialSpecularColor_3D,this.proteins_materialShininess_3D=a.default_proteins_materialShininess_3D,this.macro_displayAtoms=a.default_macro_displayAtoms,this.macro_displayBonds=a.default_macro_displayBonds,this.macro_atomToLigandDistance=a.default_macro_atomToLigandDistance,this.nucleics_display=a.default_nucleics_display,this.nucleics_tubeColor=a.default_nucleics_tubeColor,this.nucleics_baseColor=a.default_nucleics_baseColor,this.nucleics_useShapelyColors=a.default_nucleics_useShapelyColors,this.nucleics_tubeThickness=a.default_nucleics_tubeThickness,this.nucleics_tubeResolution_3D=a.default_nucleics_tubeResolution_3D,this.nucleics_materialAmbientColor_3D=a.default_nucleics_materialAmbientColor_3D,this.nucleics_materialSpecularColor_3D=a.default_nucleics_materialSpecularColor_3D,this.nucleics_materialShininess_3D=a.default_nucleics_materialShininess_3D,this.macro_showWater=a.default_macro_showWater,this.macro_colorByChain=a.default_macro_colorByChain,this.surfaces_display=a.default_surfaces_display,this.surfaces_style=a.default_surfaces_style,this.surfaces_color=a.default_surfaces_color,this.surfaces_materialAmbientColor_3D=a.default_surfaces_materialAmbientColor_3D,this.surfaces_materialSpecularColor_3D=a.default_surfaces_materialSpecularColor_3D,this.surfaces_materialShininess_3D=a.default_surfaces_materialShininess_3D,this.crystals_displayUnitCell=a.default_crystals_displayUnitCell,this.crystals_unitCellColor=a.default_crystals_unitCellColor,this.crystals_unitCellLineWidth=a.default_crystals_unitCellLineWidth,this.plots_color=a.default_plots_color,this.plots_width=a.default_plots_width,this.plots_showIntegration=a.default_plots_showIntegration,this.plots_integrationColor=a.default_plots_integrationColor,this.plots_integrationLineWidth=a.default_plots_integrationLineWidth,this.plots_showGrid=a.default_plots_showGrid,this.plots_gridColor=a.default_plots_gridColor,this.plots_gridLineWidth=a.default_plots_gridLineWidth,this.plots_showYAxis=a.default_plots_showYAxis,this.plots_flipXAxis=a.default_plots_flipXAxis,this.text_font_size=a.default_text_font_size,this.text_font_families=[],b=0,c=a.default_text_font_families.length;c>b;b++)this.text_font_families[b]=a.default_text_font_families[b];this.text_color=a.default_text_color,this.set3DRepresentation=function(b){this.bonds_display=this.atoms_display=!0,this.bonds_color="#777777",this.bonds_showBondOrders_3D=this.bonds_useJMOLColors=this.atoms_useJMOLColors=this.atoms_useVDWDiameters_3D=!0,this.bonds_renderAsLines_3D=!1,"Ball and Stick"==b?(this.atoms_vdwMultiplier_3D=.3,this.bonds_useJMOLColors=!1,this.bonds_cylinderDiameter_3D=.3,this.bonds_materialAmbientColor_3D=a.default_atoms_materialAmbientColor_3D):"van der Waals Spheres"==b?(this.bonds_display=!1,this.atoms_vdwMultiplier_3D=1):"Stick"==b?(this.bonds_showBondOrders_3D=this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=this.atoms_sphereDiameter_3D=.8,this.bonds_materialAmbientColor_3D=this.atoms_materialAmbientColor_3D):"Wireframe"==b?(this.atoms_useVDWDiameters_3D=!1,this.bonds_cylinderDiameter_3D=.05,this.atoms_sphereDiameter_3D=.15,this.bonds_materialAmbientColor_3D=a.default_atoms_materialAmbientColor_3D):"Line"==b?(this.atoms_display=!1,this.bonds_renderAsLines_3D=!0,this.bonds_width_2D=1,this.bonds_cylinderDiameter_3D=.05):alert('"'+b+'" is not recognized. Use one of the following strings:\n\n1. Ball and Stick\n2. van der Waals Spheres\n3. Stick\n4. Wireframe\n5. Line\n')
},this.getFontString=function(a,b,c,d){var e=[];for(c&&e.push("bold "),d&&e.push("italic "),e.push(a+"px "),a=0,c=b.length;c>a;a++)d=b[a],-1!=d.indexOf(" ")&&(d='"'+d+'"'),e.push((0!=a?",":"")+d);return e.join("")}}}(ChemDoodle,ChemDoodle.structures,Math),function(a,b,c,d){c.getPointsPerAngstrom=function(){return a.default_bondLength_2D/a.default_angstromsPerBondLength},c.BondDeducer=function(){return this.margin=1.1,this.deduceCovalentBonds=function(a,e){var f=c.getPointsPerAngstrom();e&&(f=e);for(var g=0,h=a.atoms.length;h>g;g++)for(var i=g+1;h>i;i++){var j=a.atoms[g],k=a.atoms[i];j.distance3D(k)<(b[j.label].covalentRadius+b[k.label].covalentRadius)*f*this.margin&&a.bonds.push(new d.Bond(j,k,1))}},!0}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.informatics,ChemDoodle.structures),function(a){a.HydrogenDeducer=function(){return this.removeHydrogens=function(a){for(var b=[],c=[],d=0,e=a.bonds.length;e>d;d++)"H"!=a.bonds[d].a1.label&&"H"!=a.bonds[d].a2.label&&c.push(a.bonds[d]);for(d=0,e=a.atoms.length;e>d;d++)"H"!=a.atoms[d].label&&b.push(a.atoms[d]);a.atoms=b,a.bonds=c},!0}}(ChemDoodle.informatics),function(a,b,c){b.MolecularSurfaceGenerator=function(){return this.generateSurface=function(a,b,d,e,f){return new c.MolecularSurface(a,b,d,e,f)},!0}}(ChemDoodle,ChemDoodle.informatics,ChemDoodle.structures),function(a,b){a.Splitter=function(){return this.split=function(a){for(var c=[],d=0,e=a.atoms.length;e>d;d++)a.atoms[d].visited=!1;for(d=0,e=a.bonds.length;e>d;d++)a.bonds[d].visited=!1;for(d=0,e=a.atoms.length;e>d;d++){var f=a.atoms[d];if(!f.visited){var g=new b.Molecule;g.atoms.push(f),f.visited=!0;var h=new b.Queue;for(h.enqueue(f);!h.isEmpty();)for(var f=h.dequeue(),i=0,j=a.bonds.length;j>i;i++){var k=a.bonds[i];k.contains(f)&&!k.visited&&(k.visited=!0,g.bonds.push(k),k=k.getNeighbor(f),k.visited||(k.visited=!0,g.atoms.push(k),h.enqueue(k)))}c.push(g)}}return c},!0}}(ChemDoodle.informatics,ChemDoodle.structures),function(a,b){a.StructureBuilder=function(){return this.copy=function(a){for(var c=0,d=a.atoms.length;d>c;c++)a.atoms[c].metaID=c;for(var e=new b.Molecule,c=0,d=a.atoms.length;d>c;c++)e.atoms[c]=new b.Atom(a.atoms[c].label,a.atoms[c].x,a.atoms[c].y,a.atoms[c].z);for(c=0,d=a.bonds.length;d>c;c++)e.bonds[c]=new b.Bond(e.atoms[a.bonds[c].a1.metaID],e.atoms[a.bonds[c].a2.metaID],a.bonds[c].bondOrder);return e},!0}}(ChemDoodle.informatics,ChemDoodle.structures),function(a){a._Counter=function(){return this.value=0,this.molecule=null,this.setMolecule=function(a){this.value=0,this.molecule=a,this.innerCalculate&&this.innerCalculate()},!0}}(ChemDoodle.informatics),function(a){a.FrerejacqueNumberCounter=function(a){return this.setMolecule(a),!0},a.FrerejacqueNumberCounter.prototype=new a._Counter,a.FrerejacqueNumberCounter.prototype.innerCalculate=function(){this.value=this.molecule.bonds.length-this.molecule.atoms.length+new a.NumberOfMoleculesCounter(this.molecule).value}}(ChemDoodle.informatics),function(a,b){b.NumberOfMoleculesCounter=function(a){return this.setMolecule(a),!0},b.NumberOfMoleculesCounter.prototype=new b._Counter,b.NumberOfMoleculesCounter.prototype.innerCalculate=function(){for(var b=0,c=this.molecule.atoms.length;c>b;b++)this.molecule.atoms[b].visited=!1;for(b=0,c=this.molecule.atoms.length;c>b;b++)if(!this.molecule.atoms[b].visited){this.value++;var d=new a.Queue;for(this.molecule.atoms[b].visited=!0,d.enqueue(this.molecule.atoms[b]);!d.isEmpty();)for(var e=d.dequeue(),f=0,g=this.molecule.bonds.length;g>f;f++){var h=this.molecule.bonds[f];h.contains(e)&&(h=h.getNeighbor(e),h.visited||(h.visited=!0,d.enqueue(h)))}}}}(ChemDoodle.structures,ChemDoodle.informatics),function(a,b){a._RingFinder=function(){return this.rings=this.bonds=this.atoms=null,this.reduce=function(a){for(var b=0,c=a.atoms.length;c>b;b++)a.atoms[b].visited=!1;for(b=0,c=a.bonds.length;c>b;b++)a.bonds[b].visited=!1;for(var d=!0;d;)for(d=!1,b=0,c=a.atoms.length;c>b;b++){for(var e=0,f=null,g=0,h=a.bonds.length;h>g;g++)if(a.bonds[g].contains(a.atoms[b])&&!a.bonds[g].visited){if(e++,2==e)break;f=a.bonds[g]}1==e&&(d=!0,f.visited=!0,a.atoms[b].visited=!0)}for(b=0,c=a.atoms.length;c>b;b++)a.atoms[b].visited||this.atoms.push(a.atoms[b]);for(b=0,c=a.bonds.length;c>b;b++)a.bonds[b].visited||this.bonds.push(a.bonds[b]);0==this.bonds.length&&0!=this.atoms.length&&(this.atoms=[])},this.setMolecule=function(a){this.atoms=[],this.bonds=[],this.rings=[],this.reduce(a),2<this.atoms.length&&this.innerGetRings&&this.innerGetRings()},this.fuse=function(){for(var a=0,c=this.rings.length;c>a;a++)for(var d=0,e=this.bonds.length;e>d;d++)-1!=b(this.bonds[d].a1,this.rings[a].atoms)&&-1!=b(this.bonds[d].a2,this.rings[a].atoms)&&this.rings[a].bonds.push(this.bonds[d])},!0}}(ChemDoodle.informatics,jQuery.inArray),function(a,b,c){function d(a,e){if(this.atoms=[],e)for(var f=0,g=e.atoms.length;g>f;f++)this.atoms[f]=e.atoms[f];return this.atoms.push(a),this.grow=function(a,b){for(var e=this.atoms[this.atoms.length-1],f=[],g=0,h=a.length;h>g;g++)if(a[g].contains(e)){var i=a[g].getNeighbor(e);-1==c(i,b)&&f.push(i)}for(e=[],g=0,h=f.length;h>g;g++)e.push(new d(f[g],this));return e},this.check=function(a,d,e){for(var f=0,g=d.atoms.length-1;g>f;f++)if(-1!=c(d.atoms[f],this.atoms))return null;var h=null;if(d.atoms[d.atoms.length-1]==this.atoms[this.atoms.length-1]){for(h=new b.Ring,h.atoms[0]=e,f=0,g=this.atoms.length;g>f;f++)h.atoms.push(this.atoms[f]);for(f=d.atoms.length-2;f>=0;f--)h.atoms.push(d.atoms[f])}else{for(var i=[],f=0,g=a.length;g>f;f++)a[f].contains(d.atoms[d.atoms.length-1])&&i.push(a[f]);for(f=0,g=i.length;g>f;f++)if((1==d.atoms.length||!i[f].contains(d.atoms[d.atoms.length-2]))&&i[f].contains(this.atoms[this.atoms.length-1])){for(h=new b.Ring,h.atoms[0]=e,a=0,e=this.atoms.length;e>a;a++)h.atoms.push(this.atoms[a]);for(a=d.atoms.length-1;a>=0;a--)h.atoms.push(d.atoms[a]);break}}return h},!0}a.EulerFacetRingFinder=function(a){return this.fingerBreak=5,this.setMolecule(a),!0},a.EulerFacetRingFinder.prototype=new a._RingFinder,a.EulerFacetRingFinder.prototype.innerGetRings=function(){for(var a=0,b=this.atoms.length;b>a;a++){for(var e=[],f=0,g=this.bonds.length;g>f;f++)this.bonds[f].contains(this.atoms[a])&&e.push(this.bonds[f].getNeighbor(this.atoms[a]));for(f=0,g=e.length;g>f;f++)for(var h=f+1;h<e.length;h++){var i=[];i[0]=new d(e[f]),i[1]=new d(e[h]);var j=[];j[0]=this.atoms[a];for(var k=0,l=e.length;l>k;k++)k!=f&&k!=h&&j.push(e[k]);var m=[];for((k=i[0].check(this.bonds,i[1],this.atoms[a]))&&(m[0]=k);0==m.length&&0<i.length&&i[0].atoms.length<this.fingerBreak;){for(var n=[],k=0,l=i.length;l>k;k++)for(var o=i[k].grow(this.bonds,j),p=0,q=o.length;q>p;p++)n.push(o[p]);for(i=n,k=0,l=i.length;l>k;k++)for(p=k+1;l>p;p++)(q=i[k].check(this.bonds,i[p],this.atoms[a]))&&m.push(q);if(0==m.length){for(n=[],k=0,l=j.length;l>k;k++)for(p=0,q=this.bonds.length;q>p;p++)this.bonds[p].contains(j[k])&&(e=this.bonds[p].getNeighbor(j[k]),-1==c(e,j)&&-1==c(e,n)&&n.push(e));for(k=0,l=n.length;l>k;k++)j.push(n[k])}}if(0<m.length){for(i=null,k=0,l=m.length;l>k;k++)(!i||i.atoms.length>m[k].atoms.length)&&(i=m[k]);for(m=!1,k=0,l=this.rings.length;l>k;k++){for(j=!0,p=0,q=i.atoms.length;q>p;p++)if(-1==c(i.atoms[p],this.rings[k].atoms)){j=!1;break}if(j){m=!0;break}}m||this.rings.push(i)}}}this.fuse()}}(ChemDoodle.informatics,ChemDoodle.structures,jQuery.inArray),function(a){a.SSSRFinder=function(b){if(this.rings=[],0<b.atoms.length){var c=new a.FrerejacqueNumberCounter(b).value,d=new a.EulerFacetRingFinder(b).rings;d.sort(function(a,b){return a.atoms.length-b.atoms.length});for(var e=0,f=b.bonds.length;f>e;e++)b.bonds[e].visited=!1;for(e=0,f=d.length;f>e;e++){for(var b=!1,g=0,h=d[e].bonds.length;h>g;g++)if(!d[e].bonds[g].visited){b=!0;break}if(b){for(g=0,h=d[e].bonds.length;h>g;g++)d[e].bonds[g].visited=!0;this.rings.push(d[e])}if(this.rings.length==c)break}}return!0}}(ChemDoodle.informatics),function(a,b,c,d,e,f,g,h){var i=/\s+/g,j=/\(|\)|\s+/g,k=/\'|\s+/g,l=/,|\'|\s+/g,m=/[0-9]/g,n={P:[],A:[[0,.5,.5]],B:[[.5,0,.5]],C:[[.5,.5,0]],I:[[.5,.5,.5]],R:[[2/3,1/3,1/3],[1/3,2/3,2/3]],S:[[1/3,1/3,2/3],[2/3,2/3,1/3]],T:[[1/3,2/3,1/3],[2/3,1/3,2/3]],F:[[0,.5,.5],[.5,0,.5],[.5,.5,0]]},o=function(a){var b=0,c=0,d=0,e=0,f=a.indexOf("x"),g=a.indexOf("y"),h=a.indexOf("z");if(-1!=f&&(c++,f>0&&"+"!=a.charAt(f-1)&&(c*=-1)),-1!=g&&(d++,g>0&&"+"!=a.charAt(g-1)&&(d*=-1)),-1!=h&&(e++,h>0&&"+"!=a.charAt(h-1)&&(e*=-1)),2<a.length)for(f="+",g=0,h=a.length;h>g;g++){var i=a.charAt(g);"-"!=i&&"/"!=i||g!=a.length-1&&!a.charAt(g+1).match(m)||(f=i),i.match(m)&&("+"==f?b+=parseInt(i):"-"==f?b-=parseInt(i):"/"==f&&(b/=parseInt(i)))}return[b,c,d,e]};c.CIFInterpreter=function(){this.read=function(c,g,p,q){var g=g?g:1,p=p?p:1,q=q?q:1,r=new d.Molecule;if(null==c||0==c.length)return r;for(var s=c.split("\n"),t=0,u=0,v=0,w=0,x=0,y=0,z="P",A=c=null,B=null,C=!0;0<s.length;)if(C?B=s.shift():C=!0,0<B.length)if(b.stringStartsWith(B,"_cell_length_a"))t=parseFloat(B.split(j)[1]);else if(b.stringStartsWith(B,"_cell_length_b"))u=parseFloat(B.split(j)[1]);else if(b.stringStartsWith(B,"_cell_length_c"))v=parseFloat(B.split(j)[1]);else if(b.stringStartsWith(B,"_cell_angle_alpha"))w=e.PI*parseFloat(B.split(j)[1])/180;else if(b.stringStartsWith(B,"_cell_angle_beta"))x=e.PI*parseFloat(B.split(j)[1])/180;else if(b.stringStartsWith(B,"_cell_angle_gamma"))y=e.PI*parseFloat(B.split(j)[1])/180;else if(b.stringStartsWith(B,"_symmetry_space_group_name_H-M"))z=B.split(k)[1];else if(b.stringStartsWith(B,"loop_")){for(var D={fields:[],lines:[]},E=!1;!b.stringStartsWith(B=s.shift(),"loop_")&&0<B.length;)if(b.stringStartsWith(B,"_")){if(E)break;D.fields=D.fields.concat(B.split(i))}else E=!0,D.lines.push(B);(b.stringStartsWith(B,"loop_")||b.stringStartsWith(B,"_"))&&(C=!1),-1!=h("_symmetry_equiv_pos_as_xyz",D.fields)||-1!=h("_space_group_symop_operation_xyz",D.fields)?c=D:-1!=h("_atom_site_label",D.fields)&&(A=D)}if(B=t,w=(e.cos(w)-e.cos(y)*e.cos(x))/e.sin(y),w=[B,0,0,0,u*e.cos(y),u*e.sin(y),0,0,v*e.cos(x),v*w,v*e.sqrt(1-e.pow(e.cos(x),2)-w*w),0,0,0,0,1],null!=A){for(v=altLabelIndex=xIndex=yIndex=zIndex=-1,y=0,x=A.fields.length;x>y;y++)B=A.fields[y],"_atom_site_type_symbol"==B?v=y:"_atom_site_label"==B?altLabelIndex=y:"_atom_site_fract_x"==B?xIndex=y:"_atom_site_fract_y"==B?yIndex=y:"_atom_site_fract_z"==B&&(zIndex=y);for(y=0,x=A.lines.length;x>y;y++){for(B=A.lines[y],B=B.split(i);0==B[0].length;)B.shift();r.atoms.push(new d.Atom(B[-1==v?altLabelIndex:v].split(m)[0],parseFloat(B[xIndex]),parseFloat(B[yIndex]),parseFloat(B[zIndex])))}}for(s=n[z],B=[],y=0,x=c.lines.length;x>y;y++){for(z=c.lines[y].split(l);0==z[0].length;)z.shift();for(t=o(z[0]),C=o(z[1]),D=o(z[2]),A=0,u=r.atoms.length;u>A;A++){var z=r.atoms[A],E=z.x*t[1]+z.y*t[2]+z.z*t[3]+t[0],F=z.x*C[1]+z.y*C[2]+z.z*C[3]+C[0],G=z.x*D[1]+z.y*D[2]+z.z*D[3]+D[0];if(B.push(new d.Atom(z.label,E,F,G)),s)for(var v=0,H=s.length;H>v;v++){var I=s[v];B.push(new d.Atom(z.label,E+I[0],F+I[1],G+I[2]))}}}for(y=0,x=B.length;x>y;y++){for(z=B[y];1<=z.x;)z.x--;for(;0>z.x;)z.x++;for(;1<=z.y;)z.y--;for(;0>z.y;)z.y++;for(;1<=z.z;)z.z--;for(;0>z.z;)z.z++}for(c=[],y=0,x=B.length;x>y;y++){for(v=!1,z=B[y],A=0,u=r.atoms.length;u>A;A++)if(1e-4>r.atoms[A].distance3D(z)){v=!0;break}if(!v){for(A=0,u=c.length;u>A;A++)if(1e-4>c[A].distance3D(z)){v=!0;break}v||c.push(z)}}for(r.atoms=r.atoms.concat(c),c=[],y=0;g>y;y++)for(A=0;p>A;A++)for(v=0;q>v;v++)if(0!=y||0!=A||0!=v)for(x=0,B=r.atoms.length;B>x;x++)z=r.atoms[x],c.push(new d.Atom(z.label,z.x+y,z.y+A,z.z+v));for(r.atoms=r.atoms.concat(c),y=0,x=r.atoms.length;x>y;y++)z=r.atoms[y],c=f.multiplyVec3(w,[z.x,z.y,z.z]),z.x=c[0],z.y=c[1],z.z=c[2];return(new a.informatics.BondDeducer).deduceCovalentBonds(r,1),g=[-g/2,-p/2,-q/2],r.unitCellVectors={o:f.multiplyVec3(w,g,[]),x:f.multiplyVec3(w,[g[0]+1,g[1],g[2]]),y:f.multiplyVec3(w,[g[0],g[1]+1,g[2]]),z:f.multiplyVec3(w,[g[0],g[1],g[2]+1]),xy:f.multiplyVec3(w,[g[0]+1,g[1]+1,g[2]]),xz:f.multiplyVec3(w,[g[0]+1,g[1],g[2]+1]),yz:f.multiplyVec3(w,[g[0],g[1]+1,g[2]+1]),xyz:f.multiplyVec3(w,[g[0]+1,g[1]+1,g[2]+1])},r}};var p=new c.CIFInterpreter;a.readCIF=function(a,b,c,d){return p.read(a,b,c,d)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,Math,mat4,vec3,jQuery.inArray),function(a,b,c,d,e){function f(a,b,c){for(var d=a.length,e="",f=0;b-d>f;f++)e+=" ";return c?a+e:e+a}c.MOLInterpreter=function(){this.read=function(c,e){e||(e=a.default_bondLength_2D);var f=new d.Molecule;if(null==c||0==c.length)return f;for(var g=c.split("\n"),h=g[3],i=parseInt(h.substring(0,3)),h=parseInt(h.substring(3,6)),j=0;i>j;j++){var k=g[4+j];f.atoms[j]=new d.Atom(k.substring(31,34),parseFloat(k.substring(0,10))*e,(1==e?1:-1)*parseFloat(k.substring(10,20))*e,parseFloat(k.substring(20,30))*e);var l=parseInt(k.substring(34,36));switch(0!=l&&null!=b[f.atoms[j].label]&&(f.atoms[j].mass=b[f.atoms[j].label].mass+l),parseInt(k.substring(36,39))){case 1:f.atoms[j].charge=3;break;case 2:f.atoms[j].charge=2;break;case 3:f.atoms[j].charge=1;break;case 5:f.atoms[j].charge=-1;break;case 6:f.atoms[j].charge=-2;break;case 7:f.atoms[j].charge=-3}}for(j=0;h>j;j++){var k=g[4+i+j],m=parseInt(k.substring(6,9)),l=parseInt(k.substring(9,12));if(m>3)switch(m){case 4:m=1.5;break;default:m=1}switch(k=new d.Bond(f.atoms[parseInt(k.substring(0,3))-1],f.atoms[parseInt(k.substring(3,6))-1],m),l){case 3:k.stereo=d.Bond.STEREO_AMBIGUOUS;break;case 1:k.stereo=d.Bond.STEREO_PROTRUDING;break;case 6:k.stereo=d.Bond.STEREO_RECESSED}f.bonds[j]=k}return f},this.write=function(c){var g;g="Molecule from ChemDoodle Web Components\n\nhttp://www.ichemlabs.com\n"+f(c.atoms.length.toString(),3)+f(c.bonds.length.toString(),3)+"  0  0  0  0            999 v2000\n";for(var h=c.getCenter(),i=0,j=c.atoms.length;j>i;i++){var k=c.atoms[i],l=" 0";if(-1!=k.mass&&null!=b[k.label]){var m=k.mass-b[k.label].mass;5>m&&m>-4&&(l=(m>-1?" ":"")+m)}if(m="  0",0!=k.charge)switch(k.charge){case 3:m="  1";break;case 2:m="  2";break;case 1:m="  3";break;case-1:m="  5";break;case-2:m="  6";break;case-3:m="  7"}g=g+f(((k.x-h.x)/a.default_bondLength_2D).toFixed(4),10)+f((-(k.y-h.y)/a.default_bondLength_2D).toFixed(4),10)+f((k.z/a.default_bondLength_2D).toFixed(4),10)+" "+f(k.label,3,!0)+l+m+"  0  0  0  0\n"}for(i=0,j=c.bonds.length;j>i;i++)h=c.bonds[i],k=0,h.stereo==d.Bond.STEREO_AMBIGUOUS?k=3:h.stereo==d.Bond.STEREO_PROTRUDING?k=1:h.stereo==d.Bond.STEREO_RECESSED&&(k=6),g=g+f((e(h.a1,c.atoms)+1).toString(),3)+f((e(h.a2,c.atoms)+1).toString(),3)+f(h.bondOrder.toString(),3)+"  "+k+"     0  0\n";return g+"M  END"}};var g=new c.MOLInterpreter;a.readMOL=function(a,b){return g.read(a,b)},a.writeMOL=function(a){return g.write(a)}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.io,ChemDoodle.structures,jQuery.inArray),function(a,b,c,d,e){c.PDBInterpreter=function(){function c(a,b,c,d,e){for(var f=0,g=b.length;g>f;f++){var h=b[f];if(h.id==c&&d>=h.start&&d<=h.end){e?a.helix=!0:a.sheet=!0,d+1==h.end&&(a.arrow=!0);break}}}this.calculateRibbonDistances=!1,this.read=function(f,g){var h=new d.Molecule;if(h.chains=[],null==f||0==f.length)return h;var i=f.split("\n");g||(g=1);for(var j=[],k=[],l=null,m=[],n=0,o=i.length;o>n;n++){var p=i[n];if(b.stringStartsWith(p,"HELIX"))j.push({id:p.substring(19,20),start:parseInt(p.substring(21,25)),end:parseInt(p.substring(33,37))});else if(b.stringStartsWith(p,"SHEET"))k.push({id:p.substring(21,22),start:parseInt(p.substring(22,26)),end:parseInt(p.substring(33,37))});else if(b.stringStartsWith(p,"ATOM")){var q=p.substring(16,17);if(" "==q||"A"==q){if(q=e(p.substring(76,78)),0==q.length){var r=e(p.substring(12,14));"HD"==r?q="H":0<r.length&&(q=1<r.length?r.charAt(0)+r.substring(1).toLowerCase():r)}if(q=new d.Atom(q,parseFloat(p.substring(30,38))*g,parseFloat(p.substring(38,46))*g,parseFloat(p.substring(46,54))*g),q.hetatm=!1,h.atoms.push(q),r=parseInt(p.substring(22,26)),0==m.length)for(var s=0;2>s;s++){var t=new d.Residue(-1);t.cp1=q,t.cp2=q,m.push(t)}r!=Number.NaN&&m[m.length-1].resSeq!=r&&(s=new d.Residue(r),s.name=e(p.substring(17,20)),3==s.name.length?s.name=s.name.substring(0,1)+s.name.substring(1).toLowerCase():2==s.name.length&&"D"==s.name.charAt(0)&&(s.name=s.name.substring(1)),m.push(s),t=p.substring(21,22),c(s,j,t,r,!0),c(s,k,t,r,!1)),p=e(p.substring(12,16)),r=m[m.length-1],"CA"==p||"P"==p||"O5'"==p?r.cp1||(r.cp1=q):"N3"==p&&("C"==r.name||"U"==r.name||"T"==r.name)||"N1"==p&&("A"==r.name||"G"==r.name)?r.cp3=q:"C2"==p?r.cp4=q:"C4"==p&&("C"==r.name||"U"==r.name||"T"==r.name)||"C6"==p&&("A"==r.name||"G"==r.name)?r.cp5=q:"O"==p||"C6"==p&&("C"==r.name||"U"==r.name||"T"==r.name)||"N9"==p?m[m.length-1].cp2||(("C6"==p||"N9"==p)&&(l=q),r.cp2=q):"C"==p&&(l=q)}}else if(b.stringStartsWith(p,"HETATM"))q=e(p.substring(76,78)),1<q.length&&(q=q.substring(0,1)+q.substring(1).toLowerCase()),q=new d.Atom(q,parseFloat(p.substring(30,38))*g,parseFloat(p.substring(38,46))*g,parseFloat(p.substring(46,54))*g),q.hetatm=!0,"HOH"==e(p.substring(17,20))&&(q.isWater=!0),h.atoms.push(q);else if(b.stringStartsWith(p,"TER"))this.endChain(h,m,l),m=[];else if(b.stringStartsWith(p,"ENDMDL"))break}return this.endChain(h,m,l),(new a.informatics.BondDeducer).deduceCovalentBonds(h,g),this.calculateRibbonDistances&&this.calculateDistances(h),h},this.endChain=function(a,b,c){if(0<b.length){var e=b[b.length-1];for(e.cp1||(e.cp1=a.atoms[a.atoms.length-2]),e.cp2||(e.cp2=a.atoms[a.atoms.length-1]),e=0;4>e;e++){var f=new d.Residue(-1);f.cp1=c,f.cp2=b[b.length-1].cp2,b.push(f)}a.chains.push(b)}},this.calculateDistances=function(a){for(var b=[],c=[],d=0,e=a.atoms.length;e>d;d++){var f=a.atoms[d];f.hetatm?f.isWater||b.push(f):c.push(f)}for(d=0,e=c.length;e>d;d++)if(f=c[d],f.closestDistance=Number.POSITIVE_INFINITY,0==b.length)f.closestDistance=0;else for(var a=0,g=b.length;g>a;a++)f.closestDistance=Math.min(f.closestDistance,f.distance3D(b[a]))}};var f=new c.PDBInterpreter;a.readPDB=function(a,b){return f.read(a,b)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,jQuery.trim),function(a,b,c,d,e,f){var g={"@":0,A:1,B:2,C:3,D:4,E:5,F:6,G:7,H:8,I:9,a:-1,b:-2,c:-3,d:-4,e:-5,f:-6,g:-7,h:-8,i:-9},h={"%":0,J:1,K:2,L:3,M:4,N:5,O:6,P:7,Q:8,R:9,j:-1,k:-2,l:-3,m:-4,n:-5,o:-6,p:-7,q:-8,r:-9},i={S:1,T:2,U:3,V:4,W:5,X:6,Y:7,Z:8,s:9};c.JCAMPInterpreter=function(){this.convertHZ2PPM=!1,this.read=function(a){this.isBreak=function(a){return null!=g[a]||null!=h[a]||null!=i[a]||" "==a||"-"==a||"+"==a},this.getValue=function(a,b){var c=a.charAt(0),d=a.substring(1);return null!=g[c]?parseFloat(g[c]+d):null!=h[c]?parseFloat(h[c]+d)+b:parseFloat(d)};var c=new d.Spectrum;if(null==a||0==a.length)return c;for(var j,k,l,m,a=a.split("\n"),n=[],o=1,p=1,q=1,r=-1,s=-1,t=-1,u=!0,v=!1,w=0,x=a.length;x>w;w++){var y=f(a[w]),z=e.inArray("$$",y);if(-1!=z&&(y=y.substring(0,z)),0!=n.length&&b.stringStartsWith(a[w],"##")){if(z=n.join(""),u&&100>z.length&&c.metadata.push(z),n=[y],b.stringStartsWith(z,"##TITLE="))c.title=f(z.substring(8));else if(b.stringStartsWith(z,"##XUNITS="))c.xUnit=f(z.substring(9)),this.convertHZ2PPM&&"HZ"==c.xUnit.toUpperCase()&&(c.xUnit="PPM",v=!0);else if(b.stringStartsWith(z,"##YUNITS="))c.yUnit=f(z.substring(9));else if(!b.stringStartsWith(z,"##XYPAIRS="))if(b.stringStartsWith(z,"##FIRSTX="))k=parseFloat(f(z.substring(9)));else if(b.stringStartsWith(z,"##LASTX="))j=parseFloat(f(z.substring(8)));else if(b.stringStartsWith(z,"##FIRSTY="))l=parseFloat(f(z.substring(9)));else if(b.stringStartsWith(z,"##NPOINTS="))m=parseFloat(f(z.substring(10)));else if(b.stringStartsWith(z,"##XFACTOR="))o=parseFloat(f(z.substring(10)));else if(b.stringStartsWith(z,"##YFACTOR="))p=parseFloat(f(z.substring(10)));else if(b.stringStartsWith(z,"##DELTAX="))r=parseFloat(f(z.substring(9)));else if(b.stringStartsWith(z,"##.OBSERVE FREQUENCY="))this.convertHZ2PPM&&(q=parseFloat(f(z.substring(21))));else if(b.stringStartsWith(z,"##.SHIFT REFERENCE="))this.convertHZ2PPM&&(t=z.substring(19).split(","),s=parseInt(f(t[2])),t=parseFloat(f(t[3])));else if(b.stringStartsWith(z,"##XYDATA=")){v||(q=1);var y=u=!1,z=z.split("\n"),A=(j-k)/(m-1);if(-1!=r)for(var B=1,C=z.length;C>B;B++)if("|"==z[B].charAt(0)){A=r;break}for(var D,E=k-A,F=l,G=0,B=1,C=z.length;C>B;B++){for(var H=[],E=f(z[B]),n=[],I=!1,J=0,K=E.length;K>J;J++)this.isBreak(E.charAt(J))?(0<n.length&&!(1==n.length&&" "==n[0])&&H.push(n.join("")),n=[E.charAt(J)]):"|"==E.charAt(J)?I=!0:n.push(E.charAt(J));for(H.push(n.join("")),E=parseFloat(H[0])*o-A,J=1,K=H.length;K>J;J++)if(F=H[J],null!=i[F.charAt(0)])for(var L=parseInt(i[F.charAt(0)]+F.substring(1))-1,M=0;L>M;M++)E+=A,G=this.getValue(D,G),F=G*p,N++,c.data[c.data.length-1]=new d.Point(E/q,F);else null!=g[F.charAt(0)]&&y?(F=this.getValue(F,G)*p,I&&(E+=A,c.data.push(new d.Point(E/q,F)))):(y=null!=h[F.charAt(0)],D=F,E+=A,G=this.getValue(F,G),F=G*p,N++,c.data.push(new d.Point(E/q,F)))}if(-1!=s)for(y=t-c.data[s-1].x,w=0,x=c.data.length;x>w;w++)c.data[w].x+=y}else if(b.stringStartsWith(z,"##PEAK TABLE=")){u=!1,c.continuous=!1;for(var z=z.split("\n"),N=0,B=1,C=z.length;C>B;B++)for(y=z[B].split(/[\s,]+/),N+=y.length/2,J=0,K=y.length;K>J+1;J+=2)c.data.push(new d.Point(parseFloat(f(y[J])),parseFloat(f(y[J+1]))))}}else 0!=n.length&&n.push("\n"),n.push(f(y))}return c.setup(),c}};var j=new c.JCAMPInterpreter;j.convertHZ2PPM=!0,a.readJCAMP=function(a){return j.read(a)}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.io,ChemDoodle.structures,jQuery,jQuery.trim),function(a,b,c){a.fromJSONChains=function(a){for(var c=[],d=0,e=a.cs.length;e>d;d++){for(var f=a.cs[d],g=[],h=0,i=f.length;i>h;h++){var j=f[h],k=new b.Residue;k.name=j.n,k.cp1=new b.Atom("",j.x1,j.y1,j.z1),k.cp2=new b.Atom("",j.x2,j.y2,j.z2),j.x3&&(k.cp3=new b.Atom("",j.x3,j.y3,j.z3),k.cp4=new b.Atom("",j.x4,j.y4,j.z4),k.cp5=new b.Atom("",j.x5,j.y5,j.z5)),k.helix=j.h,k.sheet=j.s,k.arrow=j.a,g.push(k)}c.push(g)}return c},a.fromJSONPDB=function(b){var c=a.fromJSONDummy(b.mol);return c.findRings=!1,c.fromJSON=!0,c.chains=a.fromJSONChains(b.ribbons),c},a.fromJSONDummy=function(a){for(var c=new b.Molecule,d=0,e=a.a.length;e>d;d++){var f=a.a[d],g=new b.Atom(f.l?f.l:"C",f.x,f.y);f.z&&(g.z=f.z),f.c&&(g.charge=f.c),f.m&&(g.mass=f.m),void 0!=f.p_h&&(g.hetatm=f.p_h),void 0!=f.p_w&&(g.isWater=f.p_w),void 0!=f.p_d&&(g.closestDistance=f.p_d),c.atoms.push(g)}for(d=0,e=a.b.length;e>d;d++)f=a.b[d],g=new b.Bond(c.atoms[f.b],c.atoms[f.e],f.o?f.o:1),f.s&&(g.stereo=f.s),c.bonds.push(g);return c},a.toJSONDummy=function(a){for(var d={a:[],b:[]},e=0,f=a.atoms.length;f>e;e++){var g=a.atoms[e];d.a[e]={x:g.x,y:g.y},"C"!=g.label&&(d.a[e].l=g.label),0!=g.z&&(d.a[e].z=g.z),0!=g.charge&&(d.a[e].c=g.charge),-1!=g.mass&&(d.a[e].m=g.mass)}for(e=0,f=a.bonds.length;f>e;e++)g=a.bonds[e],d.b[e]={b:c(g.a1,a.atoms),e:c(g.a2,a.atoms)},1!=g.bondOrder&&(d.b[e].o=g.bondOrder),g.stereo!=b.Bond.STEREO_NONE&&(d.b[e].s=g.stereo);return d}}(ChemDoodle.io,ChemDoodle.structures,jQuery.inArray),function(a,b,c,d,e,f){d.XYZInterpreter=function(){this.deduceCovalentBonds=!0,this.read=function(b){var d=new e.Molecule;if(null==b||0==b.length)return d;for(var b=b.split("\n"),g=parseInt(f(b[0])),h=0;g>h;h++){var i=b[h+2].split(/\s+/g);d.atoms[h]=new e.Atom(isNaN(i[0])?i[0]:c[parseInt(i[0])-1],parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3]))}return this.deduceCovalentBonds&&(new a.informatics.BondDeducer).deduceCovalentBonds(d,1),d}};var g=new d.XYZInterpreter;a.readXYZ=function(a){return g.read(a)}}(ChemDoodle,ChemDoodle.ELEMENT,ChemDoodle.SYMBOLS,ChemDoodle.io,ChemDoodle.structures,jQuery.trim),ChemDoodle.monitor=function(a,b,c){var d={CANVAS_DRAGGING:null,CANVAS_OVER:null,ALT:!1,SHIFT:!1,META:!1};return a.supports_touch()||b(c).ready(function(){b(c).mousemove(function(a){null!=d.CANVAS_DRAGGING&&d.CANVAS_DRAGGING.drag&&(d.CANVAS_DRAGGING.prehandleEvent(a),d.CANVAS_DRAGGING.drag(a))}),b(c).mouseup(function(a){null!=d.CANVAS_DRAGGING&&d.CANVAS_DRAGGING!=d.CANVAS_OVER&&d.CANVAS_DRAGGING.mouseup&&(d.CANVAS_DRAGGING.prehandleEvent(a),d.CANVAS_DRAGGING.mouseup(a)),d.CANVAS_DRAGGING=null}),b(c).keydown(function(a){d.SHIFT=a.shiftKey,d.ALT=a.altKey,d.META=a.metaKey;var b=d.CANVAS_OVER;null!=d.CANVAS_DRAGGING&&(b=d.CANVAS_DRAGGING),null!=b&&b.keydown&&(b.prehandleEvent(a),b.keydown(a))}),b(c).keypress(function(a){var b=d.CANVAS_OVER;null!=d.CANVAS_DRAGGING&&(b=d.CANVAS_DRAGGING),null!=b&&b.keypress&&(b.prehandleEvent(a),b.keypress(a))}),b(c).keyup(function(a){d.SHIFT=a.shiftKey,d.ALT=a.altKey,d.META=a.metaKey;var b=d.CANVAS_OVER;null!=d.CANVAS_DRAGGING&&(b=d.CANVAS_DRAGGING),null!=b&&b.keyup&&(b.prehandleEvent(a),b.keyup(a))})}),d}(ChemDoodle.featureDetection,jQuery,document),function(a,b,c,d,e,f,g,h,i){a._Canvas=function(){return this.image=this.emptyMessage=this.molecule=null,!0},a._Canvas.prototype.repaint=function(){var a=h.getElementById(this.id);if(a.getContext){var b=a.getContext("2d"),c=i.devicePixelRatio?i.devicePixelRatio:1;1!=c&&(a.width=this.width*c,a.height=this.height*c,b.scale(c,c)),null==this.image?null!=this.specs.backgroundColor&&(b.fillStyle=this.specs.backgroundColor,b.fillRect(0,0,this.width,this.height)):b.drawImage(this.image,0,0),this.innerRepaint?this.innerRepaint(b):null!=this.molecule&&0<this.molecule.atoms.length?(b.save(),b.translate(this.width/2,this.height/2),b.rotate(this.specs.rotateAngle),b.scale(this.specs.scale,this.specs.scale),b.translate(-this.width/2,-this.height/2),this.molecule.draw(b,this.specs),b.restore()):null!=this.emptyMessage&&(b.fillStyle="#737683",b.textAlign="center",b.textBaseline="middle",b.font="18px Helvetica, Verdana, Arial, Sans-serif",b.fillText(this.emptyMessage,this.width/2,this.height/2)),this.drawChildExtras&&this.drawChildExtras(b)}},a._Canvas.prototype.resize=function(a,b){var c=e("#"+this.id);c.attr({width:a,height:b}),c.css("width",a),c.css("height",b),this.width=a,this.height=b,this instanceof ChemDoodle._Canvas3D?(this.gl.viewport(0,0,a,b),this.setupScene()):this.molecule&&(this.center(),this.molecule.check()),this.repaint()},a._Canvas.prototype.setBackgroundImage=function(a){this.image=new Image;var b=this;this.image.onload=function(){b.repaint()},this.image.src=a},a._Canvas.prototype.loadMolecule=function(a){this.molecule=a,this.center(),this instanceof ChemDoodle._Canvas3D||this.molecule.check(),this.afterLoadMolecule&&this.afterLoadMolecule(),this.repaint()},a._Canvas.prototype.center=function(){var a=this.molecule.getCenter3D(),b=new d.Atom("C",this.width/2,this.height/2,0);b.sub3D(a);for(var a=0,c=this.molecule.atoms.length;c>a;a++)this.molecule.atoms[a].add3D(b);b=this.molecule.getDimension(),this.specs.scale=1,(b.x>this.width||b.y>this.height)&&(this.specs.scale=.85*g.min(this.width/b.x,this.height/b.y))},a._Canvas.prototype.create=function(g,i,j){if(this.id=g,this.width=i,this.height=j,h.getElementById(g)){var k=e("#"+g);i?k.attr("width",i):this.width=k.attr("width"),j?k.attr("height",j):this.height=k.attr("height")}else h.writeln(!a.featureDetection.supports_canvas_text()&&f.msie&&"6"<=f.version?'<div style="border: 1px solid black;" width="'+i+'" height="'+j+'">Please install <a href="http://code.google.com/chrome/chromeframe/">Google Chrome Frame</a>, then restart Internet Explorer.</div>':'<canvas class="ChemDoodleWebComponent" id="'+g+'" width="'+i+'" height="'+j+'" alt="ChemDoodle Web Component">This browser does not support HTML5/Canvas.</canvas>');g=e("#"+g),g.css("width",this.width),g.css("height",this.height),this.specs=new d.VisualSpecifications;var l=this;b.supports_touch()?(g.bind("touchstart",function(a){var b=(new Date).getTime();l.lastTouch&&1==a.originalEvent.touches.length&&500>b-l.lastTouch?l.dbltap?(l.prehandleEvent(a),l.dbltap(a)):l.dblclick?(l.prehandleEvent(a),l.dblclick(a)):l.touchstart?(l.prehandleEvent(a),l.touchstart(a)):l.mousedown&&(l.prehandleEvent(a),l.mousedown(a)):l.touchstart?(l.prehandleEvent(a),l.touchstart(a),this.hold&&clearTimeout(this.hold),this.touchhold&&(this.hold=setTimeout(function(){l.touchhold(a)},1e3))):l.mousedown&&(l.prehandleEvent(a),l.mousedown(a)),l.lastTouch=b}),g.bind("touchmove",function(a){if(null!=this.hold&&(clearTimeout(this.hold),this.hold=null),1<a.originalEvent.touches.length&&l.multitouchmove){var b=a.originalEvent.touches.length;l.prehandleEvent(a);for(var c=new d.Point(-a.offset.left*b,-a.offset.top*b),e=0;b>e;e++)c.x+=a.originalEvent.changedTouches[e].pageX,c.y+=a.originalEvent.changedTouches[e].pageY;c.x/=b,c.y/=b,a.p=c,l.multitouchmove(a,b)}else l.touchmove?(l.prehandleEvent(a),l.touchmove(a)):l.drag&&(l.prehandleEvent(a),l.drag(a))}),g.bind("touchend",function(a){null!=this.hold&&(clearTimeout(this.hold),this.hold=null),l.touchend?(l.prehandleEvent(a),l.touchend(a)):l.mouseup&&(l.prehandleEvent(a),l.mouseup(a)),250>(new Date).getTime()-l.lastTouch&&(l.tap?(l.prehandleEvent(a),l.tap(a)):l.click&&(l.prehandleEvent(a),l.click(a)))}),g.bind("gesturestart",function(a){l.gesturestart&&(l.prehandleEvent(a),l.gesturestart(a))}),g.bind("gesturechange",function(a){l.gesturechange&&(l.prehandleEvent(a),l.gesturechange(a))}),g.bind("gestureend",function(a){l.gestureend&&(l.prehandleEvent(a),l.gestureend(a))})):(g.click(function(a){switch(a.which){case 1:l.click&&(l.prehandleEvent(a),l.click(a));break;case 2:l.middleclick&&(l.prehandleEvent(a),l.middleclick(a));break;case 3:l.rightclick&&(l.prehandleEvent(a),l.rightclick(a))}}),g.dblclick(function(a){l.dblclick&&(l.prehandleEvent(a),l.dblclick(a))}),g.mousedown(function(a){switch(a.which){case 1:c.CANVAS_DRAGGING=l,l.mousedown&&(l.prehandleEvent(a),l.mousedown(a));break;case 2:l.middlemousedown&&(l.prehandleEvent(a),l.middlemousedown(a));break;case 3:l.rightmousedown&&(l.prehandleEvent(a),l.rightmousedown(a))}}),g.mousemove(function(a){null==c.CANVAS_DRAGGING&&l.mousemove&&(l.prehandleEvent(a),l.mousemove(a))}),g.mouseout(function(a){c.CANVAS_OVER=null,l.mouseout&&(l.prehandleEvent(a),l.mouseout(a))}),g.mouseover(function(a){c.CANVAS_OVER=l,l.mouseover&&(l.prehandleEvent(a),l.mouseover(a))}),g.mouseup(function(a){switch(a.which){case 1:l.mouseup&&(l.prehandleEvent(a),l.mouseup(a));break;case 2:l.middlemouseup&&(l.prehandleEvent(a),l.middlemouseup(a));break;case 3:l.rightmouseup&&(l.prehandleEvent(a),l.rightmouseup(a))}}),g.mousewheel(function(a,b){l.mousewheel&&(l.prehandleEvent(a),l.mousewheel(a,b))})),this.subCreate&&this.subCreate()},a._Canvas.prototype.getMolecule=function(){return this.molecule},a._Canvas.prototype.prehandleEvent=function(a){a.originalEvent.changedTouches&&(a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY),a.preventDefault(),a.offset=e("#"+this.id).offset(),a.p=new d.Point(a.pageX-a.offset.left,a.pageY-a.offset.top)}}(ChemDoodle,ChemDoodle.featureDetection,ChemDoodle.monitor,ChemDoodle.structures,jQuery,jQuery.browser,Math,document,window),function(a){a._AnimatorCanvas=function(a,b,c){return a&&this.create(a,b,c),this.timeout=33,!0},a._AnimatorCanvas.prototype=new a._Canvas,a._AnimatorCanvas.prototype.startAnimation=function(){this.stopAnimation(),this.lastTime=(new Date).getTime();var a=this;this.nextFrame&&(this.handle=setInterval(function(){var b=(new Date).getTime();a.nextFrame(b-a.lastTime),a.repaint(),a.lastTime=b},this.timeout))},a._AnimatorCanvas.prototype.stopAnimation=function(){null!=this.handle&&(clearInterval(this.handle),this.handle=null)},a._AnimatorCanvas.prototype.isRunning=function(){return null!=this.handle}}(ChemDoodle),function(a,b){a.FileCanvas=function(a,c,d,e){return a&&this.create(a,c,d),form='<br><form name="FileForm" enctype="multipart/form-data" method="POST" action="'+e+'" target="HiddenFileFrame"><input type="file" name="f" /><input type="submit" name="submitbutton" value="Show File" /></form><iframe id="HFF-'+a+'" name="HiddenFileFrame" height="0" width="0" style="display:none;" onLoad="GetMolFromFrame(\'HFF-'+a+"', "+a+')"></iframe>',b.writeln(form),this.emptyMessage="Click below to load file",this.repaint(),!0},a.FileCanvas.prototype=new a._Canvas}(ChemDoodle,document),function(a){a.HyperlinkCanvas=function(a,b,c,d,e,f){return a&&this.create(a,b,c),this.urlOrFunction=d,this.color=e?e:"blue",this.size=f?f:2,this.openInNewWindow=!0,this.e=this.hoverImage=null,!0},a.HyperlinkCanvas.prototype=new a._Canvas,a.HyperlinkCanvas.prototype.drawChildExtras=function(a){null!=this.e&&(null==this.hoverImage?(a.strokeStyle=this.color,a.lineWidth=2*this.size,a.strokeRect(0,0,this.width,this.height)):a.drawImage(this.hoverImage,0,0))
},a.HyperlinkCanvas.prototype.setHoverImage=function(a){this.hoverImage=new Image,this.hoverImage.src=a},a.HyperlinkCanvas.prototype.click=function(){this.e=null,this.repaint(),this.urlOrFunction instanceof Function?this.urlOrFunction():this.openInNewWindow?window.open(this.urlOrFunction):location.href=this.urlOrFunction},a.HyperlinkCanvas.prototype.mouseout=function(){this.e=null,this.repaint()},a.HyperlinkCanvas.prototype.mouseover=function(a){this.e=a,this.repaint()}}(ChemDoodle),function(a,b,c,d){a.MolGrabberCanvas=function(a,b,e){a&&this.create(a,b,e),b=[],b.push('<br><input type="text" id="'),b.push(a),b.push('_query" size="32" value="" />'),b.push("<br><nobr>"),b.push('<select id="'),b.push(a),b.push('_select">'),b.push('<option value="chemexper">ChemExper'),b.push('<option value="chemspider">ChemSpider'),b.push('<option value="pubchem" selected>PubChem'),b.push("</select>"),b.push('<button id="'),b.push(a),b.push('_submit">Show Molecule</button>'),b.push("</nobr>"),d.writeln(b.join(""));var f=this;return c("#"+a+"_submit").click(function(){f.search()}),c("#"+a+"_query").keypress(function(a){13==a.which&&f.search()}),this.emptyMessage="Enter search term below",this.repaint(),!0},a.MolGrabberCanvas.prototype=new a._Canvas,a.MolGrabberCanvas.prototype.setSearchTerm=function(a){c("#"+this.id+"_query").val(a),this.search()},a.MolGrabberCanvas.prototype.search=function(){this.emptyMessage="Searching...",this.molecule=null,this.repaint();var a=this;b.getMoleculeFromDatabase(c("#"+this.id+"_select").val(),c("#"+this.id+"_query").val(),function(b){a.loadMolecule(b)})}}(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document),function(a,b,c){a.RotatorCanvas=function(a,c,d,e){return a&&this.create(a,c,d),this.rotate3D=e,this.zIncrement=this.yIncrement=this.xIncrement=a=b.PI/15,!0},a.RotatorCanvas.prototype=new a._AnimatorCanvas,a.RotatorCanvas.prototype.nextFrame=function(a){if(null==this.molecule)this.stopAnimation();else{var b=a/1e3;if(this.rotate3D){a=[],c.identity(a),c.rotate(a,this.xIncrement*b,[1,0,0]),c.rotate(a,this.yIncrement*b,[0,1,0]),c.rotate(a,this.zIncrement*b,[0,0,1]);for(var b=0,d=this.molecule.atoms.length;d>b;b++){var e=this.molecule.atoms[b],f=[e.x-this.width/2,e.y-this.height/2,e.z];c.multiplyVec3(a,f),e.x=f[0]+this.width/2,e.y=f[1]+this.height/2,e.z=f[2]}for(b=0,d=this.molecule.rings.length;d>b;b++)this.molecule.rings[b].center=this.molecule.rings[b].getCenter();this.specs.atoms_display&&this.specs.atoms_circles_2D&&this.molecule.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&this.molecule.sortBondsByZ()}else this.specs.rotateAngle+=this.zIncrement*b}},a.RotatorCanvas.prototype.dblclick=function(){this.isRunning()?this.stopAnimation():this.startAnimation()}}(ChemDoodle,Math,mat4),function(a){a.SlideshowCanvas=function(a,b,c){return a&&this.create(a,b,c),this.molecules=[],this.curIndex=0,this.timeout=5e3,this.alpha=0,this.innerHandle=null,this.phase=0,!0},a.SlideshowCanvas.prototype=new a._AnimatorCanvas,a.SlideshowCanvas.prototype.drawChildExtras=function(a){a.fillStyle="rgba("+parseInt(this.specs.backgroundColor.substring(1,3),16)+", "+parseInt(this.specs.backgroundColor.substring(3,5),16)+", "+parseInt(this.specs.backgroundColor.substring(5,7),16)+", "+this.alpha+")",a.fillRect(0,0,this.width,this.height)},a.SlideshowCanvas.prototype.nextFrame=function(){if(0==this.molecules.length)this.stopAnimation();else{this.phase=0;var a=this,b=1;this.innerHandle=setInterval(function(){a.alpha=b/15,a.repaint(),15==b&&a.breakInnerHandle(),b++},33)}},a.SlideshowCanvas.prototype.breakInnerHandle=function(){if(null!=this.innerHandle&&(clearInterval(this.innerHandle),this.innerHandle=null),0==this.phase){this.curIndex++,this.curIndex>this.molecules.length-1&&(this.curIndex=0),this.alpha=1,this.loadMolecule(this.molecules[this.curIndex]),this.phase=1;var a=this,b=1;this.innerHandle=setInterval(function(){a.alpha=(15-b)/15,a.repaint(),15==b&&a.breakInnerHandle(),b++},33)}else 1==this.phase&&(this.alpha=0,this.repaint())},a.SlideshowCanvas.prototype.addMolecule=function(a){0==this.molecules.length&&this.loadMolecule(a),this.molecules.push(a)}}(ChemDoodle),function(a,b,c,d,e){a.TransformCanvas=function(a,b,c,d){return a&&this.create(a,b,c),this.lastPoint=null,this.rotate3D=d,this.rotationMultMod=1.3,this.lastPinchScale=1,this.lastGestureRotate=0,!0},a.TransformCanvas.prototype=new a._Canvas,a.TransformCanvas.prototype.mousedown=function(a){this.lastPoint=a.p},a.TransformCanvas.prototype.dblclick=function(){var a=new c.Point(this.width/2,this.height/2);a.sub(this.molecule.getCenter());for(var b=0,d=this.molecule.atoms.length;d>b;b++)this.molecule.atoms[b].add(a);this.molecule.check(),this.repaint()},a.TransformCanvas.prototype.drag=function(a){if(!this.lastPoint.multi){if(b.ALT){var f=new c.Point(a.p.x,a.p.y);f.sub(this.lastPoint);for(var g=0,h=this.molecule.atoms.length;h>g;g++)this.molecule.atoms[g].add(f);this.lastPoint=a.p,this.molecule.check()}else if(1==this.rotate3D){for(f=d.max(this.width/4,this.height/4),g=(a.p.x-this.lastPoint.x)/f*this.rotationMultMod,h=-(a.p.y-this.lastPoint.y)/f*this.rotationMultMod,f=[],e.identity(f),e.rotate(f,h,[1,0,0]),e.rotate(f,g,[0,1,0]),g=0,h=this.molecule.atoms.length;h>g;g++){var i=this.molecule.atoms[g],j=[i.x-this.width/2,i.y-this.height/2,i.z];e.multiplyVec3(f,j),i.x=j[0]+this.width/2,i.y=j[1]+this.height/2,i.z=j[2]}for(g=0,h=this.molecule.rings.length;h>g;g++)this.molecule.rings[g].center=this.molecule.rings[g].getCenter();this.lastPoint=a.p,this.specs.atoms_display&&this.specs.atoms_circles_2D&&this.molecule.sortAtomsByZ(),this.specs.bonds_display&&this.specs.bonds_clearOverlaps_2D&&this.molecule.sortBondsByZ()}else f=new c.Point(this.width/2,this.height/2),g=f.angle(this.lastPoint),this.specs.rotateAngle-=f.angle(a.p)-g,this.lastPoint=a.p;this.repaint()}},a.TransformCanvas.prototype.mousewheel=function(a,b){this.specs.scale+=b/10,.01>this.specs.scale&&(this.specs.scale=.01),this.repaint()},a.TransformCanvas.prototype.multitouchmove=function(a,b){if(2==b)if(this.lastPoint.multi){var d=new c.Point(a.p.x,a.p.y);d.sub(this.lastPoint);for(var e=0,f=this.molecule.atoms.length;f>e;e++)this.molecule.atoms[e].add(d);this.lastPoint=a.p,this.lastPoint.multi=!0,this.molecule.check(),this.repaint()}else this.lastPoint=a.p,this.lastPoint.multi=!0},a.TransformCanvas.prototype.gesturechange=function(a){if(0!=a.originalEvent.scale-this.lastPinchScale&&(this.specs.scale*=a.originalEvent.scale/this.lastPinchScale,.01>this.specs.scale&&(this.specs.scale=.01),this.lastPinchScale=a.originalEvent.scale),0!=this.lastGestureRotate-a.originalEvent.rotation){for(var b=(this.lastGestureRotate-a.originalEvent.rotation)/180*d.PI,e=new c.Point(this.width/2,this.height/2),f=0,g=this.molecule.atoms.length;g>f;f++){var h=e.distance(this.molecule.atoms[f]),i=e.angle(this.molecule.atoms[f])+b;this.molecule.atoms[f].x=e.x+h*d.cos(i),this.molecule.atoms[f].y=e.y-h*d.sin(i)}this.lastGestureRotate=a.originalEvent.rotation,this.molecule.check()}this.repaint()},a.TransformCanvas.prototype.gestureend=function(){this.lastPinchScale=1,this.lastGestureRotate=0}}(ChemDoodle,ChemDoodle.monitor,ChemDoodle.structures,Math,mat4),function(a){a.ViewerCanvas=function(a,b,c){return a&&this.create(a,b,c),!0},a.ViewerCanvas.prototype=new a._Canvas}(ChemDoodle),function(a){a._SpectrumCanvas=function(a,b,c){return a&&this.create(a,b,c),this.spectrum=null,this.emptyMessage="No Spectrum Loaded or Recognized",this.getMolecule=this.loadMolecule=null,!0},a._SpectrumCanvas.prototype=new a._Canvas,a._SpectrumCanvas.prototype.innerRepaint=function(a){null!=this.spectrum&&0<this.spectrum.data.length?this.spectrum.draw(a,this.specs,this.width,this.height):null!=this.emptyMessage&&(a.fillStyle="#737683",a.textAlign="center",a.textBaseline="middle",a.font="18px Helvetica, Verdana, Arial, Sans-serif",a.fillText(this.emptyMessage,this.width/2,this.height/2))},a._SpectrumCanvas.prototype.loadSpectrum=function(a){this.spectrum=a,this.repaint()},a._SpectrumCanvas.prototype.getSpectrum=function(){return this.spectrum}}(ChemDoodle,document),function(a){a.ObserverCanvas=function(a,b,c){return a&&this.create(a,b,c),!0},a.ObserverCanvas.prototype=new a._SpectrumCanvas}(ChemDoodle),function(a,b,c){a.PerspectiveCanvas=function(a,b,c){return a&&this.create(a,b,c),this.dragRange=null,this.rescaleYAxisOnZoom=!0,this.lastPinchScale=1,!0},a.PerspectiveCanvas.prototype=new a._SpectrumCanvas,a.PerspectiveCanvas.prototype.mousedown=function(b){this.dragRange=new a.structures.Point(b.p.x,b.p.x)},a.PerspectiveCanvas.prototype.mouseup=function(a){null!=this.dragRange&&this.dragRange.x!=this.dragRange.y&&(this.dragRange.multi||(a=this.spectrum.zoom(this.dragRange.x,a.p.x,this.width,this.rescaleYAxisOnZoom),this.rescaleYAxisOnZoom&&(this.specs.scale=a)),this.dragRange=null,this.repaint())},a.PerspectiveCanvas.prototype.drag=function(a){null!=this.dragRange&&(this.dragRange.multi?this.dragRange=null:(b.SHIFT&&(this.spectrum.translate(a.p.x-this.dragRange.x,this.width),this.dragRange.x=a.p.x),this.dragRange.y=a.p.x),this.repaint())},a.PerspectiveCanvas.prototype.drawChildExtras=function(a){if(null!=this.dragRange){var b=c.min(this.dragRange.x,this.dragRange.y),d=c.max(this.dragRange.x,this.dragRange.y);for(a.strokeStyle="gray",a.lineStyle=1,a.beginPath(),a.moveTo(b,this.height/2);d>=b;b++)5>b%10?a.lineTo(b,c.round(this.height/2)):a.moveTo(b,c.round(this.height/2));a.stroke()}},a.PerspectiveCanvas.prototype.mousewheel=function(a,b){this.specs.scale+=b/10,.01>this.specs.scale&&(this.specs.scale=.01),this.repaint()},a.PerspectiveCanvas.prototype.dblclick=function(){this.spectrum.setup(),this.specs.scale=1,this.repaint()},a.PerspectiveCanvas.prototype.multitouchmove=function(b,c){2==c&&(null!=this.dragRange&&this.dragRange.multi?(this.spectrum.translate(b.p.x-this.dragRange.x,this.width),this.dragRange.x=b.p.x,this.dragRange.y=b.p.x,this.repaint()):(this.dragRange=new a.structures.Point(b.p.x,b.p.x),this.dragRange.multi=!0))},a.PerspectiveCanvas.prototype.gesturechange=function(a){this.specs.scale*=a.originalEvent.scale/this.lastPinchScale,.01>this.specs.scale&&(this.specs.scale=.01),this.lastPinchScale=a.originalEvent.scale,this.repaint()},a.PerspectiveCanvas.prototype.gestureend=function(){this.lastPinchScale=1}}(ChemDoodle,ChemDoodle.monitor,Math),function(a,b,c,d,e,f,g,h,i,j){a._Canvas3D=function(a,b,c){return a&&this.create(a,b,c),this.rotationMatrix=h.identity([]),this.translationMatrix=h.identity([]),this.lastPoint=null,this.emptyMessage="WebGL is Unavailable!",!0},a._Canvas3D.prototype=new a._Canvas,a._Canvas3D.prototype.afterLoadMolecule=function(){var a=this.molecule.getDimension();this.maxDimension=f.max(a.x,a.y),this.translationMatrix=h.translate(h.identity([]),[0,0,-this.maxDimension-10]),this.setupScene()},a._Canvas3D.prototype.setViewDistance=function(a){this.translationMatrix=h.translate(h.identity([]),[0,0,-a])},a._Canvas3D.prototype.repaint=function(){this.gl&&(this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT),this.gl.modelViewMatrix=h.multiply(this.translationMatrix,this.rotationMatrix,[]),this.gl.rotationMatrix=this.rotationMatrix,null!=this.molecule&&this.molecule.render(this.gl,this.specs),this.gl.flush())},a._Canvas3D.prototype.center=function(){g.getElementById(this.id);for(var a=this.molecule.getCenter3D(),b=0,c=this.molecule.atoms.length;c>b;b++)this.molecule.atoms[b].sub3D(a);if(this.molecule.chains&&this.molecule.fromJSON)for(b=0,c=this.molecule.chains.length;c>b;b++)for(var d=this.molecule.chains[b],e=0,f=d.length;f>e;e++){var h=d[e];h.cp1.sub3D(a),h.cp2.sub3D(a),h.cp3&&(h.cp3.sub3D(a),h.cp4.sub3D(a),h.cp5.sub3D(a))}},a._Canvas3D.prototype.subCreate=function(){try{var a=g.getElementById(this.id);this.gl=a.getContext("webgl"),this.gl||(this.gl=a.getContext("experimental-webgl"))}catch(b){}this.gl?(this.gl.viewport(0,0,this.width,this.height),this.gl.program=this.gl.createProgram(),this.gl.shader=new d.Shader,this.gl.shader.init(this.gl),this.setupScene()):(this.molecule=null,this.displayMessage())},a._Canvas.prototype.displayMessage=function(){var a=g.getElementById(this.id);a.getContext&&(a=a.getContext("2d"),null!=this.specs.backgroundColor&&(a.fillStyle=this.specs.backgroundColor,a.fillRect(0,0,this.width,this.height)),null!=this.emptyMessage)&&(a.fillStyle="#737683",a.textAlign="center",a.textBaseline="middle",a.font="18px Helvetica, Verdana, Arial, Sans-serif",a.fillText(this.emptyMessage,this.width/2,this.height/2))},a._Canvas3D.prototype.setupScene=function(){if(this.gl){var a=c.getRGB(this.specs.backgroundColor,1);if(this.gl.clearColor(a[0],a[1],a[2],1),this.gl.clearDepth(1),this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.sphereBuffer=new d.Sphere(1,this.specs.atoms_resolution_3D,this.specs.atoms_resolution_3D),this.gl.starBuffer=new d.Star,this.gl.cylinderBuffer=new d.Cylinder(1,1,this.specs.bonds_resolution_3D),this.gl.lineBuffer=new d.Line,this.molecule&&this.molecule!=this.previousMolecule&&(this.previousMolecule=this.molecule,this.molecule.unitCellVectors&&(this.molecule.unitCell=new d.UnitCell(this.molecule.unitCellVectors)),this.molecule.chains)){this.molecule.ribbons=[],this.molecule.cartoons=[],this.molecule.tubes=[];for(var a=0,g=this.molecule.chains.length;g>a;a++){var k=this.molecule.chains[a],l=2<k.length&&e[k[2].name]&&"#BEA06E"==e[k[2].name].aminoColor;if(0<k.length&&!k[0].lineSegments){for(var m=0,n=k.length-1;n>m;m++)l&&(k[m].Ns=1),k[m].setup(k[m+1].cp1);if(!l)for(m=1,n=k.length-1;n>m;m++)b.vec3AngleFrom(k[m-1].D,k[m].D)>f.PI/2&&(k[m].guidePointsSmall.reverse(),k[m].guidePointsLarge.reverse(),j.scale(k[m].D,-1));for(m=1,n=k.length-3;n>m;m++)k[m].computeLineSegments(k[m-1],k[m+1],k[m+2],!l);k.pop(),k.pop(),k.pop(),k.shift()}var o=c.hsl2rgb(1==g?.5:a/g,1,.5),o="rgb("+o[0]+","+o[1]+","+o[2]+")";if(k.chainColor=o,l)k=new d.Tube(k,this.specs.nucleics_tubeThickness,this.specs.nucleics_tubeResolution_3D),k.chainColor=o,this.molecule.tubes.push(k);else{for(l={front:new d.Ribbon(k,this.specs.proteins_ribbonThickness,!1),back:new d.Ribbon(k,-this.specs.proteins_ribbonThickness,!1)},l.front.chainColor=o,l.back.chainColor=o,m=0,n=l.front.segments.length;n>m;m++)l.front.segments[m].chainColor=o;for(m=0,n=l.back.segments.length;n>m;m++)l.back.segments[m].chainColor=o;for(this.molecule.ribbons.push(l),k={front:new d.Ribbon(k,this.specs.proteins_ribbonThickness,!0),back:new d.Ribbon(k,-this.specs.proteins_ribbonThickness,!0)},k.front.chainColor=o,k.back.chainColor=o,m=0,n=k.front.segments.length;n>m;m++)k.front.segments[m].chainColor=o;for(m=0,n=k.back.segments.length;n>m;m++)k.back.segments[m].chainColor=o;for(m=0,n=k.front.cartoonSegments.length;n>m;m++)k.front.cartoonSegments[m].chainColor=o;for(m=0,n=k.back.cartoonSegments.length;n>m;m++)k.back.cartoonSegments[m].chainColor=o;this.molecule.cartoons.push(k)}}}this.gl.lighting=new d.Light(this.specs.lightDiffuseColor_3D,this.specs.lightSpecularColor_3D,this.specs.lightDirection_3D),this.gl.lighting.lightScene(this.gl),this.gl.material=new d.Material(this.gl),a=this.width/this.height,this.specs.projectionWidthHeightRatio_3D&&(a=this.specs.projectionWidthHeightRatio_3D),this.gl.projectionMatrix=this.specs.projectionPerspective_3D?h.perspective(this.specs.projectionPerspectiveVerticalFieldOfView_3D,a,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D):h.ortho(-this.specs.projectionOrthoWidth_3D/2,this.specs.projectionOrthoWidth_3D/2,-this.specs.projectionOrthoWidth_3D/2/a,this.specs.projectionOrthoWidth_3D/2/a,this.specs.projectionFrontCulling_3D,this.specs.projectionBackCulling_3D),this.gl.uniformMatrix4fv(this.gl.getUniformLocation(this.gl.program,"u_projection_matrix"),!1,this.gl.projectionMatrix);var p=this.gl.getUniformLocation(this.gl.program,"u_model_view_matrix"),q=this.gl.getUniformLocation(this.gl.program,"u_normal_matrix");this.gl.setMatrixUniforms=function(a){this.uniformMatrix4fv(p,!1,a),a=i.transpose(h.toInverseMat3(a,[])),this.uniformMatrix3fv(q,!1,a)}}},a._Canvas3D.prototype.mousedown=function(a){this.lastPoint=a.p},a._Canvas3D.prototype.rightmousedown=function(a){this.lastPoint=a.p},a._Canvas3D.prototype.drag=function(b){if(a.monitor.ALT){var c=new d.Point(b.p.x,b.p.y);c.sub(this.lastPoint),h.translate(this.translationMatrix,[c.x/20,-c.y/20,0])}else{f.max(this.width/4,this.height/4);var e=b.p.x-this.lastPoint.x,c=b.p.y-this.lastPoint.y,e=h.rotate(h.identity([]),e*f.PI/180,[0,1,0]);h.rotate(e,c*f.PI/180,[1,0,0]),this.rotationMatrix=h.multiply(e,this.rotationMatrix)}this.lastPoint=b.p,this.repaint()},a._Canvas3D.prototype.mousewheel=function(a,b){var c=b*this.maxDimension/8;this.specs.projectionPerspective_3D?h.translate(this.translationMatrix,[0,0,c]):(this.specs.projectionOrthoWidth_3D-=c,this.setupScene()),this.repaint()}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,ChemDoodle.structures,ChemDoodle.RESIDUE,Math,document,mat4,mat3,vec3,window),function(a,b,c,d){a.MolGrabberCanvas3D=function(a,b,e){a&&this.create(a,b,e),b=[],b.push('<br><input type="text" id="'),b.push(a),b.push('_query" size="32" value="" />'),b.push("<br><nobr>"),b.push('<select id="'),b.push(a),b.push('_select">'),b.push('<option value="pubchem" selected>PubChem'),b.push("</select>"),b.push('<button id="'),b.push(a),b.push('_submit">Show Molecule</button>'),b.push("</nobr>"),d.writeln(b.join(""));var f=this;return c("#"+a+"_submit").click(function(){f.search()}),c("#"+a+"_query").keypress(function(a){13==a.which&&f.search()}),!0},a.MolGrabberCanvas3D.prototype=new a._Canvas3D,a.MolGrabberCanvas3D.prototype.setSearchTerm=function(a){c("#"+this.id+"_query").val(a),this.search()},a.MolGrabberCanvas3D.prototype.search=function(){var a=this;b.getMoleculeFromDatabase(c("#"+this.id+"_select").val(),c("#"+this.id+"_query").val(),function(b){a.loadMolecule(b)},3)}}(ChemDoodle,ChemDoodle.iChemLabs,jQuery,document),function(a,b){a.MovieCanvas3D=function(a,b,c){return a&&this.create(a,b,c),this.timeout=50,this.molecules=[],this.frameNumber=0,this.playMode=2,this.reverse=!1,!0},a.MovieCanvas3D.PLAY_ONCE=0,a.MovieCanvas3D.PLAY_LOOP=1,a.MovieCanvas3D.PLAY_SPRING=2,a.MovieCanvas3D.prototype=new a._Canvas3D,a.MovieCanvas3D.prototype.startAnimation=a._AnimatorCanvas.prototype.startAnimation,a.MovieCanvas3D.prototype.stopAnimation=a._AnimatorCanvas.prototype.stopAnimation,a.MovieCanvas3D.prototype.isRunning=a._AnimatorCanvas.prototype.isRunning,a.MovieCanvas3D.prototype.dblclick=a.RotatorCanvas.prototype.dblclick,a.MovieCanvas3D.prototype.nextFrame=function(){this.molecule=this.molecules[this.frameNumber],2==this.playMode&&this.reverse?(this.frameNumber--,0>this.frameNumber&&(this.frameNumber=1,this.reverse=!1)):(this.frameNumber++,this.frameNumber>=this.molecules.length&&(2==this.playMode?(this.frameNumber-=2,this.reverse=!0):(this.frameNumber=0,0==this.playMode&&this.stopAnimation())))},a.MovieCanvas3D.prototype.center=function(){var a=this.molecule.getCenter3D(),c=new b.Atom;c.sub3D(a);for(var a=0,d=this.molecules.length;d>a;a++)for(var e=this.molecules[a],f=0,g=e.atoms.length;g>f;f++)e.atoms[f].add3D(c)}}(ChemDoodle,ChemDoodle.structures),function(a,b,c){a.RotatorCanvas3D=function(a,c,d){return a&&this.create(a,c,d),this.timeout=33,this.zIncrement=this.yIncrement=this.xIncrement=a=b.PI/15,!0},a.RotatorCanvas3D.prototype=new a._Canvas3D,a.RotatorCanvas3D.prototype.startAnimation=a._AnimatorCanvas.prototype.startAnimation,a.RotatorCanvas3D.prototype.stopAnimation=a._AnimatorCanvas.prototype.stopAnimation,a.RotatorCanvas3D.prototype.isRunning=a._AnimatorCanvas.prototype.isRunning,a.RotatorCanvas3D.prototype.dblclick=a.RotatorCanvas.prototype.dblclick,a.RotatorCanvas3D.prototype.mousedown=null,a.RotatorCanvas3D.prototype.rightmousedown=null,a.RotatorCanvas3D.prototype.drag=null,a.RotatorCanvas3D.prototype.mousewheel=null,a.RotatorCanvas3D.prototype.nextFrame=function(a){if(null==this.molecule)this.stopAnimation();else{var b=[];c.identity(b),a/=1e3,c.rotate(b,this.xIncrement*a,[1,0,0]),c.rotate(b,this.yIncrement*a,[0,1,0]),c.rotate(b,this.zIncrement*a,[0,0,1]),c.multiply(this.rotationMatrix,b)}}}(ChemDoodle,Math,mat4),function(a){a.TransformCanvas3D=function(a,b,c){return a&&this.create(a,b,c),!0},a.TransformCanvas3D.prototype=new a._Canvas3D}(ChemDoodle),function(a){a.ViewerCanvas3D=function(a,b,c){return a&&this.create(a,b,c),!0},a.ViewerCanvas3D.prototype=new a._Canvas3D,a.ViewerCanvas3D.prototype.mousedown=null,a.ViewerCanvas3D.prototype.rightmousedown=null,a.ViewerCanvas3D.prototype.drag=null,a.ViewerCanvas3D.prototype.mousewheel=null}(ChemDoodle),function(a,b,c){function d(a,b,c,d){this.element=a,this.x=b,this.y=c,this.dimension=d}a.PeriodicTableCanvas=function(a,b){return this.padding=5,a&&this.create(a,18*b+2*this.padding,10*b+2*this.padding),this.getMolecule=this.loadMolecule=null,this.cellDimension=b?b:20,this.setupTable(),this.repaint(),!0},a.PeriodicTableCanvas.prototype=new a._Canvas,a.PeriodicTableCanvas.prototype.getHoveredElement=function(){return null!=this.hovered?this.hovered.element:null},a.PeriodicTableCanvas.prototype.innerRepaint=function(a){for(var b=0,c=this.cells.length;c>b;b++)this.drawCell(a,this.specs,this.cells[b]);null!=this.hovered&&this.drawCell(a,this.specs,this.hovered),null!=this.selected&&this.drawCell(a,this.specs,this.selected)},a.PeriodicTableCanvas.prototype.setupTable=function(){this.cells=[];for(var b=y=this.padding,c=0,e=0,f=a.SYMBOLS.length;f>e;e++){18==c&&(c=0,y+=this.cellDimension,b=this.padding);var g=a.ELEMENT[a.SYMBOLS[e]];2==g.atomicNumber?(b+=16*this.cellDimension,c+=16):(5==g.atomicNumber||13==g.atomicNumber)&&(b+=10*this.cellDimension,c+=10),(58>g.atomicNumber||71<g.atomicNumber&&90>g.atomicNumber||103<g.atomicNumber)&&113>g.atomicNumber&&(this.cells.push(new d(g,b,y,this.cellDimension)),b+=this.cellDimension,c++)}for(y+=2*this.cellDimension,b=3*this.cellDimension+this.padding,e=57;104>e;e++)g=a.ELEMENT[a.SYMBOLS[e]],90==g.atomicNumber&&(y+=this.cellDimension,b=3*this.cellDimension+this.padding),(58<=g.atomicNumber&&71>=g.atomicNumber||90<=g.atomicNumber&&103>=g.atomicNumber)&&(this.cells.push(new d(g,b,y,this.cellDimension)),b+=this.cellDimension)},a.PeriodicTableCanvas.prototype.drawCell=function(a,c,d){var e=a.createRadialGradient(d.x+d.dimension/3,d.y+d.dimension/3,1.5*d.dimension,d.x+d.dimension/3,d.y+d.dimension/3,d.dimension/10);e.addColorStop(0,"#000000"),e.addColorStop(.7,d.element.jmolColor),e.addColorStop(1,"#FFFFFF"),a.fillStyle=e,b.contextRoundRect(a,d.x,d.y,d.dimension,d.dimension,d.dimension/8),(d==this.hovered||d==this.selected)&&(a.lineWidth=2,a.strokeStyle="#c10000",a.stroke(),a.fillStyle="white"),a.fill(),a.font=c.getFontString(c.text_font_size,c.text_font_families),a.fillStyle=c.text_color,a.textAlign="center",a.textBaseline="middle",a.fillText(d.element.symbol,d.x+d.dimension/2,d.y+d.dimension/2)},a.PeriodicTableCanvas.prototype.click=function(){null!=this.hovered&&(this.selected=this.hovered,this.repaint())},a.PeriodicTableCanvas.prototype.mousemove=function(a){var b=a.p.x,a=a.p.y;this.hovered=null;for(var d=0,e=this.cells.length;e>d;d++){var f=this.cells[d];if(c.isBetween(b,f.x,f.x+f.dimension)&&c.isBetween(a,f.y,f.y+f.dimension)){this.hovered=f;break}}this.repaint()},a.PeriodicTableCanvas.prototype.mouseout=function(){this.hovered=null,this.repaint()}}(ChemDoodle,ChemDoodle.extensions,ChemDoodle.math,document),function(a,b){a._Layout=function(){return!0},a._Layout.prototype.layout=function(){this.innerLayout&&this.innerLayout()},a._Layout.prototype.create=function(a){this.name=a,this.specs=new b.VisualSpecifications}}(ChemDoodle,ChemDoodle.structures),function(a,b,c){a.SimpleReactionLayout=function(a){return this.reactants=[],this.products=[],this.textBelow=this.textAbove=null,this.arrow="&rarr;",this.plus="+",this.create(a),!0},a.SimpleReactionLayout.prototype=new a._Layout,a.SimpleReactionLayout.prototype.addReactant=function(a){this.reactants.push(a)},a.SimpleReactionLayout.prototype.addProduct=function(a){this.products.push(a)},a.SimpleReactionLayout.prototype.innerLayout=function(){c.writeln("<table><tr>");for(var d=0,e=this.reactants.length;e>d;d++){d>0&&c.writeln('<td><span style="font-size:25px;">'+this.plus+"</span></td>"),c.writeln("<td>");var f=this.reactants[d].getDimension(),f=new a.ViewerCanvas(this.name+"_reactant"+d,f.x+60,f.y+60);null==this.specs.backgroundColor&&b("#"+this.name+"_reactant"+d).css("border","0px"),f.specs=this.specs,f.loadMolecule(this.reactants[d]),c.writeln("</td>")}for(c.writeln("<td>"),c.writeln("<table>"),c.writeln("<tr><td>"),c.writeln(null!=this.textAbove?"<center>"+this.textAbove+"</center>":"&nbsp;"),c.writeln("</td></tr>"),c.writeln('<tr><td><center><span style="font-size:25px;">'+this.arrow+"</span></center></td></tr>"),c.writeln("<tr><td>"),c.writeln(null!=this.textBelow?"<center>"+this.textBelow+"</center>":"&nbsp;"),c.writeln("</td></tr>"),c.writeln("</table>"),c.writeln("</td>"),d=0,e=this.products.length;e>d;d++)d>0&&c.writeln('<td><span style="font-size:25px;">'+this.plus+"</td>"),c.writeln("<td>"),f=this.products[d].getDimension(),f=new a.ViewerCanvas(this.name+"_product"+d,f.x+60,f.y+60),null==this.specs.backgroundColor&&b("#"+this.name+"_product"+d).css("border","0px"),f.specs=this.specs,f.loadMolecule(this.products[d]),c.writeln("</td>");c.writeln("</tr></table>")}}(ChemDoodle,jQuery,document),function(a,b,c){a.png={},a.png.create=function(a){c.open(b.getElementById(a.id).toDataURL("image/png"))}}(ChemDoodle.io,document,window);