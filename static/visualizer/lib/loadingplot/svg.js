"undefined"==typeof LoadingPlot&&(LoadingPlot={}),LoadingPlot.SVG=function(a,b,c,d,e){this._nameSpace="http://www.w3.org/2000/svg",this._px=new String("px"),this.navigation=e,this.zonesDone=[],this.zoomChangeCallback=$.Callbacks(),this.moveCallback=$.Callbacks(),this._els=[],this._viewBox=[],this._svgEl=document.createElementNS(this._nameSpace,"svg"),this._svgEl.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this._svgEl.setAttribute("draggable","true"),this._svgEl.setAttribute("preserveAspectRatio","xMidYMid meet"),this._groupElements=document.createElementNS(this._nameSpace,"g"),this._svgEl.appendChild(this._groupElements),this._groupLabels=document.createElementNS(this._nameSpace,"g"),this._svgEl.appendChild(this._groupLabels),this.navigation&&(this.navRect=document.createElementNS(this._nameSpace,"rect"),this.navRect.setAttribute("stroke","red"),this.navRect.setAttribute("fill","none"),this._svgEl.appendChild(this.navRect))},LoadingPlot.SVG.prototype={},LoadingPlot.SVG.prototype.create=function(){this.deltaZoom(0,0,0),this._setEvents()},LoadingPlot.SVG.prototype.remove=function(){this._svgEl.parentElement.removeChild(this._svgEl)},LoadingPlot.SVG.prototype.setViewBoxWidth=function(a,b,c,d){this._viewWidth=c,this._viewHeight=d,this._viewBox=[a,b,this._viewWidth,this._viewHeight],this.zones=[],this.initZoom()},LoadingPlot.SVG.prototype.onZoomChange=function(a){this.zoomChangeCallback.add(a)},LoadingPlot.SVG.prototype.onMove=function(a){this.moveCallback.add(a)},LoadingPlot.SVG.prototype.setSize=function(a,b){this._width=a,this._height=b,this._svgEl.setAttribute("width",a+this._px),this._svgEl.setAttribute("height",b+this._px),this.initZoom()},LoadingPlot.SVG.prototype.initZoom=function(){if(this._viewBox[2]){var a=this._width/this._viewBox[2],b=this._height/this._viewBox[3],c=Math.min(b,a);if(this._zoom=c,this._izoom=c,this._zoomMode=c==b?"y":"x","y"==this._zoomMode){if(!this._width)return;this._viewBox[2]=this._width/b,this._viewWidth=this._viewBox[2]}else{if(!this._height)return;this._viewBox[3]=this._height/a,this._viewHeight=this._viewBox[3]}this.setViewBox(!0)}},LoadingPlot.SVG.prototype.bindTo=function(a){this._wrapper=a},LoadingPlot.SVG.prototype.ready=function(){$(this._wrapper).append(this._svgEl),this.setViewBox(!0);var a=$(this._svgEl).offset(),b=this;$(this._svgEl).on("mouseenter","[class=highlightgroup]",function(){var a=$(this).data("id");b._els[a].mouseover()}).on("mouseout","[class=highlightgroup]",function(){var a=$(this).data("id");b._els[a].mouseout()}),this._svgPosX=a.left,this._svgPosY=a.top,this.doZones()},LoadingPlot.SVG.prototype._setEvents=function(){if(!this.navigation){var a=this;$(this._svgEl).mousewheel(function(b,c){return a.deltaZoom((b.pageX-a._svgPosX)/a._width,(b.pageY-a._svgPosY)/a._height,c),!1}),this._svgEl.addEventListener("mousedown",function(b){a._dragStart(b)}),this._svgEl.addEventListener("mouseup",function(b){a._dragStop(b)}),this._svgEl.addEventListener("mousemove",function(b){viewRatioX=(b.pageX-a._svgPosX)/a._width,viewRatioY=(b.pageY-a._svgPosY)/a._height,a._dragMove(b)})}},LoadingPlot.SVG.prototype._dragStart=function(a){this._dragging=!0,this._dragX=a.pageX,this._dragY=a.pageY},LoadingPlot.SVG.prototype._dragMove=function(a){if(this._dragging){var b=a.pageX,c=b-this._dragX,d=a.pageY,e=d-this._dragY,f=c/this._zoom,g=e/this._zoom,h=f,i=g;this._viewBox[0]-=h,this._viewBox[1]-=i,this.moveCallback.fire(this._viewBox[0]+this._viewBox[2]/2,this._viewBox[1]+this._viewBox[3]/2),this._dragX=b,this._dragY=d,this.setViewBox(),this.doZones()}},LoadingPlot.SVG.prototype.setCenter=function(a,b){this._viewBox[0]=a-this._viewBox[2]/2,this._viewBox[1]=b-this._viewBox[3]/2,this.setViewBox(),this.navigation||(this.moveCallback.fire(this._viewBox[0]+this._viewBox[2]/2,this._viewBox[1]+this._viewBox[3]/2),this.doZones())},LoadingPlot.SVG.prototype.setZoom=function(a){this.deltaZoom(.5,.5,null,Math.pow(2.71828182846,3.68887945411394*a-.693147180559945)*this._izoom)},LoadingPlot.SVG.prototype._dragStop=function(){this._dragging=!1},LoadingPlot.SVG.prototype.deltaZoom=function(a,b,c,d){if(null!==c){Math.abs(c)>=1&&(c=0>c?-.5:.25),this._currentDelta||(this._currentDelta=0,this._accumulatedDelta=0);{this._svgEl.parentNode}this._currentDelta+=c}else{if(c=0,this._zoom=d,"y"==this._zoomMode){var e=this._height/this._zoom;this._currentDelta=Math.log(e/this._viewHeight)/Math.log(2)}else{var f=this._width/this._zoom;this._currentDelta=Math.log(f/this._viewWidth)/Math.log(2)}if(isNaN(this._currentDelta))return void(this._currentDelta=0)}var f=this._viewWidth*Math.pow(2,this._currentDelta),e=this._viewHeight*Math.pow(2,this._currentDelta),g="y"==this._zoomMode?this._height/e:this._width/f;return g/this._izoom<.5?void(this._currentDelta-=c):g/this._izoom>20?void(this._currentDelta-=c):(this._zoom=g,this._viewBox[0]-=a*(f-this._viewBox[2]),this._viewBox[1]-=b*(e-this._viewBox[3]),this._viewBox[2]=f,this._viewBox[3]=e,this.setViewBox(),void(this.navigation||(this.moveCallback.fire(this._viewBox[0]+this._viewBox[2]/2,this._viewBox[1]+this._viewBox[3]/2),this.zoomChangeCallback.fire((Math.log(this._zoom/this._izoom)+.693147180559945)/3.68887945411394),this.changeZoomElements(this._zoom),this.timeSpringUpdate(200))))},LoadingPlot.SVG.prototype.timeSpringUpdate=function(a){window.clearTimeout(this._timeoutZoom),this._timeoutZoom=window.setTimeout(function(){LoadingPlot.SVGElement.prototype.Springs.resolve()},a)},LoadingPlot.SVG.prototype.getViewBox=function(){return this._viewBox},LoadingPlot.SVG.prototype.setViewBox=function(a,b,c,d,e){b&&d&&c&&e&&(this._viewBox=[b,c,d,e]),this.navigation&&!a?(this.navRect.setAttribute("x",this._viewBox[0]),this.navRect.setAttribute("y",this._viewBox[1]),this.navRect.setAttribute("width",this._viewBox[2]),this.navRect.setAttribute("height",this._viewBox[3])):this._svgEl.setAttributeNS(null,"viewBox",this._viewBox.join(" "))},LoadingPlot.SVG.prototype.doZones=function(){var a=Math.floor(20*this._viewBox[0]/this._viewWidth)-2,b=Math.floor(20*this._viewBox[1]/this._viewHeight)-2,c=Math.ceil(20*this._viewBox[2]/this._viewWidth)+2,d=Math.ceil(20*this._viewBox[3]/this._viewWidth)+2;this._zoneMinX=a,this._zoneMinY=b,this._zoneNbX=c,this._zoneNbY=d;for(var e=0;c>=e;e++)for(var f=0;d>=f;f++){var g=1e3*(e+a)+f+b;if(!this.zonesDone[g]){if(this.zones[e+a]&&this.zones[e+a][f+b])for(var h=0;h<this.zones[e+a][f+b].length;h++)this.zones[e+a][f+b][h].changeZoom(this._zoom);this.zonesDone[g]=!0}}},LoadingPlot.SVG.prototype.changeZoomElements=function(a){this._zoom=a,this.zonesDone=[],this.doZones()},LoadingPlot.SVG.prototype.add=function(a){this._els.push(a);var b=a.getX(),c=a.getY(),d=Math.floor(20*b/this._viewWidth),e=Math.floor(20*c/this._viewHeight);if(this.zones[d]=this.zones[d]||[],this.zones[d][e]=this.zones[d][e]||[],this.zones[d][e].push(a),a.id=this._els.length-1,a.zoneIndexX=d,a.zoneIndexY=e,a._nodes){for(var f in a._nodes)this._groupElements.appendChild(a._nodes[f]);a._label&&this._groupLabels.appendChild(a._label),a.inDom()}},LoadingPlot.SVG.prototype.getElementsForSprings=function(){this._zoneNbX=20,this._zoneNbY=20,this._zoneMinX=0,this._zoneMinY=0;for(var a,b=[],c=[],d=0;d<=this._zoneNbX;d++)for(var e=0;e<=this._zoneNbY;e++)if(this.zones[d+this._zoneMinX]&&this.zones[d+this._zoneMinX][e+this._zoneMinY])for(var f=0;f<this.zones[d+this._zoneMinX][e+this._zoneMinY].length;f++)(a=this.zones[d+this._zoneMinX][e+this._zoneMinY][f].getCoordsSprings(b))&&c.push(a);return[b,c]};