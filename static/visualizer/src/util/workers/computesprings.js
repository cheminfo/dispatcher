onmessage=function(a){for(var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y=a.data.message.coords,z=a.data.message.zoom,A=8/z,B=6/z,C=.5,D=.2,E=5e6,F=0;;){if(F++,F>2e3)break;for(b=!0,c=0,d=y.length-1;d>=0;d--){for(e=y[d],force=[0,0],h=e[0]-e[4],i=e[1]-e[5],j=Math.pow(Math.pow(h,2)+Math.pow(i,2),.5),j<e[10]?(0==j?(e[0]=e[0]+e[6]*(Math.random()-.5),e[1]=e[1]+e[6]*(Math.random()-.5)):(e[0]=(e[0]-e[4])*(e[8]/j)+e[4],e[1]=(e[1]-e[5])*(e[8]/j)+e[5]),b=!1):(force[0]-=B*Math.pow(j-e[8],2)*h/j,force[1]-=B*Math.pow(j-e[8],2)*i/j),m=e[1]+1.4*e[3],q=e[1]-1.4*e[3],e[0]>e[4]?(k=e[0]+1.1*e[2],o=e[0]-.1*e[2],ix=e[0]+e[2]/2):(o=e[0]-1.1*e[2],k=e[0]+.1*e[2],ix=e[0]-e[2]/2),g=y.length-1;g>=0;g--)g!=d&&(f=y[g],n=f[1]+1.4*f[3],r=f[1]-1.4*f[3],f[0]>f[4]?(l=f[0]+1.1*f[2],p=f[0]-.1*f[2],jx=f[0]+f[2]/2):(p=f[0]-1.1*f[2],l=f[0]+.1*f[2],jx=f[0]-f[2]/2),s=Math.min(k,l)-Math.max(o,p),t=Math.min(m,n)-Math.max(q,r),u=Math.max(s,0)*Math.max(t,0),0!=u&&(v=u*A,ijx=jx-ix,w=f[1]+f[3]/2-e[1]-e[3]/2,x=Math.pow(ijx*ijx+w*w,.5),force[0]-=v*ijx/x/(e[2]*e[3]),force[1]-=v*w/x,.5/(e[2]*e[3])));e[6]=(e[6]+D*force[0])*C,e[7]=(e[7]+D*force[1])*C,e[0]+=D*e[6],e[1]+=D*e[7],c+=E*(Math.pow(e[6],2)+Math.pow(e[7],2))}if(isNaN(c))break;if(b&&0>c)break}postMessage(a.data)};