define(["modules/default/defaultview","jquery","src/util/api","src/util/util","components/jit/Jit/jit"],function(a,b,c,d,e){function f(){this._id=d.getNextUniqueId()}function g(){this.chart.canvas.clear()}function h(a){var b,c=a.data;if(1===c.length){c=c[0];var d=c.y,e=d.length;b={values:new Array(e)};var f,g,h=c.info||[];if(h[0]){if(h[0].color){f=new Array(e);for(var i=0;e>i;i++)f[i]=h[i].color;b.color=f}if(h[0].name){g=new Array(e);for(var i=0;e>i;i++)g[i]=h[i].name}}for(var i=0;e>i;i++)b.values[i]={values:[d[i]],label:g[i]||"label_"+i}}else{b={};var e=c.length,j=c[0].y.length;b.values=new Array(j),b.label=new Array(j);for(var i=0;e>i;i++)for(var k=0;j>k;k++){var l=c[i],d=l.y;0===i&&(b.values[k]={values:new Array(e),label:"label2 "+k},b.label[k]=l.label),b.values[k].values[i]=d[k]}}return b}function i(a){for(var b=a.length,c={values:new Array(b)},d=0;b>d;d++)c.values[d]={values:[a[d]],label:"label_"+d};return c}return f.prototype=b.extend(!0,{},a,{init:function(){this.dom||(this.dom=b('<div id="'+this._id+'"></div>').css({height:"100%",width:"100%"}),this.module.getDomContent().html(this.dom));var a,c=this.module.getConfiguration("labelColor");c&&0!==c[3]&&(a=d.rgbToHex(c[0],c[1],c[2])),this.chartOptions={injectInto:this._id,animate:!1,showLabels:this.module.getConfiguration("showLabels"),labelOffset:20,offset:30,hoveredColor:!1,updateHeights:this.module.getConfiguration("updateHeights"),sliceOffset:this.module.getConfiguration("sliceOffset"),Label:{color:a}}},inDom:function(){},onResize:function(){this.dom.empty(),this.chart=new e.PieChart(this.chartOptions),this._data&&this.setData(this._data),this.resolveReady()},update:{chart:function(a){if(a){var b=h(a.get());this._data=b,this.setData(b)}},yArray:function(a){if(a){var b=i(a.get());this._data=b,this.setData(b)}}},setData:function(a){this.chart.loadJSON(a)},blank:{chart:g,yArray:g}}),f});