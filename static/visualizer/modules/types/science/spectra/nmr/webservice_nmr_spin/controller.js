define(["modules/default/defaultcontroller","src/util/api","src/util/datatraversing","src/util/urldata"],function(a,b,c,d){function e(){}return e.prototype=$.extend(!0,{},a),e.prototype.moduleInformation={moduleName:"NMR spin system simulation",description:"Allows to enter coupling constant",author:"Luc Patiny",date:"30.12.2013",license:"MIT",cssClass:"webservice_nmr_spin"},e.prototype.initimpl=function(){this.result=null,this.request=null},e.prototype.doAnalysis=function(){for(var a,c,e=this,f=this.module.getConfiguration("url"),g={},a=/\<var:([a-zA-Z0-9]+)\>/;c=a.exec(f);)variable=b.getRepositoryData().get(c[1])||[""],variable=variable[1],f=f.replace("<var:"+c[1]+">",encodeURIComponent(variable));this.url=f,this.request&&this.request.abort&&this.request.abort();var g=this.module.view.system.serializeArray();this.module.view.lock(),this.request=d.post(f,g),this.request.done(function(a){e.request=null,e.module.view.unlock(),"object"==typeof a&&(a=new DataObject.check(a,!0)),e.onAnalysisDone(a)})},e.prototype.onAnalysisDone=function(a){var b=this;this.createDataFromEvent("onSearchReturn","results",a),this.createDataFromEvent("onSearchReturn","url",b.url)},e.prototype.references={results:{label:"Results"},url:{label:"URL"}},e.prototype.events={onSearchReturn:{label:"An analysis has been completed",refVariable:["results"]}},e.prototype.configurationStructure=function(){return{groups:{group:{options:{type:"list"},fields:{url:{type:"text",title:"Service URL"},systemSize:{type:"combo",title:"Spin system","default":"2",options:[{key:"2",title:"AB"},{key:"3",title:"ABC"},{key:"4",title:"ABCD"},{key:"5",title:"ABCDE"},{key:"6",title:"ABCDEF"}]},button:{type:"checkbox",title:"Process button","default":"button",options:{button:""}},buttonlabel:{type:"text","default":"Calculate",title:"Button text"},buttonlabel_exec:{type:"text","default":"Calculating",title:"Button text (executing)"},onloadanalysis:{type:"checkbox",title:"Make one process on load","default":"onload",options:{onload:""}}}}}}},e.prototype.configAliases={url:["groups","group",0,"url",0],button:["groups","group",0,"button",0],systemSize:["groups","group",0,"systemSize"],buttonlabel:["groups","group",0,"buttonlabel",0],buttonlabel_exec:["groups","group",0,"buttonlabel_exec",0],onloadanalysis:["groups","group",0,"onloadanalysis",0,0]},e});