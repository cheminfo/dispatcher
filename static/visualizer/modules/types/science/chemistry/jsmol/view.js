define(["require","modules/default/defaultview"],function(a,b){function c(){}var d={};return window.addEventListener("message",function(a){try{var b=JSON.parse(a.data)}catch(c){return}if("jsmol"===b.module){var e=b.id;if(!d[e])return void console.error("No view with ID "+e);var f=d[e];switch(b.type){case"ready":f.resolveReady();break;default:console.error("Message type not handled: ",b.type)}}}),c.prototype=$.extend(!0,{},b,{init:function(){var b=this,c=this.module.getId();d[c]=this,this.dom=$("<iframe>",{src:a.toUrl("./jsmol.html")}).css("border",0),this.module.getDomContent().html(this.dom).css("overflow","hidden"),this._highlights=this._highlights||[],this.dom.bind("load",function(){b.postMessage("init",{id:c})})},onResize:function(){this.dom.height(this.height).width(this.width),this.postMessage("setSize",{width:this.width,height:this.height})},update:{data:function(a){var b=this;b.postMessage("setMolFile",a.get()),b.module.getConfiguration("script")&&b.postMessage("executeScript",[b.module.getConfiguration("script")])}},onActionReceive:{jsmolscript:function(a){this.module.controller.onJSMolScriptReceive(a)}},executeScript:function(a){this.postMessage("executeScript",[a])},postMessage:function(a,b){var c=this.dom.get(0).contentWindow;c&&c.postMessage(JSON.stringify({type:a,message:b}),"*")},remove:function(a){delete d[a]}}),c});