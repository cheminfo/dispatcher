define(["modules/default/defaultview","src/util/typerenderer","src/util/api"],function(a,b,c){function d(){}return d.prototype=$.extend(!0,{},a,{init:function(){this.dom=$('<div class="ci-displaylist-list-2d-fast"></div>'),this.module.getDomContent().html(this.dom)},blank:{list:function(){c.killHighlight(this.module.getId()),this.dom.empty()}},inDom:function(){var a=this;this.dom.on("mouseenter mouseleave click","> div",function(b){var d=$(this).index(),e=a.list.get()[d];"mouseenter"===b.type?(a.module.controller.setVarFromEvent("onHover","cell","list",[d]),c.highlight(e,1)):"mouseleave"===b.type?c.highlight(e,0):"click"===b.type&&(a.module.controller.setVarFromEvent("onClick","cell","list",[d]),a.module.controller.sendAction("cell",e,"onClick"))}),this.resolveReady()},update:{list:function(a){if(this.defs=[],Array.isArray(a)){var b=this,c=$.proxy(this.module.getConfiguration,this.module),d=100/(c("colnumber",4)||4)+"%",e=this,f=a.get(),g=f.length,h=0;this.dataReady=$.Deferred();var i=Array(g);e.list=f;var c=$.proxy(this.module.getConfiguration,this.module),j=c("colorjpath",!1),k=c("valjpath",""),l={width:d},m=c("height");for(m&&(l.height=m);g>h;h++)i[h]=this.renderElement(b.list.getChildSync([h]),l,j,k).appendTo(b.dom);for(this.dataReady.resolve(i),this.updateVisibility(),h=0,g=this.defs.length;g>h;h++)!function(a){e.defs[a].done(function(){e.defs[a].build&&e.defs[a].build()})}(h)}},showList:function(a){Array.isArray(a)&&(this.showList=a,this.updateVisibility())}},updateVisibility:function(){if(this.showList&&this.list){var a=this;this.dataReady.then(function(b){for(var c=a.showList,d=0,e=c.length;e>d;d++)c[d]?b[d].show():b[d].hide()})}},renderElement:function(a,d,e,f){var g=$("<div>").css(d);return e&&a.getChild(e,!0).done(function(a){g.css("background-color",a.get())}),this.defs.push(b.toScreen(a,this.module,{},f).always(function(a){g.html(a)})),c.listenHighlight(a,function(a){a?g.css("border-color","black"):g.css("border-color","")},!1,this.module.getId()),g},getDom:function(){return this.dom},typeToScreen:{}}),d});